(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{78865:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},68655:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},40057:function(e,s,t){"use strict";var n=t(85893),i=t(27245),l=t(86501),r=t(92321),c=t(67294),a=t(41664),d=t.n(a),o=t(48105),m=t(91529),x=t(67068),u=t(92180),f=t(77156),h=t(7224),y=t(19638),v=t(42083),j=t(34426),g=t(27460);s.Z=e=>{let{token:s,enableWithdraw:t=!1}=e,{address:a,chain:k}=(0,r.m)(),{currentRound:b,isPending:N,error:p}=(0,u.Bk)(t),{slAmount:C,stAmount:w,promisedWaitingRounds:A,requestedUnstakeRound:E,govVotes:B,isPending:Z,error:T}=(0,u.L)(null==s?void 0:s.address,a),F=()=>!!(0,o.S)(k)&&(!!C&&!(C<=0n)||(l.Am.error("流动性质押数量为0，不用取消质押"),!1)),{allowance:I,isPending:$,error:S}=(0,y.yG)(null==s?void 0:s.slTokenAddress,a,"0x6F41E0C52501Ec0333f6eb8C7Fb7142e1b3B8DAc"),{allowance:z,isPending:L,error:D}=(0,y.yG)(null==s?void 0:s.stTokenAddress,a,"0x6F41E0C52501Ec0333f6eb8C7Fb7142e1b3B8DAc"),[P,M]=(0,c.useState)(!1),[_,H]=(0,c.useState)(!1);(0,c.useEffect)(()=>{C&&C>0n&&I&&I>=C?M(!0):M(!1)},[C,I,$]),(0,c.useEffect)(()=>{w&&w>0n&&z&&z>=w?H(!0):H(!1)},[w,z,L]);let W=P&&(!w||!(w>0n)||_),{isPending:G,isConfirming:O,isConfirmed:V,error:q,approve:K}=(0,f.yA)(null==s?void 0:s.stTokenAddress),{isPending:Q,isConfirming:J,isConfirmed:R,error:U,approve:X}=(0,h.yA)(null==s?void 0:s.slTokenAddress),Y=async()=>{if(F())try{C&&C>0n&&!P&&await X("0x6F41E0C52501Ec0333f6eb8C7Fb7142e1b3B8DAc",C),w&&w>0n&&!_&&await K("0x6F41E0C52501Ec0333f6eb8C7Fb7142e1b3B8DAc",w)}catch(e){console.error(e)}},{isWriting:ee,isConfirming:es,isConfirmed:et,writeError:en,unstake:ei}=(0,u.vc)(),el=async()=>{try{await ei(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,c.useEffect)(()=>{et&&(l.Am.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/LOVE20-interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[et]);let{isWriting:er,isConfirming:ec,isConfirmed:ea,writeError:ed,withdraw:eo}=(0,u.Qc)(),em=async()=>{try{await eo(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,c.useEffect)(()=>{ea&&(l.Am.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/LOVE20-interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[ea]);let{handleContractError:ex}=(0,x.S)();if((0,c.useEffect)(()=>{T&&ex(T,"stake"),q&&ex(q,"stToken"),U&&ex(U,"slToken"),en&&ex(en,"stake"),ed&&ex(ed,"stake"),p&&ex(p,"stake"),S&&ex(S,"slToken"),D&&ex(D,"stToken")},[T,q,U,en,ed,p,S,D]),!a)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!s||t&&N||Z)return(0,n.jsx)(v.Z,{});if(!Z&&!C)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});let eu=Q||G,ef=J||O,eh=t&&E&&b>E+(A||BigInt(0));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:Z?(0,n.jsx)(v.Z,{}):(0,m.LH)(B||BigInt(0),2)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"承诺释放间隔轮数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:Z?(0,n.jsx)(v.Z,{}):"".concat(A||BigInt(0))})]})]}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押sl",s.symbol,(0,n.jsx)(g.Z,{address:s.slTokenAddress,showAddress:!1}),(0,n.jsx)(j.Z,{tokenAddress:s.slTokenAddress,tokenSymbol:"sl"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:Z?(0,n.jsx)(v.Z,{}):(0,m.LH)(C||BigInt(0),2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(i.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/stakelp?symbol=".concat(s.symbol),children:"质押&获取治理票\xa0>>"})})})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["质押代币st",s.symbol,(0,n.jsx)(g.Z,{address:s.stTokenAddress,showAddress:!1}),(0,n.jsx)(j.Z,{tokenAddress:s.stTokenAddress,tokenSymbol:"st"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:Z?(0,n.jsx)(v.Z,{}):(0,m.LH)(w||BigInt(0),2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(i.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/staketoken?symbol=".concat(s.symbol),children:"质押&增加收益\xa0>>"})})})]})]}),t&&(0,n.jsxs)(n.Fragment,{children:[!E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-center space-x-4 mt-2",children:[(0,n.jsx)(i.z,{className:"w-1/2",onClick:Y,disabled:eu||ef||W,children:eu?"1.授权中...":ef?"1.确认中...":W?"1.已授权":"Step1. 授权"}),(0,n.jsx)(i.z,{className:"w-1/2",onClick:el,disabled:!W||ee||es||et,children:ee?"2.提交中":es?"2.确认中":et?"2.已取消质押":"Step2. 取消质押"})]}),(0,n.jsxs)("div",{className:"text-center mt-2 text-sm text-greyscale-600",children:["取消质押后，投票轮第",(0,n.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(b,s)+(A||BigInt(0))+1n," ")}),"轮才能取回代币"]})]}),E&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,n.jsx)(i.z,{className:"w-1/2",onClick:em,disabled:!eh||er||ec||ea,children:eh?er?"提交中":ec?"确认中":ea?"已取回":"取回代币":"第"+(b+(A||BigInt(0))+1n)+"轮后可取回"})})})]}),!t&&(0,n.jsx)("div",{className:"flex justify-center space-x-4",children:(0,n.jsx)(i.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/my/govrewards?symbol=".concat(s.symbol),children:"查看奖励"})})})]})}},48105:function(e,s,t){"use strict";t.d(s,{S:function(){return i}});var n=t(86501);let i=e=>!!e||(n.Am.error("请先将钱包链接 ".concat("sepolia")),!1)},9008:function(e,s,t){e.exports=t(23867)},21803:function(e,s,t){"use strict";function n(e,s){let[t,n="0"]=e.split("."),i=t.startsWith("-");if(i&&(t=t.slice(1)),n=n.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${n}`))&&(t=`${BigInt(t)+1n}`),n="";else if(n.length>s){let[e,i,l]=[n.slice(0,s-1),n.slice(s-1,s),n.slice(s)],r=Math.round(Number(`${i}.${l}`));(n=r>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${r}`).length>s&&(n=n.slice(1),t=`${BigInt(t)+1n}`),n=n.slice(0,s)}else n=n.padEnd(s,"0");return BigInt(`${i?"-":""}${t}${n}`)}t.d(s,{v:function(){return n}})}}]);
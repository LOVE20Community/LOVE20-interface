(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[983],{78865:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},68655:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},40057:function(e,s,t){"use strict";var n=t(85893),l=t(27245),i=t(86501),c=t(92321),a=t(67294),r=t(41664),d=t.n(r),o=t(48105),m=t(91529),x=t(67068),u=t(92180),h=t(77156),f=t(7224),y=t(19638),v=t(34426),j=t(27460),b=t(42083),k=t(44576);s.Z=e=>{let{token:s,enableWithdraw:t=!1}=e,{address:r,chain:g}=(0,c.m)(),{currentRound:N,isPending:p,error:C}=(0,u.Bk)(t),{slAmount:w,stAmount:A,promisedWaitingRounds:Z,requestedUnstakeRound:E,govVotes:T,isPending:$,error:B}=(0,u.L)(null==s?void 0:s.address,r),z=()=>!!(0,o.S)(g)&&(!!w&&!(w<=0n)||(i.Am.error("流动性质押数量为0，不用取消质押"),!1)),{allowance:L,isPending:S,error:D}=(0,y.yG)(null==s?void 0:s.slTokenAddress,r,"0x79832Dd7f109098A9825ba7e334145dab2EC1BCA"),{allowance:I,isPending:P,error:F}=(0,y.yG)(null==s?void 0:s.stTokenAddress,r,"0x79832Dd7f109098A9825ba7e334145dab2EC1BCA"),[M,_]=(0,a.useState)(!1),[H,K]=(0,a.useState)(!1),{isPending:W,isConfirming:G,isConfirmed:O,error:V,approve:q}=(0,h.yA)(null==s?void 0:s.stTokenAddress),{isPending:Q,isConfirming:J,isConfirmed:R,error:U,approve:X}=(0,f.yA)(null==s?void 0:s.slTokenAddress),Y=async()=>{if(z())try{w&&w>0n&&!M&&await X("0x79832Dd7f109098A9825ba7e334145dab2EC1BCA",w)}catch(e){console.error(e)}},ee=async()=>{if(z())try{A&&A>0n&&!H&&await q("0x79832Dd7f109098A9825ba7e334145dab2EC1BCA",A)}catch(e){console.error(e)}};(0,a.useEffect)(()=>{R?_(!0):w&&w>0n&&L&&L>=w?_(!0):_(!1)},[w,L,S,R]),(0,a.useEffect)(()=>{O?K(!0):!A||A<=0n?K(!0):I&&I>=A?K(!0):K(!1)},[A,I,P,O]);let{isWriting:es,isConfirming:et,isConfirmed:en,writeError:el,unstake:ei}=(0,u.vc)(),ec=async()=>{try{await ei(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,a.useEffect)(()=>{en&&(i.Am.success("取消质押成功"),setTimeout(()=>{window.location.href="".concat("/LOVE20-interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[en]);let{isWriting:ea,isConfirming:er,isConfirmed:ed,writeError:eo,withdraw:em}=(0,u.Qc)(),ex=async()=>{try{await em(null==s?void 0:s.address)}catch(e){console.error(e)}};(0,a.useEffect)(()=>{ed&&(i.Am.success("取回代币成功"),setTimeout(()=>{window.location.href="".concat("/LOVE20-interface","/my?symbol=").concat(null==s?void 0:s.symbol)},2e3))},[ed]);let{handleContractError:eu}=(0,x.S)();if((0,a.useEffect)(()=>{B&&eu(B,"stake"),V&&eu(V,"stToken"),U&&eu(U,"slToken"),el&&eu(el,"stake"),eo&&eu(eo,"stake"),C&&eu(C,"stake"),D&&eu(D,"slToken"),F&&eu(F,"stToken")},[B,V,U,el,eo,C,D,F]),!r)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"});if(!s||t&&p||$)return(0,n.jsx)(b.Z,{});if(!$&&!w)return(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"您没有质押"});let eh=Q||J,ef=W||G,ey=M&&H,ev=t&&E&&N>E+(Z||BigInt(0));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 ",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我的治理票数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:$?(0,n.jsx)(b.Z,{}):(0,m.LH)(T||0n,2)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"承诺释放间隔轮数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:$?(0,n.jsx)(b.Z,{}):"".concat(Z||0n)})]})]}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["流动性质押sl",s.symbol,(0,n.jsx)(j.Z,{address:s.slTokenAddress,showAddress:!1}),(0,n.jsx)(v.Z,{tokenAddress:s.slTokenAddress,tokenSymbol:"sl"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:$?(0,n.jsx)(b.Z,{}):(0,m.LH)(w||0n,2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/stakelp?symbol=".concat(s.symbol),children:"质押&获取治理票\xa0>>"})})})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-0 pb-3",children:[(0,n.jsxs)("div",{className:"stat-title text-sm flex items-center",children:["质押代币st",s.symbol,(0,n.jsx)(j.Z,{address:s.stTokenAddress,showAddress:!1}),(0,n.jsx)(v.Z,{tokenAddress:s.stTokenAddress,tokenSymbol:"st"+s.symbol,tokenDecimals:s.decimals})]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:$?(0,n.jsx)(b.Z,{}):(0,m.LH)(A||0n,2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(l.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/staketoken?symbol=".concat(s.symbol),children:"质押&增加收益\xa0>>"})})})]})]}),t&&(0,n.jsxs)(n.Fragment,{children:[!E&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex justify-center space-x-2 mt-2",children:[(0,n.jsx)(l.z,{className:"w-1/3",onClick:Y,disabled:eh||M,children:eh?"1.提交中...":J?"1.确认中...":M?"1.sl".concat(null==s?void 0:s.symbol," 已授权"):"1.授权 sl".concat(null==s?void 0:s.symbol)}),(0,n.jsx)(l.z,{className:"w-1/3",onClick:ee,disabled:!M||ef||H,children:ef?"2.提交中...":G?"2.确认中...":H?"2.st".concat(null==s?void 0:s.symbol," 已授权"):"2.授权 st".concat(null==s?void 0:s.symbol)}),(0,n.jsx)(l.z,{className:"w-1/3",onClick:ec,disabled:!ey||es||et||en,children:es?"3.提交中":et?"3.确认中":en?"3.已取消质押":"3.取消质押"})]}),(0,n.jsxs)("div",{className:"text-center mt-2 text-sm text-greyscale-600",children:["取消质押后，投票轮第",(0,n.jsx)("span",{className:"text-secondary mx-1",children:"".concat((0,m.cK)(N,s)+(Z||0n)+1n," ")}),"轮才能取回代币"]})]}),E&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"flex w-full justify-center mt-2",children:(0,n.jsx)(l.z,{className:"w-1/2",onClick:ex,disabled:!ev||ea||er||ed,children:ev?ea?"提交中":er?"确认中":ed?"已取回":"取回质押代币":"已取消,第"+((0,m.cK)(E,s)+(Z||0n)+1n)+"轮才可取回"})})})]}),!t&&(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,n.jsx)(l.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(d(),{href:"/my/govrewards?symbol=".concat(s.symbol),children:"查看奖励"})}),E&&(0,n.jsx)(l.z,{variant:"outline",className:"w-1/2 ".concat(ev?"text-secondary border-secondary":"text-greyscale-400 border-greyscale-400"," "),disabled:!ev,asChild:!0,children:(0,n.jsx)(d(),{href:"/gov/unstake/?symbol=".concat(s.symbol),children:ev?"取回质押代币":"已取消, 第"+((0,m.cK)(E,s)+(Z||0n)+1n)+"轮可取回"})})]}),(0,n.jsx)(k.Z,{isLoading:eh||ef||ea||es||er||et,text:Q||W||ea||es?"提交交易...":"确认交易..."})]})}},9008:function(e,s,t){e.exports=t(23867)},21803:function(e,s,t){"use strict";function n(e,s){let[t,n="0"]=e.split("."),l=t.startsWith("-");if(l&&(t=t.slice(1)),n=n.replace(/(0+)$/,""),0===s)1===Math.round(Number(`.${n}`))&&(t=`${BigInt(t)+1n}`),n="";else if(n.length>s){let[e,l,i]=[n.slice(0,s-1),n.slice(s-1,s),n.slice(s)],c=Math.round(Number(`${l}.${i}`));(n=c>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${c}`).length>s&&(n=n.slice(1),t=`${BigInt(t)+1n}`),n=n.slice(0,s)}else n=n.padEnd(s,"0");return BigInt(`${l?"-":""}${t}${n}`)}t.d(s,{v:function(){return n}})}}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1533],{67980:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote/actions4submit",function(){return t(76422)}])},27245:function(e,n,t){"use strict";t.d(n,{z:function(){return l}});var r=t(85893),s=t(67294),i=t(88426),a=t(45139),c=t(98997);let o=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,n)=>{let{className:t,variant:s,size:a,asChild:l=!1,...u}=e,d=l?i.g7:"button";return(0,r.jsx)(d,{className:(0,c.cn)(o({variant:s,size:a,className:t})),ref:n,...u})});l.displayName="Button"},98997:function(e,n,t){"use strict";t.d(n,{cn:function(){return i}});var r=t(90512),s=t(98388);function i(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,s.m6)((0,r.W)(n))}},74089:function(e,n,t){"use strict";var r=t(85893),s=t(67294),i=t(91529);n.Z=e=>{let{initialTimeLeft:n}=e,[t,a]=(0,s.useState)(n);(0,s.useEffect)(()=>{if(n<=0)return;a(n);let e=setInterval(()=>{a(n=>n<=1?(clearInterval(e),window.location.reload(),0):n-1)},1e3);return()=>{clearInterval(e)}},[n]);let c=(0,i.ZC)(t);return(0,r.jsx)(r.Fragment,{children:c})}},91318:function(e,n,t){"use strict";var r=t(85893);n.Z=()=>(0,r.jsx)("span",{className:"flex justify-center items-center",children:(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,n,t){"use strict";var r=t(85893);t(67294);var s=t(3125),i=t(74089);n.Z=e=>{let{currentRound:n,roundName:t}=e,{data:a}=(0,s.O)(),c=Number("100")||0,o=Number("12")||0,l=a?c-Number(a)%c:0;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("h1",{className:"text-base text-center font-bold",children:[t,"（第 ",(0,r.jsx)("span",{className:"text-red-500",children:Number(null!=n?n:0n)})," 轮）"]}),(0,r.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,r.jsx)(i.Z,{initialTimeLeft:l>0?l*o:0})]})]})}},76422:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return x}});var r=t(85893),s=t(35337),i=t(94782),a=t(67294),c=t(11163),o=t(27245),l=t(93778),u=t(41664),d=t.n(u),f=t(91318),h=e=>{let{currentRound:n}=e,{token:t}=(0,a.useContext)(l.M)||{},s=(0,c.useRouter)(),{actionInfos:u,isPending:h,error:m}=(0,i.s4)((null==t?void 0:t.address)||"",0n,100n,!1),{actionSubmits:x,isPending:g,error:b}=(0,i.WZ)((null==t?void 0:t.address)||"",n);return m?(console.error(m),(0,r.jsx)("div",{children:"加载出错，请稍后再试。"})):(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-sm font-bold text-gray-600",children:"所有行动"}),(0,r.jsx)(o.z,{onClick:()=>s.push("/action/new"),className:"bg-blue-600 hover:bg-blue-700",children:"发起新行动"})]}),h||g?(0,r.jsx)(f.Z,{}):(0,r.jsx)("div",{className:"space-y-4",children:null==u?void 0:u.map((e,n)=>{let t=null==x?void 0:x.some(n=>n.actionId===e.head.id);return(0,r.jsx)("div",{className:"bg-white p-4 rounded-lg mb-4",children:(0,r.jsxs)(d(),{href:"/action/".concat(e.head.id,"?type=submit&submitted=").concat(t),children:[(0,r.jsxs)("div",{className:"font-semibold mb-2",children:[(0,r.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,r.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,r.jsx)("p",{className:"leading-tight",children:e.body.consensus}),(0,r.jsx)("div",{className:"flex justify-between mt-1",children:(0,r.jsx)("span",{className:"text-sm",children:t?(0,r.jsx)("span",{className:"text-green-500",children:"已推举"}):(0,r.jsx)("span",{className:"text-red-500",children:"未推举"})})})]},e.head.id)},e.head.id)})})]})},m=t(7191),x=()=>{let{currentRound:e,isPending:n,error:t}=(0,i.Bk)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{title:"推举"}),(0,r.jsxs)("main",{className:"flex-grow",children:[(0,r.jsx)("div",{className:"flex flex-col items-center space-y-4 p-6 bg-white",children:n?(0,r.jsx)(f.Z,{}):(0,r.jsx)(m.Z,{currentRound:e,roundName:"投票轮"})}),n?(0,r.jsx)(f.Z,{}):(0,r.jsx)(h,{currentRound:e})]})]})}},11163:function(e,n,t){e.exports=t(43079)},3125:function(e,n,t){"use strict";t.d(n,{O:function(){return f}});var r=t(30202),s=t(97712),i=t(81946),a=t(36100),c=t(82451),o=t(82002),l=t(37122),u=t(65185),d=t(67294);function f(e={}){let{query:n={},watch:t}=e,f=(0,l.Z)(e),h=(0,r.NL)(),m=(0,o.x)({config:f}),x=e.chainId??m,g=function(e,n={}){return{gcTime:0,async queryFn({queryKey:n}){let{scopeKey:t,...r}=n[1];return await function(e,n={}){let{chainId:t,...r}=n,a=e.getClient({chainId:t});return(0,i.s)(a,s.z,"getBlockNumber")(r)}(e,r)??null},queryKey:function(e={}){return["blockNumber",(0,a.OP)(e)]}(n)}}(f,{...e,chainId:x});return!function(e={}){let{enabled:n=!0,onBlockNumber:t,config:r,...s}=e,a=(0,l.Z)(e),c=(0,o.x)({config:a}),f=e.chainId??c;(0,d.useEffect)(()=>{if(n&&t)return function(e,n){let t,r;let{syncConnectedChain:s=e._internal.syncConnectedChain,...a}=n,c=n=>{t&&t();let r=e.getClient({chainId:n});return t=(0,i.s)(r,u.q,"watchBlockNumber")(a)},o=c(n.chainId);return s&&!n.chainId&&(r=e.subscribe(({chainId:e})=>e,async e=>c(e))),()=>{o?.(),r?.()}}(a,{...s,chainId:f,onBlockNumber:t})},[f,a,n,t,s.onError,s.emitMissed,s.emitOnBegin,s.poll,s.pollingInterval,s.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof t?t:{}},enabled:!!((n.enabled??!0)&&("object"==typeof t?t.enabled:t)),onBlockNumber(e){h.setQueryData(g.queryKey,e)}}),(0,c.aM)({...n,...g})}},89810:function(e,n,t){"use strict";t.d(n,{u:function(){return o}});var r=t(37003),s=t(36100),i=t(82451),a=t(82002),c=t(37122);function o(e={}){let{abi:n,address:t,functionName:o,query:l={}}=e,u=e.code,d=(0,c.Z)(e),f=(0,a.x)({config:d}),h=function(e,n={}){return{async queryFn({queryKey:t}){let s=n.abi;if(!s)throw Error("abi is required");let{functionName:i,scopeKey:a,...c}=t[1],o=(()=>{let e=t[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!i)throw Error("functionName is required");return(0,r.L)(e,{abi:s,functionName:i,args:c.args,...o,...c})},queryKey:function(e={}){let{abi:n,...t}=e;return["readContract",(0,s.OP)(t)]}(n)}}(d,{...e,chainId:e.chainId??f}),m=!!((t||u)&&n&&o&&(l.enabled??!0));return(0,i.aM)({...l,...h,enabled:m,structuralSharing:l.structuralSharing??s.if})}}},function(e){e.O(0,[4784,8424,7140,2888,9774,179],function(){return e(e.s=67980)}),_N_E=e.O()}]);
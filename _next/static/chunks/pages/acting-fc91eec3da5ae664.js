(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return n(75959)}])},34680:function(e,s,n){"use strict";n.d(s,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var t=n(85893),r=n(67294),a=n(40108);let l=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...r})});l.displayName="Card";let c=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",n),...r})});c.displayName="CardHeader";let i=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",n),...r})});i.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",n),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",n),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",n),...r})});u.displayName="CardFooter"},53696:function(e,s,n){"use strict";n.d(s,{Z:function(){return o}});var t=n(85893),r=n(67294),a=n(23432);let l=(0,n(31134).Z)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var c=n(92321),i=n(32209),d=n(86501);function o(e){let{tokenAddress:s,tokenSymbol:n,tokenDecimals:o,tokenImage:u}=e,[x,m]=(0,r.useState)(!1),{isConnected:f}=(0,c.m)(),{data:h}=(0,i.p)(),j=async()=>{if(!f){alert("请先连接你的钱包");return}m(!0);try{if(!h){alert("无法获取钱包客户端");return}await h.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:n,decimals:o,image:u}}})?(console.log("代币已添加到 MetaMask 钱包"),d.ZP.success("代币已成功添加到 MetaMask 钱包")):(console.log("用户拒绝添加代币"),d.ZP.error("用户拒绝添加代币"))}catch(e){console.error("添加代币失败:",e),d.ZP.error("添加代币失败，请检查控制台以获取更多信息")}finally{m(!1)}};return(0,t.jsx)("button",{onClick:j,disabled:x,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:x?(0,t.jsx)(a.Z,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(l,{className:"h-4 w-4 text-greyscale-500"})})}},74089:function(e,s,n){"use strict";var t=n(85893),r=n(67294);s.Z=e=>{let{initialTimeLeft:s}=e,[n,a]=(0,r.useState)(s);(0,r.useEffect)(()=>{if(s<=0)return;a(s);let e=setInterval(()=>{a(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let l=Math.floor(n/86400);return(0,t.jsxs)("div",{className:"inline-flex gap-1  text-secondary",children:[l>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":l}})}),"天"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":Math.floor(n%86400/3600)}})}),"时"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":Math.floor(n%3600/60)}})}),"分"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":n%60}})}),"秒"]})]})}},7191:function(e,s,n){"use strict";var t=n(85893);n(67294);var r=n(42757),a=n(74089);s.Z=e=>{let{currentRound:s,roundName:n}=e,{data:l}=(0,r.O)(),c=Number("100")||0,i=Number("12")||0,d=l?c-Number(l)%c:0;return(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h1",{className:"text-lg font-bold",children:[n," 第 ",(0,t.jsx)("span",{className:"text-secondary",children:Number(null!=s?s:0n)})," 轮"]}),(0,t.jsxs)("span",{className:"text-sm text-greyscale-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(a.Z,{initialTimeLeft:d>0?d*i:0})]})]})}},66247:function(e,s,n){"use strict";n.d(s,{Z:function(){return u}});var t=n(85893),r=n(67294),a=n(93778),l=n(19638),c=n(42083),i=n(27460),d=n(53696),o=e=>{let{}=e,{token:s}=(0,r.useContext)(a.M)||{};return s?(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{className:"mr-2",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"font-bold text-2xl mr-2",children:s.symbol}),(0,t.jsx)(i.Z,{address:s.address}),(0,t.jsx)(d.Z,{tokenAddress:s.address,tokenSymbol:s.symbol||"",tokenDecimals:s.decimals||0})]})})}):(0,t.jsx)(c.Z,{})};function u(){let{token:e}=(0,r.useContext)(a.M)||{},{totalSupply:s,isPending:n,error:i}=(0,l.A5)((null==e?void 0:e.address)||""),[d,u]=(0,r.useState)(!1);return(null==e?void 0:e.address)?(0,t.jsxs)("div",{className:"px-6 pt-2 pb-6",children:[(0,t.jsx)(o,{}),!1]}):(0,t.jsx)(c.Z,{})}},75959:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return g}});var t=n(85893),r=n(5028),a=n(67294),l=n(7399),c=n(93778),i=n(91529),d=n(42083),o=n(7191),u=e=>{let{currentRound:s}=e,{token:n}=(0,a.useContext)(c.M)||{},{rewardAvailable:u,isPending:x,error:m}=(0,l.CY)((null==n?void 0:n.address)||""),{joinedAmount:f,isPending:h,error:j}=(0,r.fP)((null==n?void 0:n.address)||"",s);return(0,t.jsxs)("div",{className:"px-6",children:[(0,t.jsx)(o.Z,{currentRound:s,roundName:"行动轮"}),(0,t.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title",children:"预计新增铸币"}),(0,t.jsx)("div",{className:"stat-value text-2xl",children:x||void 0===u?(0,t.jsx)(d.Z,{}):(0,i.LH)(99n*u/10000n)})]}),(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title",children:"参与行动代币"}),(0,t.jsx)("div",{className:"stat-value text-2xl",children:h?(0,t.jsx)(d.Z,{}):(0,i.LH)(f||BigInt(0))})]})]})]})},x=n(58732),m=n(41664),f=n.n(m),h=n(92321),j=n(34680),N=n(45551),v=n(94782),p=n(64777),y=e=>{let{currentRound:s}=e,{token:n}=(0,a.useContext)(c.M)||{},{address:r}=(0,h.m)(),{actions:l,isPending:o,error:u}=(0,N.jA)((null==n?void 0:n.address)||"",s);null==l||l.sort((e,s)=>Number(e.actionId)-Number(s.actionId));let x=null==l?void 0:l.map(e=>e.actionId),m=(null==l?void 0:l.reduce((e,s)=>e+s.votesNum,0n))||0n,{actionInfos:y,isPending:b,error:g}=(0,v.fT)((null==n?void 0:n.address)||"",x||[]),{joinedActions:w,isPending:Z,error:C}=(0,N.dB)((null==n?void 0:n.address)||"",r);if(u||g||C)return console.error("errorJoinableActions",u),console.error("errorActionInfosByIds",g),console.error("errorJoinedActions",C),(0,t.jsx)("div",{children:"加载出错，请稍后再试。"});let k=o||l&&l.length>0&&b||Z;return(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(p.Z,{title:"进行中的行动"}),k&&(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(d.Z,{})}),!k&&!(null==x?void 0:x.length)&&(0,t.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"本轮暂无行动"}),!k&&x&&x.length>0&&(0,t.jsx)("div",{className:"mt-4 space-y-4",children:null==y?void 0:y.map((e,s)=>{let r=(null==w?void 0:w.some(s=>s.actionId===BigInt(e.head.id)))?"/action/".concat(e.head.id,"?type=join&symbol=").concat(null==n?void 0:n.symbol):"/acting/join?id=".concat(e.head.id,"&symbol=").concat(null==n?void 0:n.symbol);return(0,t.jsx)(j.Zb,{className:"shadow-none",children:(0,t.jsxs)(f(),{href:r,children:[(0,t.jsxs)(j.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,t.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,t.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,t.jsxs)(j.aY,{className:"px-3 pt-1 pb-2",children:[(0,t.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,t.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,t.jsxs)("span",{className:"text-secondary",children:[(100*Number((null==l?void 0:l[s].votesNum)||0n)/Number(m)).toFixed(1),"%"]})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"参与代币数"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,i.LH)((null==l?void 0:l[s].joinedAmount)||0n)})]})]})]})]})},e.head.id)})})]})},b=n(66247),g=()=>{let{currentRound:e}=(0,r.Bk)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{title:"社区首页"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(b.Z,{}),(0,t.jsx)(u,{currentRound:e}),(0,t.jsx)(y,{currentRound:e})]})]})}},42757:function(e,s,n){"use strict";n.d(s,{O:function(){return u}});var t=n(30202),r=n(97712),a=n(81946),l=n(36100),c=n(45631),i=n(82002),d=n(80666),o=n(97861);function u(e={}){let{query:s={},watch:n}=e,u=(0,d.Z)(e),x=(0,t.NL)(),m=(0,i.x)({config:u}),f=e.chainId??m,h=function(e,s={}){return{gcTime:0,async queryFn({queryKey:s}){let{scopeKey:n,...t}=s[1];return await function(e,s={}){let{chainId:n,...t}=s,l=e.getClient({chainId:n});return(0,a.s)(l,r.z,"getBlockNumber")(t)}(e,t)??null},queryKey:function(e={}){return["blockNumber",(0,l.OP)(e)]}(s)}}(u,{...e,chainId:f});return(0,o.x)({...{config:e.config,chainId:e.chainId,..."object"==typeof n?n:{}},enabled:!!((s.enabled??!0)&&("object"==typeof n?n.enabled:n)),onBlockNumber(e){x.setQueryData(h.queryKey,e)}}),(0,c.aM)({...s,...h})}},97861:function(e,s,n){"use strict";n.d(s,{x:function(){return i}});var t=n(65185),r=n(81946),a=n(67294),l=n(82002),c=n(80666);function i(e={}){let{enabled:s=!0,onBlockNumber:n,config:i,...d}=e,o=(0,c.Z)(e),u=(0,l.x)({config:o}),x=e.chainId??u;(0,a.useEffect)(()=>{if(s&&n)return function(e,s){let n,a;let{syncConnectedChain:l=e._internal.syncConnectedChain,...c}=s,i=s=>{n&&n();let a=e.getClient({chainId:s});return n=(0,r.s)(a,t.q,"watchBlockNumber")(c)},d=i(s.chainId);return l&&!s.chainId&&(a=e.subscribe(({chainId:e})=>e,async e=>i(e))),()=>{d?.(),a?.()}}(o,{...d,chainId:x,onBlockNumber:n})},[x,o,s,n,d.onError,d.emitMissed,d.emitOnBegin,d.poll,d.pollingInterval,d.syncConnectedChain])}}},function(e){e.O(0,[1664,530,2209,1502,4637,9871,5112,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);
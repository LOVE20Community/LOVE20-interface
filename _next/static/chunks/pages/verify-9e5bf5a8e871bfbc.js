(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{85719:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return r(48585)}])},74089:function(e,n,r){"use strict";var t=r(85893),s=r(67294),i=r(91529);n.Z=e=>{let{initialTimeLeft:n}=e,[r,a]=(0,s.useState)(n);(0,s.useEffect)(()=>{if(n<=0)return;a(n);let e=setInterval(()=>{a(n=>n<=1?(clearInterval(e),window.location.reload(),0):n-1)},1e3);return()=>{clearInterval(e)}},[n]);let c=(0,i.ZC)(r);return(0,t.jsx)(t.Fragment,{children:c})}},91318:function(e,n,r){"use strict";var t=r(85893);n.Z=()=>(0,t.jsx)("span",{className:"flex justify-center items-center",children:(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,n,r){"use strict";var t=r(85893);r(67294);var s=r(3125),i=r(74089);n.Z=e=>{let{currentRound:n,roundName:r}=e,{data:a}=(0,s.O)(),c=Number("100")||0,l=Number("12")||0,d=a?c-Number(a)%c:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h1",{className:"text-base text-center font-bold",children:[r,"（第 ",(0,t.jsx)("span",{className:"text-red-500",children:Number(null!=n?n:0n)})," 轮）"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(i.Z,{initialTimeLeft:d>0?d*l:0})]})]})}},18308:function(e,n,r){"use strict";var t=r(85893),s=r(67294),i=r(92321),a=r(41664),c=r.n(a),l=r(7080),d=r(87250),o=r(93778),u=r(91529),x=r(91318),f=r(7191);n.Z=e=>{let{currentRound:n,showBtn:r=!0}=e,{token:a}=(0,s.useContext)(o.M)||{},{address:m}=(0,i.m)(),{votesNumByAccount:h,isPending:j,error:g}=(0,l.VI)(null==a?void 0:a.address,n,m||""),{scoreByVerifier:N,isPending:y,error:b}=(0,d.w3)(null==a?void 0:a.address,n,m||""),p=j||y?BigInt(0):h-N;return(0,t.jsxs)("div",{className:"flex flex-col items-center bg-white py-4",children:[(0,t.jsx)(f.Z,{currentRound:n,roundName:"验证轮"}),(0,t.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:y?(0,t.jsx)(x.Z,{}):(0,u.LH)(N||BigInt(0))})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:j||y?(0,t.jsx)(x.Z,{}):(0,u.LH)(p)})]})]}),r&&(j||y?(0,t.jsx)(x.Z,{}):h>N?(0,t.jsx)(c(),{href:"/verify",className:"btn-primary btn w-1/2",children:"去验证"}):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"无剩余验证票"}))]})}},48585:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return h}});var t=r(85893),s=r(35337),i=r(87250),a=r(18308),c=r(67294),l=r(41664),d=r.n(l),o=r(7080),u=r(94782),x=r(93778),f=r(91318),m=e=>{let{currentRound:n}=e,{token:r}=(0,c.useContext)(x.M)||{},{actionIds:s,votes:i,isPending:a,error:l}=(0,o.$S)((null==r?void 0:r.address)||"",n),{actionInfos:m,isPending:h,error:j}=(0,u.fT)((null==r?void 0:r.address)||"",s||[]);return a||s&&s.length>0&&h?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(f.Z,{})}):l||j?(console.log("errorVotesNums",l),console.log("errorActionInfosByIds",j),(0,t.jsx)("div",{children:"加载出错，请稍后再试。"})):(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h2",{className:"text-sm font-bold mb-4 text-gray-600",children:"待验证行动"}),(0,t.jsx)("div",{className:"space-y-4",children:null==m?void 0:m.map((e,n)=>(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg mb-4",children:(0,t.jsxs)(d(),{href:"/verify/".concat(e.head.id),children:[(0,t.jsxs)("div",{className:"font-semibold mb-2",children:[(0,t.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,t.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,t.jsx)("p",{className:"leading-tight",children:e.body.consensus})]},e.head.id)},e.head.id))})]})},h=()=>{let{currentRound:e}=(0,i.Bk)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Z,{title:"社区首页"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(a.Z,{currentRound:e,showBtn:!1}),(0,t.jsx)(m,{currentRound:e})]})]})}},3125:function(e,n,r){"use strict";r.d(n,{O:function(){return x}});var t=r(30202),s=r(97712),i=r(81946),a=r(36100),c=r(82451),l=r(82002),d=r(37122),o=r(65185),u=r(67294);function x(e={}){let{query:n={},watch:r}=e,x=(0,d.Z)(e),f=(0,t.NL)(),m=(0,l.x)({config:x}),h=e.chainId??m,j=function(e,n={}){return{gcTime:0,async queryFn({queryKey:n}){let{scopeKey:r,...t}=n[1];return await function(e,n={}){let{chainId:r,...t}=n,a=e.getClient({chainId:r});return(0,i.s)(a,s.z,"getBlockNumber")(t)}(e,t)??null},queryKey:function(e={}){return["blockNumber",(0,a.OP)(e)]}(n)}}(x,{...e,chainId:h});return!function(e={}){let{enabled:n=!0,onBlockNumber:r,config:t,...s}=e,a=(0,d.Z)(e),c=(0,l.x)({config:a}),x=e.chainId??c;(0,u.useEffect)(()=>{if(n&&r)return function(e,n){let r,t;let{syncConnectedChain:s=e._internal.syncConnectedChain,...a}=n,c=n=>{r&&r();let t=e.getClient({chainId:n});return r=(0,i.s)(t,o.q,"watchBlockNumber")(a)},l=c(n.chainId);return s&&!n.chainId&&(t=e.subscribe(({chainId:e})=>e,async e=>c(e))),()=>{l?.(),t?.()}}(a,{...s,chainId:x,onBlockNumber:r})},[x,a,n,r,s.onError,s.emitMissed,s.emitOnBegin,s.poll,s.pollingInterval,s.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof r?r:{}},enabled:!!((n.enabled??!0)&&("object"==typeof r?r.enabled:r)),onBlockNumber(e){f.setQueryData(j.queryKey,e)}}),(0,c.aM)({...n,...j})}},89810:function(e,n,r){"use strict";r.d(n,{u:function(){return l}});var t=r(37003),s=r(36100),i=r(82451),a=r(82002),c=r(37122);function l(e={}){let{abi:n,address:r,functionName:l,query:d={}}=e,o=e.code,u=(0,c.Z)(e),x=(0,a.x)({config:u}),f=function(e,n={}){return{async queryFn({queryKey:r}){let s=n.abi;if(!s)throw Error("abi is required");let{functionName:i,scopeKey:a,...c}=r[1],l=(()=>{let e=r[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!i)throw Error("functionName is required");return(0,t.L)(e,{abi:s,functionName:i,args:c.args,...l,...c})},queryKey:function(e={}){let{abi:n,...r}=e;return["readContract",(0,s.OP)(r)]}(n)}}(u,{...e,chainId:e.chainId??x}),m=!!((r||o)&&n&&l&&(d.enabled??!0));return(0,i.aM)({...d,...f,enabled:m,structuralSharing:d.structuralSharing??s.if})}}},function(e){e.O(0,[4846,7140,7080,7250,2888,9774,179],function(){return e(e.s=85719)}),_N_E=e.O()}]);
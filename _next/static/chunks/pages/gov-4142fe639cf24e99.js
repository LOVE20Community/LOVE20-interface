(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6700],{54889:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov",function(){return t(76060)}])},4270:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},27460:function(e,s,t){"use strict";var n=t(85893),l=t(67294),a=t(74855),c=t(78865),i=t(18289),r=t(86501),d=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0,showAddress:o=!0,colorClassName:x=""}=e,[u,m]=(0,l.useState)(!1);return(0,n.jsxs)("span",{className:"flex items-center space-x-2",children:[o&&(0,n.jsx)("span",{className:"text-xs ".concat(null!=x?x:"text-greyscale-500"),children:(0,d.Vu)(s)}),t&&(0,n.jsx)(a.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?m(!0):r.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:u?(0,n.jsx)(c.Z,{className:"h-4 w-4 ".concat(null!=x?x:"text-greyscale-500")}):(0,n.jsx)(i.Z,{className:"h-4 w-4 ".concat(null!=x?x:"text-greyscale-500")})})})]})}},96693:function(e,s,t){"use strict";t.d(s,{Z:function(){return d}});var n=t(85893),l=t(67294),a=t(42757),c=t(93778),i=e=>{let{initialTimeLeft:s,onTick:t}=e,[a,c]=(0,l.useState)(Date.now()+1e3*s),[i,r]=(0,l.useState)(s);(0,l.useEffect)(()=>{c(Date.now()+1e3*s)},[s]),(0,l.useEffect)(()=>{let e=setInterval(()=>{let s=Math.max(0,Math.floor((a-Date.now())/1e3));r(s),t&&t(s),s<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[a,t]);let d=Math.floor(i/86400),o=Math.floor(i%86400/3600);return(0,n.jsxs)("div",{className:"inline-flex gap-1 text-secondary",children:[d>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":d}})}),"天"]}),(o>0||d>0)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":o}})}),"时"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":Math.floor(i%3600/60)}})}),"分"]}),d<=0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":i%60}})}),"秒"]})]})},r=t(42083),d=e=>{let{currentRound:s,roundType:t}=e,{data:d}=(0,a.O)(),o=(0,l.useContext)(c.M),x=o?o.token:void 0,u=!d||!x||void 0===x.voteOriginBlocks||void 0===x.initialStakeRound,[m,h]=(0,l.useState)(0n),j=Number("100")||0,v=Number("3")||0,f=x?Number(x.voteOriginBlocks):0,N=j-(Number(d)-f)%j,p=N>0?N*v:0,[y,b]=(0,l.useState)(p);(0,l.useEffect)(()=>{if(!d)return;let e=j-(Number(d)-f)%j;b(e>0?e*v:0)},[d,j,v,f]),(0,l.useEffect)(()=>{x&&s>0n&&h(s-BigInt(x.initialStakeRound)+1n)},[s,x]);let g=null!=m?m.toString():"0";return u?(0,n.jsx)(r.Z,{}):(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("h1",{className:"text-lg font-bold",children:["第 ",(0,n.jsx)("span",{className:"text-secondary",children:g})," 轮","vote"===t?"投票":"行动","阶段"]}),(0,n.jsxs)("span",{className:"text-sm mt-1 pt-0",children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"剩余:"}),(0,n.jsx)("span",{className:"text-secondary mr-1",children:Math.ceil(y/v)}),(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),(0,n.jsx)(i,{initialTimeLeft:p,onTick:b})]})]})}},37122:function(e,s,t){"use strict";var n=t(85893),l=t(67294),a=t(92321),c=t(27245),i=t(41664),r=t.n(i),d=t(91529),o=t(93778),x=t(7080),u=t(87250),m=t(67068),h=t(42083),j=t(64777);s.Z=e=>{let{currentRound:s,showBtn:t=!0}=e,{token:i}=(0,l.useContext)(o.M)||{},{address:v}=(0,a.m)(),{votesNumByAccount:f,isPending:N,error:p}=(0,x.VI)(null==i?void 0:i.address,s,v||""),{scoreByVerifier:y,isPending:b,error:g}=(0,u.w3)(null==i?void 0:i.address,s,v||""),w=N||b?BigInt(0):f-y,{handleContractError:Z}=(0,m.S)();return((0,l.useEffect)(()=>{p&&Z(p,"vote"),g&&Z(g,"verify")},[p,g]),i)?v?(0,n.jsxs)("div",{className:"flex-col items-center px-4 pt-3 pb-2",children:[(0,n.jsx)(j.Z,{title:"行动验证"}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0 mt-2",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"已验证票数"}),(0,n.jsx)("div",{className:"stat-value text-xl ".concat(t?"":"text-secondary"),children:b?(0,n.jsx)(h.Z,{}):(0,d.LH)(y||BigInt(0),2)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"未验证票数"}),(0,n.jsx)("div",{className:"stat-value text-xl ".concat(t?"":"text-secondary"),children:N||b?(0,n.jsx)(h.Z,{}):(0,d.LH)(w,2)})]})]}),t&&(0,n.jsx)("div",{className:"flex justify-center",children:N||b?(0,n.jsx)(h.Z,{}):f>y?(0,n.jsx)(c.z,{className:"w-1/2",asChild:!0,children:(0,n.jsx)(r(),{href:"/verify?symbol=".concat(i.symbol),children:"去验证"})}):(0,n.jsx)(c.z,{disabled:!0,className:"w-1/2",children:y>0?"已验证":"未投票，无需验证"})})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex-col items-center px-4 pt-6 pb-2",children:[(0,n.jsx)(j.Z,{title:"行动验证"}),(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):""}},76060:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var n=t(85893),l=t(67294),a=t(11163),c=t(93778),i=t(7080),r=t(67068),d=t(37436),o=t(27245),x=t(41664),u=t.n(x),m=t(45551),h=t(91529),j=t(42083),v=t(96693),f=e=>{let{currentRound:s}=e,{token:t}=(0,l.useContext)(c.M)||{},{govData:a,isPending:i,error:d}=(0,m._H)(null==t?void 0:t.address),{handleContractError:x}=(0,r.S)();return((0,l.useEffect)(()=>{d&&x(d,"govData")},[d]),t)?(0,n.jsxs)("div",{className:"px-4 pb-4",children:[(0,n.jsx)(v.Z,{currentRound:s,roundType:"vote"}),(0,n.jsxs)("div",{className:"border rounded-lg mt-4 p-0",children:[(0,n.jsx)("div",{className:"stats w-full",children:(0,n.jsxs)("div",{className:"stat place-items-center pb-0",children:[(0,n.jsx)("div",{className:"stat-title text-base",children:"总治理票数"}),(0,n.jsx)("div",{className:"stat-value text-secondary text-2xl",children:i?(0,n.jsx)(j.Z,{}):(0,h.LH)((null==a?void 0:a.govVotes)||BigInt(0),2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(o.z,{variant:"link",size:"sm",className:"w-full text-gray-400",asChild:!0,children:(0,n.jsx)(u(),{href:"/gov/liquid?symbol=".concat(null==t?void 0:t.symbol),children:"流动性质押数据>>"})})})]})}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-2 pb-0 mb-0",children:[(0,n.jsxs)("div",{className:"stat-title text-sm",children:["流动性质押sl",t.symbol]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:i?(0,n.jsx)(j.Z,{}):(0,h.LH)((null==a?void 0:a.slAmount)||BigInt(0),2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(o.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(u(),{href:"/gov/stakelp?symbol=".concat(t.symbol),children:"质押&获取治理票\xa0>>"})})})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-2 pb-0 mb-0",children:[(0,n.jsxs)("div",{className:"stat-title text-sm",children:["质押代币st",t.symbol]}),(0,n.jsx)("div",{className:"stat-value text-xl",children:i?(0,n.jsx)(j.Z,{}):(0,h.LH)((null==a?void 0:a.stAmount)||BigInt(0),2)}),(0,n.jsx)("div",{className:"stat-desc text-xs",children:(0,n.jsx)(o.z,{variant:"link",className:"text-secondary font-normal border-secondary",asChild:!0,children:(0,n.jsx)(u(),{href:"/gov/staketoken?symbol=".concat(t.symbol),children:"质押&增加收益\xa0>>"})})})]})]})]})]}):(0,n.jsx)(j.Z,{})},N=t(92321),p=t(92180),y=t(64777),b=e=>{let{currentRound:s}=e,{token:t}=(0,l.useContext)(c.M)||{},{address:a}=(0,N.m)(),{validGovVotes:d,isPending:x,error:m}=(0,p.Ty)((null==t?void 0:t.address)||"",a||""),{votesNumByAccount:v,isPending:f,error:b}=(0,i.VI)((null==t?void 0:t.address)||"",s,a||""),{handleContractError:g}=(0,r.S)();return((0,l.useEffect)(()=>{b&&g(b,"vote"),m&&g(m,"stake")},[b,m]),t)?a?(0,n.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,n.jsx)(y.Z,{title:"行动投票"}),(0,n.jsxs)("div",{className:"stats w-full grid grid-cols-2 mt-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我的已投票数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:f?(0,n.jsx)(j.Z,{}):(0,h.LH)(v||BigInt(0),2)})]}),(0,n.jsxs)("div",{className:"stat place-items-center pt-1 pb-2",children:[(0,n.jsx)("div",{className:"stat-title text-sm",children:"我的剩余票数"}),(0,n.jsx)("div",{className:"stat-value text-xl",children:x||f?(0,n.jsx)(j.Z,{}):d?(0,h.LH)(d-v||BigInt(0),2):"0"})]})]}),(0,n.jsx)("div",{className:"flex justify-center",children:x||f?(0,n.jsx)(j.Z,{}):d>v+2n?(0,n.jsx)(o.z,{className:"w-1/2",asChild:!0,children:(0,n.jsx)(u(),{href:"/vote?symbol=".concat(t.symbol),children:"去投票"})}):(0,n.jsx)(o.z,{disabled:!0,className:"w-1/2",children:d>0?"已投票":"无治理票，不能投票"})})]}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"flex-col items-center px-4 py-2",children:[(0,n.jsx)(y.Z,{title:"行动投票"}),(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"})]})}):""},g=t(37122),w=t(4062),Z=t(4270),k=e=>{let{token:s}=e;return(0,n.jsxs)("div",{className:"mt-2 p-4",children:[(0,n.jsx)(y.Z,{title:"部署子币"}),(0,n.jsx)("div",{className:"w-full text-center",children:(0,n.jsx)(o.z,{variant:"outline",size:"sm",className:"mt-2 w-1/2 text-secondary border-secondary",asChild:!0,children:(0,n.jsxs)(u(),{href:"/launch/deploy?symbol=".concat(null==s?void 0:s.symbol),children:[(0,n.jsx)(Z.Z,{className:"w-4 h-4"}),"去部署"]})})}),(0,n.jsxs)("div",{className:"bg-gray-100 text-greyscale-500 rounded-lg p-4 text-sm mt-4",children:[(0,n.jsx)("p",{className:"mb-1",children:"说明："}),(0,n.jsxs)("p",{children:["1. 部署者：须持有 ",null==s?void 0:s.symbol,"不少于 0.5%的治理票"]}),(0,n.jsxs)("p",{children:["2. 子币发射目标：须筹集 20,000,000个 ",null==s?void 0:s.symbol]})]})]})},C=()=>{let e=(0,a.useRouter)(),{currentRound:s,error:t}=(0,i.Bk)(),{token:o}=(0,l.useContext)(c.M)||{};(0,l.useEffect)(()=>{o&&!o.hasEnded?e.push("/launch?symbol=".concat(o.symbol)):o&&!o.initialStakeRound&&e.push("/gov/stakelp?symbol=".concat(o.symbol,"&first=true"))},[o]);let{handleContractError:x}=(0,r.S)();return((0,l.useEffect)(()=>{t&&x(t,"vote")},[t]),o)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Z,{title:"治理首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(w.Z,{}),(0,n.jsx)(f,{currentRound:s||0n}),(0,n.jsx)(b,{currentRound:s||0n}),(0,n.jsx)(g.Z,{currentRound:s>2?s-2n:0n}),(0,n.jsx)(k,{token:o})]})]}):(0,n.jsx)(j.Z,{})}},42757:function(e,s,t){"use strict";t.d(s,{O:function(){return x}});var n=t(30202),l=t(97712),a=t(81946),c=t(36100),i=t(45631),r=t(82002),d=t(80666),o=t(97861);function x(e={}){let{query:s={},watch:t}=e,x=(0,d.Z)(e),u=(0,n.NL)(),m=(0,r.x)({config:x}),h=e.chainId??m,j=function(e,s={}){return{gcTime:0,async queryFn({queryKey:s}){let{scopeKey:t,...n}=s[1];return await function(e,s={}){let{chainId:t,...n}=s,c=e.getClient({chainId:t});return(0,a.s)(c,l.z,"getBlockNumber")(n)}(e,n)??null},queryKey:function(e={}){return["blockNumber",(0,c.OP)(e)]}(s)}}(x,{...e,chainId:h});return(0,o.x)({...{config:e.config,chainId:e.chainId,..."object"==typeof t?t:{}},enabled:!!((s.enabled??!0)&&("object"==typeof t?t.enabled:t)),onBlockNumber(e){u.setQueryData(j.queryKey,e)}}),(0,i.aM)({...s,...j})}},97861:function(e,s,t){"use strict";t.d(s,{x:function(){return r}});var n=t(65185),l=t(81946),a=t(67294),c=t(82002),i=t(80666);function r(e={}){let{enabled:s=!0,onBlockNumber:t,config:r,...d}=e,o=(0,i.Z)(e),x=(0,c.x)({config:o}),u=e.chainId??x;(0,a.useEffect)(()=>{if(s&&t)return function(e,s){let t,a;let{syncConnectedChain:c=e._internal.syncConnectedChain,...i}=s,r=s=>{t&&t();let a=e.getClient({chainId:s});return t=(0,l.s)(a,n.q,"watchBlockNumber")(i)},d=r(s.chainId);return c&&!s.chainId&&(a=e.subscribe(({chainId:e})=>e,async e=>r(e))),()=>{d?.(),a?.()}}(o,{...d,chainId:u,onBlockNumber:t})},[u,o,s,t,d.onError,d.emitMissed,d.emitOnBegin,d.poll,d.pollingInterval,d.syncConnectedChain])}}},function(e){e.O(0,[1664,2209,1335,2690,1250,7380,2180,7250,4062,2888,9774,179],function(){return e(e.s=54889)}),_N_E=e.O()}]);
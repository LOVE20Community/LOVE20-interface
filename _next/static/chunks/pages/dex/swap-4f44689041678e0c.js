(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{17137:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dex/swap",function(){return t(38462)}])},27245:function(e,s,t){"use strict";t.d(s,{z:function(){return d}});var n=t(85893),a=t(67294),r=t(88426),i=t(45139),l=t(98997);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,s)=>{let{className:t,variant:a,size:i,asChild:d=!1,...c}=e,u=d?r.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:t})),ref:s,...c})});d.displayName="Button"},21774:function(e,s,t){"use strict";t.d(s,{I:function(){return i}});var n=t(85893),a=t(67294),r=t(98997);let i=a.forwardRef((e,s)=>{let{className:t,type:a,...i}=e;return(0,n.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...i})});i.displayName="Input"},98997:function(e,s,t){"use strict";t.d(s,{cn:function(){return r}});var n=t(90512),a=t(98388);function r(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,a.m6)((0,n.W)(s))}},35337:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var n=t(85893),a=t(9008),r=t.n(a),i=t(67294),l=t(91428),o=t(41664),d=t.n(o),c=()=>{let[e,s]=(0,i.useState)(!1);return(0,n.jsxs)("div",{children:[(0,n.jsxs)("button",{className:"ml-4 mt-2 focus:outline-none",onClick:()=>{s(!e)},children:[(0,n.jsx)("div",{className:"w-6 h-1 bg-black mb-1"}),(0,n.jsx)("div",{className:"w-6 h-1 bg-black mb-1"}),(0,n.jsx)("div",{className:"w-6 h-1 bg-black"})]}),e&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>{s(!1)}}),(0,n.jsx)("div",{className:"fixed top-0 left-0 z-50 h-full w-64 bg-gray-800 text-white transform ".concat(e?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out"),children:(0,n.jsxs)("ul",{className:"mt-8",children:[(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/",children:(0,n.jsx)("span",{children:"社区首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/gov",children:(0,n.jsx)("span",{children:"治理首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/my",children:(0,n.jsx)("span",{children:"我的首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/launch",children:(0,n.jsx)("span",{children:"发射平台"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/dex/swap",children:(0,n.jsx)("span",{children:"交易代币"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/launch/deposit",children:(0,n.jsxs)("span",{children:["兑换","ETH20"]})})})]})})]})},u=e=>{let{title:s}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:"".concat(s," - LIFE20")}),(0,n.jsx)("meta",{name:"".concat(s," - LIFE20"),content:"A Web3 DApp for Life20 token management"})]}),(0,n.jsxs)("header",{className:"flex justify-between items-center p-4 bg-white",children:[(0,n.jsx)(c,{}),(0,n.jsx)(l.NL,{})]})]})}},301:function(e,s,t){"use strict";t.d(s,{AT:function(){return d},op:function(){return o},oN:function(){return c}});var n=t(89810),a=t(82016),r=t(83540);let i=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],l="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",o=function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:a,error:r,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsOut",args:[e,s],query:{enabled:!!e&&s.length>=2&&t}});return{data:a,error:r,isLoading:o}},d=function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:a,error:r,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsIn",args:[e,s],query:{enabled:!!e&&s.length>=2&&t}});return{data:a,error:r,isLoading:o}};function c(){let{writeContract:e,isPending:s,data:t,error:n}=(0,a.S)(),o=async(s,t,n,a,r)=>{try{await e({address:l,abi:i,functionName:"swapExactTokensForTokens",args:[s,t,n,a,r]})}catch(e){console.error("Swap failed:",e)}},{isLoading:d,isSuccess:c}=(0,r.A)({hash:t});return{swap:o,writeData:t,isWriting:s,writeError:n,isConfirming:d,isConfirmed:c}}},38462:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return A}});var n=t(85893),a=t(35337),r=t(67294),i=t(92321),l=t(62634),o=t(23432),d=t(86501),c=t(27245),u=t(21774),m=t(50911),f=t(42171),x=t(15432),h=t(78865),p=t(98997);let g=m.fC;m.ZA;let b=m.B4,y=r.forwardRef((e,s)=>{let{className:t,children:a,...r}=e;return(0,n.jsxs)(m.xz,{ref:s,className:(0,p.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[a,(0,n.jsx)(m.JO,{asChild:!0,children:(0,n.jsx)(f.Z,{className:"h-4 w-4 opacity-50"})})]})});y.displayName=m.xz.displayName;let j=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(m.u_,{ref:s,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,n.jsx)(x.Z,{className:"h-4 w-4"})})});j.displayName=m.u_.displayName;let v=r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(m.$G,{ref:s,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",t),...a,children:(0,n.jsx)(f.Z,{className:"h-4 w-4"})})});v.displayName=m.$G.displayName;let w=r.forwardRef((e,s)=>{let{className:t,children:a,position:r="popper",...i}=e;return(0,n.jsx)(m.h_,{children:(0,n.jsxs)(m.VY,{ref:s,className:(0,p.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...i,children:[(0,n.jsx)(j,{}),(0,n.jsx)(m.l_,{className:(0,p.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,n.jsx)(v,{})]})})});w.displayName=m.VY.displayName,r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(m.__,{ref:s,className:(0,p.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})}).displayName=m.__.displayName;let N=r.forwardRef((e,s)=>{let{className:t,children:a,...r}=e;return(0,n.jsxs)(m.ck,{ref:s,className:(0,p.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(m.wU,{children:(0,n.jsx)(h.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(m.eT,{children:a})]})});N.displayName=m.ck.displayName,r.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)(m.Z0,{ref:s,className:(0,p.cn)("-mx-1 my-1 h-px bg-muted",t),...a})}).displayName=m.Z0.displayName;var k=t(93778),S=()=>{let e=(0,r.useContext)(k.M);if(void 0===e)throw Error("useTokenContext must be used within a TokenProvider");return e},T=t(19638),E=t(91529),C=t(301),_=()=>{let{address:e}=(0,i.m)(),{token:s}=S(),[t,a]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),[m,f]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),{approve:x,isWriting:h,isConfirmed:p,writeError:j}=(0,T.yA)(null==s?void 0:s.address),{approve:v,isWriting:k,isConfirmed:_,writeError:A}=(0,T.yA)(null==s?void 0:s.parentTokenAddress),{swap:z,isWriting:I,writeError:Z,isConfirming:F,isConfirmed:O}=(0,C.oN)(),[L,R]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&(a({address:s.parentTokenAddress,amount:0n,amountShow:"0",balance:0n,symbol:s.parentTokenSymbol}),f({address:s.address,amount:0n,amountShow:"0",balance:0n,symbol:s.symbol}))},[s]);let{balance:B,isPending:D,error:M}=(0,T.hS)(t.address,e),{balance:P,isPending:W,error:V}=(0,T.hS)(m.address,e);(0,r.useEffect)(()=>{B&&a(e=>({...e,balance:B})),P&&f(e=>({...e,balance:P}))},[B,P]);let{data:H,error:q,isLoading:G}=(0,C.op)(t.amount,[t.address,m.address]);console.log("--------------------------------"),console.log("fromTokenInfo.amount",t.amount),console.log("amountsOutError",q),console.log("amountsOut",H),console.log("isAmountsOutLoading",G),(0,r.useEffect)(()=>{(M||V)&&d.Am.error("授权失败")},[M,V]),(0,r.useEffect)(()=>{if(H&&H.length>1){let e=BigInt(H[1]);f(s=>({...s,amount:e,amountShow:(0,E.bM)(e)}))}},[H]);let X=async()=>{try{let e=(null==s?void 0:s.symbol)===t.symbol?x:v;await e("0xCB54233742E93C680B634DF5aDf33d28b288Dc95",t.amount)}catch(e){console.error(e),d.Am.error((null==e?void 0:e.message)||"授权失败")}};(0,r.useEffect)(()=>{(p||_)&&(d.Am.success("授权成功"),R(!0))},[p,_]);let Y=async()=>{try{let s=BigInt(Math.floor(Date.now()/1e3)+1200);await z(t.amount,t.amount/1055n*1000n,[t.address,m.address],e,s)}catch(e){console.error(e),d.Am.error((null==e?void 0:e.message)||"兑换失败")}};(0,r.useEffect)(()=>{O&&(d.Am.success("兑换成功"),setTimeout(()=>{window.location.reload()},2e3))},[O]);let[$,J]=(0,r.useState)("0");return(0,r.useEffect)(()=>{t.amountShow?J((.3*parseFloat(t.amountShow)/100).toFixed(4)):J("0")},[t.amountShow]),(0,n.jsx)("div",{className:"flex items-center justify-center bg-gray-100",children:(0,n.jsxs)("div",{className:"w-full max-w-md p-6 bg-white ",children:[(0,n.jsx)("h1",{className:"text-xl font-bold mb-6",children:"兑换"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,n.jsx)(u.I,{type:"number",placeholder:"0.0",className:"flex-grow",value:t.amountShow,onChange:e=>{let s=e.target.value;a({...t,amountShow:s}),""===s||parseFloat(s),s.endsWith(".")||a({...t,amount:(0,E.vz)(s),amountShow:s})},disabled:D||W||h||k||L||I}),(0,n.jsxs)(g,{value:t.address,onValueChange:e=>a({...t,address:e}),children:[(0,n.jsx)(y,{className:"w-[120px]",children:(0,n.jsx)(b,{placeholder:"选择代币"})}),(0,n.jsx)(w,{children:(0,n.jsx)(N,{value:t.address,children:t.symbol})})]})]}),(0,n.jsxs)("div",{className:"flex items-center text-sm gap-2",children:[(0,n.jsxs)("span",{className:"text-gray-400",children:[(0,E.LH)(t.balance||0n)," ",t.symbol]}),(0,n.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>{a(e=>({...e,amount:e.balance,amountShow:(0,E.bM)(e.balance)}))},children:"最高"})]})]}),(0,n.jsx)("div",{className:"flex justify-center my-4",children:(0,n.jsx)(c.z,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:()=>{m.amount=t.amount,m.amountShow=t.amountShow,t.amount=0n,t.amountShow="0",a(m),f(t)},children:(0,n.jsx)(l.Z,{className:"h-6 w-6"})})}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,n.jsx)(u.I,{type:"text",disabled:!0,placeholder:"0.0",className:"flex-grow",value:m.amountShow,readOnly:!0}),(0,n.jsxs)(g,{value:m.address,onValueChange:e=>f({...m,address:e}),children:[(0,n.jsx)(y,{className:"w-[120px]",children:(0,n.jsx)(b,{placeholder:"选择代币"})}),(0,n.jsx)(w,{children:(0,n.jsx)(N,{value:m.address,children:m.symbol})})]})]}),(0,n.jsx)("div",{className:"flex justify-between items-center text-sm",children:(0,n.jsxs)("span",{className:"text-gray-400",children:[(0,E.LH)(m.balance||0n)," ",m.symbol]})})]}),(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsxs)(c.z,{className:"w-1/2 text-white ".concat(L?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),onClick:X,disabled:h||k||L,children:[(h||k)&&(0,n.jsx)(o.Z,{className:"animate-spin"}),L?"已授权":"授权"]}),(0,n.jsxs)(c.z,{className:"w-1/2 text-white ".concat(L?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"),onClick:Y,disabled:!L||h||k||I,children:[I&&(0,n.jsx)(o.Z,{className:"animate-spin"}),"兑换"]})]}),q&&(0,n.jsx)("div",{className:"text-red-500",children:q.message}),Z&&(0,n.jsx)("div",{className:"text-red-500",children:Z.message}),j&&(0,n.jsx)("div",{className:"text-red-500",children:j.message}),A&&(0,n.jsx)("div",{className:"text-red-500",children:A.message}),t.amount>0n&&(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"手续费 (0.3%)："}),(0,n.jsxs)("span",{children:[$," ",t.symbol]})]}),(0,n.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"滑点上限 (自动)："}),(0,n.jsx)("span",{children:"5.5%"})]})]})]})})};function A(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{title:"Swap"}),(0,n.jsx)("main",{className:"flex-grow",children:(0,n.jsx)(_,{})})]})}}},function(e){e.O(0,[9215,3336,3621,2432,2888,9774,179],function(){return e(e.s=17137)}),_N_E=e.O()}]);
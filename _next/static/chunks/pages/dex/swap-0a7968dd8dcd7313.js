(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{17137:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dex/swap",function(){return a(38462)}])},98082:function(e,s,a){"use strict";a.d(s,{Cd:function(){return o},X:function(){return c},bZ:function(){return d}});var t=a(85893),n=a(67294),r=a(12003),l=a(40108);let i=(0,r.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=n.forwardRef((e,s)=>{let{className:a,variant:n,...r}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,l.cn)(i({variant:n}),a),...r})});d.displayName="Alert";let o=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)("h5",{ref:s,className:(0,l.cn)("mb-1 font-medium leading-none tracking-tight",a),...n})});o.displayName="AlertTitle";let c=n.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm [&_p]:leading-relaxed",a),...n})});c.displayName="AlertDescription"},58732:function(e,s,a){"use strict";var t=a(85893),n=a(9008),r=a.n(n);a(67294);var l=a(98082),i=a(68655),d=a(3294),o=a(78167),c=a(92321);s.Z=e=>{let{title:s}=e,{address:a,chain:n}=(0,c.m)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(r(),{children:[(0,t.jsx)("title",{children:"".concat(s," - LIFE20")}),(0,t.jsx)("meta",{name:"".concat(s," - LIFE20"),content:"A Web3 DApp for Life20 token management"})]}),(0,t.jsxs)("header",{className:"flex justify-between items-center py-2 px-4",children:[(0,t.jsx)(o.vP,{className:"-ml-1"}),(0,t.jsx)(d.NL,{})]}),a&&!n&&(0,t.jsx)("div",{className:"p-6",children:(0,t.jsxs)(l.bZ,{variant:"destructive",children:[(0,t.jsx)(i.Z,{className:"h-4 w-4"}),(0,t.jsx)(l.Cd,{children:a?"钱包网络错误":"未连接钱包"}),(0,t.jsx)(l.X,{children:a?"请切换到 ".concat("sepolia"," 网络"):"请先连接钱包，再进行操作"})]})})]})}},301:function(e,s,a){"use strict";a.d(s,{AT:function(){return o},op:function(){return d},oN:function(){return c}});var t=a(89810),n=a(71366),r=a(83540);let l=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],i="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",d=function(e,s){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:n,error:r,isLoading:d}=(0,t.u)({address:i,abi:l,functionName:"getAmountsOut",args:[e,s],query:{enabled:!!e&&s.length>=2&&a}});return{data:n,error:r,isLoading:d}},o=function(e,s){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:n,error:r,isLoading:d}=(0,t.u)({address:i,abi:l,functionName:"getAmountsIn",args:[e,s],query:{enabled:!!e&&s.length>=2&&a}});return{data:n,error:r,isLoading:d}};function c(){let{writeContract:e,isPending:s,data:a,error:t}=(0,n.S)(),d=async(s,a,t,n,r)=>{try{await e({address:i,abi:l,functionName:"swapExactTokensForTokens",args:[s,a,t,n,r]})}catch(e){console.error("Swap failed:",e)}},{isLoading:o,isSuccess:c}=(0,r.A)({hash:a});return{swap:d,writeData:a,isWriting:s,writeError:t,isConfirming:o,isConfirmed:c}}},38462:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return Z}});var t=a(85893),n=a(58732),r=a(67294),l=a(92321),i=a(62634),d=a(23432),o=a(86501),c=a(27245),u=a(21774),m=a(85443),f=a(42171),x=a(15432),p=a(78865),h=a(40108);let y=m.fC;m.ZA;let j=m.B4,g=r.forwardRef((e,s)=>{let{className:a,children:n,...r}=e;return(0,t.jsxs)(m.xz,{ref:s,className:(0,h.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...r,children:[n,(0,t.jsx)(m.JO,{asChild:!0,children:(0,t.jsx)(f.Z,{className:"h-4 w-4 opacity-50"})})]})});g.displayName=m.xz.displayName;let b=r.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(m.u_,{ref:s,className:(0,h.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(x.Z,{className:"h-4 w-4"})})});b.displayName=m.u_.displayName;let w=r.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(m.$G,{ref:s,className:(0,h.cn)("flex cursor-default items-center justify-center py-1",a),...n,children:(0,t.jsx)(f.Z,{className:"h-4 w-4"})})});w.displayName=m.$G.displayName;let N=r.forwardRef((e,s)=>{let{className:a,children:n,position:r="popper",...l}=e;return(0,t.jsx)(m.h_,{children:(0,t.jsxs)(m.VY,{ref:s,className:(0,h.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:r,...l,children:[(0,t.jsx)(b,{}),(0,t.jsx)(m.l_,{className:(0,h.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,t.jsx)(w,{})]})})});N.displayName=m.VY.displayName,r.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(m.__,{ref:s,className:(0,h.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",a),...n})}).displayName=m.__.displayName;let v=r.forwardRef((e,s)=>{let{className:a,children:n,...r}=e;return(0,t.jsxs)(m.ck,{ref:s,className:(0,h.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...r,children:[(0,t.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(m.wU,{children:(0,t.jsx)(p.Z,{className:"h-4 w-4"})})}),(0,t.jsx)(m.eT,{children:n})]})});v.displayName=m.ck.displayName,r.forwardRef((e,s)=>{let{className:a,...n}=e;return(0,t.jsx)(m.Z0,{ref:s,className:(0,h.cn)("-mx-1 my-1 h-px bg-muted",a),...n})}).displayName=m.Z0.displayName;var S=a(93778),T=()=>{let e=(0,r.useContext)(S.M);if(void 0===e)throw Error("useTokenContext must be used within a TokenProvider");return e},k=a(19638),C=a(91529),E=a(301),A=a(64777),_=()=>{let{address:e}=(0,l.m)(),{token:s}=T(),[a,n]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),[m,f]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),{approve:x,isWriting:p,isConfirmed:h,writeError:b}=(0,k.yA)(null==s?void 0:s.address),{approve:w,isWriting:S,isConfirmed:_,writeError:Z}=(0,k.yA)(null==s?void 0:s.parentTokenAddress),{swap:z,isWriting:F,writeError:I,isConfirming:R,isConfirmed:D}=(0,E.oN)(),[L,M]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&(n({address:s.parentTokenAddress,amount:0n,amountShow:"0",balance:0n,symbol:s.parentTokenSymbol}),f({address:s.address,amount:0n,amountShow:"0",balance:0n,symbol:s.symbol}))},[s]);let{balance:O,isPending:B,error:P}=(0,k.hS)(a.address,e),{balance:V,isPending:W,error:X}=(0,k.hS)(m.address,e);(0,r.useEffect)(()=>{O&&n(e=>({...e,balance:O})),V&&f(e=>({...e,balance:V}))},[O,V]);let{data:q,error:G,isLoading:H}=(0,E.op)(a.amount,[a.address,m.address]);(0,r.useEffect)(()=>{(P||X)&&o.Am.error("授权失败")},[P,X]),(0,r.useEffect)(()=>{if(q&&q.length>1){let e=BigInt(q[1]);f(s=>({...s,amount:e,amountShow:(0,C.bM)(e)}))}},[q]);let Y=async()=>{try{let e=(null==s?void 0:s.symbol)===a.symbol?x:w;await e("0xCB54233742E93C680B634DF5aDf33d28b288Dc95",a.amount)}catch(e){console.error(e),o.Am.error((null==e?void 0:e.message)||"授权失败")}};(0,r.useEffect)(()=>{(h||_)&&(o.Am.success("授权成功"),M(!0))},[h,_]);let $=async()=>{try{let s=BigInt(Math.floor(Date.now()/1e3)+1200);await z(a.amount,a.amount/1055n*1000n,[a.address,m.address],e,s)}catch(e){console.error(e),o.Am.error((null==e?void 0:e.message)||"兑换失败")}};(0,r.useEffect)(()=>{D&&(o.Am.success("兑换成功"),setTimeout(()=>{window.location.reload()},2e3))},[D]);let[J,U]=(0,r.useState)("0");return(0,r.useEffect)(()=>{a.amountShow?U((.3*parseFloat(a.amountShow)/100).toFixed(4)):U("0")},[a.amountShow]),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(A.Z,{title:"兑换"}),(0,t.jsxs)("div",{className:"w-full max-w-md mt-4",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(u.I,{type:"number",placeholder:"0.0",className:"flex-grow",value:a.amountShow,onChange:e=>{let s=e.target.value;n({...a,amountShow:s}),""===s||parseFloat(s),s.endsWith(".")||n({...a,amount:(0,C.vz)(s),amountShow:s})},disabled:B||W||p||S||L||F}),(0,t.jsxs)(y,{value:a.address,onValueChange:e=>n({...a,address:e}),children:[(0,t.jsx)(g,{className:"w-[120px]",children:(0,t.jsx)(j,{placeholder:"选择代币"})}),(0,t.jsx)(N,{children:(0,t.jsx)(v,{value:a.address,children:a.symbol})})]})]}),(0,t.jsxs)("div",{className:"flex items-center text-sm",children:[(0,t.jsxs)("span",{className:"text-greyscale-400",children:[(0,C.LH)(a.balance||0n)," ",a.symbol]}),(0,t.jsx)(c.z,{variant:"link",size:"sm",className:"text-secondary",onClick:()=>{n(e=>({...e,amount:e.balance,amountShow:(0,C.bM)(e.balance)}))},children:"最高"})]})]}),(0,t.jsx)("div",{className:"flex justify-center my-4",children:(0,t.jsx)(c.z,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:()=>{m.amount=a.amount,m.amountShow=a.amountShow,a.amount=0n,a.amountShow="0",n(m),f(a)},children:(0,t.jsx)(i.Z,{className:"h-6 w-6"})})}),(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,t.jsx)(u.I,{type:"text",disabled:!0,placeholder:"0.0",className:"flex-grow",value:m.amountShow,readOnly:!0}),(0,t.jsxs)(y,{value:m.address,onValueChange:e=>f({...m,address:e}),children:[(0,t.jsx)(g,{className:"w-[120px]",children:(0,t.jsx)(j,{placeholder:"选择代币"})}),(0,t.jsx)(N,{children:(0,t.jsx)(v,{value:m.address,children:m.symbol})})]})]}),(0,t.jsx)("div",{className:"flex justify-between items-center text-sm",children:(0,t.jsxs)("span",{className:"text-greyscale-400",children:[(0,C.LH)(m.balance||0n)," ",m.symbol]})})]}),(0,t.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,t.jsxs)(c.z,{className:"w-1/2",onClick:Y,disabled:p||S||L,children:[(p||S)&&(0,t.jsx)(d.Z,{className:"animate-spin"}),L?"1.已授权":"1.授权"]}),(0,t.jsxs)(c.z,{className:"w-1/2",onClick:$,disabled:!L||p||S||F||R||D,children:[(F||R)&&(0,t.jsx)(d.Z,{className:"animate-spin"}),F||R?"2.兑换中":"2.兑换"]})]}),G&&(0,t.jsx)("div",{className:"text-red-500",children:G.message}),I&&(0,t.jsx)("div",{className:"text-red-500",children:I.message}),b&&(0,t.jsx)("div",{className:"text-red-500",children:b.message}),Z&&(0,t.jsx)("div",{className:"text-red-500",children:Z.message}),a.amount>0n&&(0,t.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-greyscale-400",children:"手续费 (0.3%)："}),(0,t.jsxs)("span",{children:[J," ",a.symbol]})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-greyscale-400",children:"滑点上限 (自动)："}),(0,t.jsx)("span",{children:"5.5%"})]})]})]})]})};function Z(){return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.Z,{title:"Swap"}),(0,t.jsx)("main",{className:"flex-grow",children:(0,t.jsx)(_,{})})]})}}},function(e){e.O(0,[4209,4637,2888,9774,179],function(){return e(e.s=17137)}),_N_E=e.O()}]);
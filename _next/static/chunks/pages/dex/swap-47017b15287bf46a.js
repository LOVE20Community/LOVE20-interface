(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8026],{17137:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dex/swap",function(){return t(38462)}])},98082:function(e,s,t){"use strict";t.d(s,{Cd:function(){return o},X:function(){return c},bZ:function(){return d}});var a=t(85893),n=t(67294),r=t(12003),i=t(40108);let l=(0,r.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),d=n.forwardRef((e,s)=>{let{className:t,variant:n,...r}=e;return(0,a.jsx)("div",{ref:s,role:"alert",className:(0,i.cn)(l({variant:n}),t),...r})});d.displayName="Alert";let o=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("h5",{ref:s,className:(0,i.cn)("mb-1 font-medium leading-none tracking-tight",t),...n})});o.displayName="AlertTitle";let c=n.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)("div",{ref:s,className:(0,i.cn)("text-sm [&_p]:leading-relaxed",t),...n})});c.displayName="AlertDescription"},44576:function(e,s,t){"use strict";var a=t(85893);t(67294);var n=t(23432);s.Z=e=>{let{isLoading:s}=e;return s?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(n.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,a.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:"Loading"})]})}):null}},58732:function(e,s,t){"use strict";var a=t(85893),n=t(9008),r=t.n(n);t(67294);var i=t(98082),l=t(68655),d=t(3294),o=t(91907),c=t(92321);s.Z=e=>{let{title:s}=e,{address:t,chain:n}=(0,c.m)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(r(),{children:[(0,a.jsx)("title",{children:"".concat(s," - LIFE20")}),(0,a.jsx)("meta",{name:"".concat(s," - LIFE20"),content:"A Web3 DApp for Life20 token management"})]}),(0,a.jsxs)("header",{className:"flex justify-between items-center py-2 px-4",children:[(0,a.jsx)(o.vP,{className:"-ml-1"}),(0,a.jsx)(d.NL,{})]}),t&&!n&&(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)(i.bZ,{variant:"destructive",children:[(0,a.jsx)(l.Z,{className:"h-4 w-4"}),(0,a.jsx)(i.Cd,{children:t?"钱包网络错误":"未连接钱包"}),(0,a.jsx)(i.X,{children:t?"请切换到 ".concat("sepolia"," 网络"):"请先连接钱包，再进行操作"})]})})]})}},301:function(e,s,t){"use strict";t.d(s,{AT:function(){return o},op:function(){return d},oN:function(){return c}});var a=t(89810),n=t(71366),r=t(83540);let i=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],l="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",d=function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:n,error:r,isLoading:d}=(0,a.u)({address:l,abi:i,functionName:"getAmountsOut",args:[e,s],query:{enabled:!!e&&s.length>=2&&t}});return{data:n,error:r,isLoading:d}},o=function(e,s){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:n,error:r,isLoading:d}=(0,a.u)({address:l,abi:i,functionName:"getAmountsIn",args:[e,s],query:{enabled:!!e&&s.length>=2&&t}});return{data:n,error:r,isLoading:d}};function c(){let{writeContract:e,isPending:s,data:t,error:a}=(0,n.S)(),d=async(s,t,a,n,r)=>{try{await e({address:l,abi:i,functionName:"swapExactTokensForTokens",args:[s,t,a,n,r]})}catch(e){console.error("Swap failed:",e)}},{isLoading:o,isSuccess:c}=(0,r.A)({hash:t});return{swap:d,writeData:t,isWriting:s,writeError:a,isConfirming:o,isConfirmed:c}}},38462:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return F}});var a=t(85893),n=t(58732),r=t(62634),i=t(27245),l=t(21774),d=t(67294),o=t(85443),c=t(42171),u=t(15432),m=t(78865),f=t(40108);let x=o.fC;o.ZA;let p=o.B4,h=d.forwardRef((e,s)=>{let{className:t,children:n,...r}=e;return(0,a.jsxs)(o.xz,{ref:s,className:(0,f.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[n,(0,a.jsx)(o.JO,{asChild:!0,children:(0,a.jsx)(c.Z,{className:"h-4 w-4 opacity-50"})})]})});h.displayName=o.xz.displayName;let y=d.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(o.u_,{ref:s,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,a.jsx)(u.Z,{className:"h-4 w-4"})})});y.displayName=o.u_.displayName;let j=d.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(o.$G,{ref:s,className:(0,f.cn)("flex cursor-default items-center justify-center py-1",t),...n,children:(0,a.jsx)(c.Z,{className:"h-4 w-4"})})});j.displayName=o.$G.displayName;let g=d.forwardRef((e,s)=>{let{className:t,children:n,position:r="popper",...i}=e;return(0,a.jsx)(o.h_,{children:(0,a.jsxs)(o.VY,{ref:s,className:(0,f.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...i,children:[(0,a.jsx)(y,{}),(0,a.jsx)(o.l_,{className:(0,f.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:n}),(0,a.jsx)(j,{})]})})});g.displayName=o.VY.displayName,d.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(o.__,{ref:s,className:(0,f.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...n})}).displayName=o.__.displayName;let b=d.forwardRef((e,s)=>{let{className:t,children:n,...r}=e;return(0,a.jsxs)(o.ck,{ref:s,className:(0,f.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(o.wU,{children:(0,a.jsx)(m.Z,{className:"h-4 w-4"})})}),(0,a.jsx)(o.eT,{children:n})]})});b.displayName=o.ck.displayName,d.forwardRef((e,s)=>{let{className:t,...n}=e;return(0,a.jsx)(o.Z0,{ref:s,className:(0,f.cn)("-mx-1 my-1 h-px bg-muted",t),...n})}).displayName=o.Z0.displayName;var v=t(86501),w=t(92321),N=t(11163),S=t(78543),T=t(91529),k=t(19638),C=t(301),A=t(64777),E=t(44576),_=t(93778),Z=()=>{let e=(0,d.useContext)(_.M);if(void 0===e)throw Error("useTokenContext must be used within a TokenProvider");return e},z=()=>{let{address:e,chain:s}=(0,w.m)(),{token:t}=Z(),n=(0,N.useRouter)(),[o,c]=(0,d.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),[u,m]=(0,d.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),{approve:f,isWriting:y,isConfirming:j,isConfirmed:_,writeError:z}=(0,k.yA)(null==t?void 0:t.address),{approve:F,isWriting:R,isConfirming:I,isConfirmed:L,writeError:D}=(0,k.yA)(null==t?void 0:t.parentTokenAddress),{swap:M,isWriting:O,writeError:B,isConfirming:P,isConfirmed:V}=(0,C.oN)(),W=y||R||j||I,X=_||L;(0,d.useEffect)(()=>{t&&(c({address:t.parentTokenAddress,amount:0n,amountShow:"0",balance:0n,symbol:t.parentTokenSymbol}),m({address:t.address,amount:0n,amountShow:"0",balance:0n,symbol:t.symbol}))},[t]);let{balance:q,isPending:G,error:H}=(0,k.hS)(o.address,e),{balance:Y,isPending:$,error:J}=(0,k.hS)(u.address,e);(0,d.useEffect)(()=>{q&&c(e=>({...e,balance:q})),Y&&m(e=>({...e,balance:Y}))},[q,Y]);let{data:U,error:K,isLoading:Q}=(0,C.op)(o.amount,[o.address,u.address]);(0,d.useEffect)(()=>{(H||J)&&v.Am.error("授权失败")},[H,J]),(0,d.useEffect)(()=>{if(U&&U.length>1){let e=BigInt(U[1]);m(s=>({...s,amount:e,amountShow:(0,T.bM)(e)}))}},[U]);let ee=async()=>{if(en())try{let e=(null==t?void 0:t.symbol)===o.symbol?f:F;await e("0xCB54233742E93C680B634DF5aDf33d28b288Dc95",o.amount)}catch(e){console.error(e),v.Am.error((null==e?void 0:e.message)||"授权失败")}},es=async()=>{if(en())try{let s=BigInt(Math.floor(Date.now()/1e3)+1200);await M(o.amount,o.amount/1055n*1000n,[o.address,u.address],e,s)}catch(e){console.error(e),v.Am.error((null==e?void 0:e.message)||"兑换失败")}};(0,d.useEffect)(()=>{V&&(v.Am.success("兑换成功"),setTimeout(()=>{n.push("/my/?symbol=".concat(null==t?void 0:t.symbol))},2e3))},[V]);let[et,ea]=(0,d.useState)("0");(0,d.useEffect)(()=>{o.amountShow?ea((.3*parseFloat(o.amountShow)/100).toFixed(4)):ea("0")},[o.amountShow]);let en=()=>!!(0,S.S)(s)&&(!(o.amount<=0n)||(v.Am.error("兑换数量不能为0"),!1));return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)(A.Z,{title:"兑换"}),(0,a.jsxs)("div",{className:"w-full max-w-md mt-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(l.I,{type:"number",placeholder:"0.0",className:"flex-grow",value:o.amountShow,onChange:e=>{let s=e.target.value;c({...o,amountShow:s}),""===s||parseFloat(s),s.endsWith(".")||c({...o,amount:(0,T.vz)(s),amountShow:s})},disabled:G||$||X}),(0,a.jsxs)(x,{value:o.address,onValueChange:e=>c({...o,address:e}),disabled:G||$||X,children:[(0,a.jsx)(h,{className:"w-[120px]",children:(0,a.jsx)(p,{placeholder:"选择代币"})}),(0,a.jsx)(g,{children:(0,a.jsx)(b,{value:o.address,children:o.symbol})})]})]}),(0,a.jsxs)("div",{className:"flex items-center text-sm",children:[(0,a.jsxs)("span",{className:"text-greyscale-400",children:[(0,T.LH)(o.balance||0n)," ",o.symbol]}),(0,a.jsx)(i.z,{variant:"link",size:"sm",className:"text-secondary",onClick:()=>{c(e=>({...e,amount:e.balance,amountShow:(0,T.bM)(e.balance)}))},disabled:G||$||X,children:"最高"})]})]}),(0,a.jsx)("div",{className:"flex justify-center my-4",children:(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:()=>{u.amount=o.amount,u.amountShow=o.amountShow,o.amount=0n,o.amountShow="0",c(u),m(o)},disabled:G||$||X,children:(0,a.jsx)(r.Z,{className:"h-6 w-6"})})}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(l.I,{type:"text",disabled:!0,placeholder:"0.0",className:"flex-grow",value:u.amountShow,readOnly:!0}),(0,a.jsxs)(x,{value:u.address,onValueChange:e=>m({...u,address:e}),children:[(0,a.jsx)(h,{className:"w-[120px]",children:(0,a.jsx)(p,{placeholder:"选择代币"})}),(0,a.jsx)(g,{children:(0,a.jsx)(b,{value:u.address,children:u.symbol})})]})]}),(0,a.jsx)("div",{className:"flex justify-between items-center text-sm",children:(0,a.jsxs)("span",{className:"text-greyscale-400",children:[(0,T.LH)(u.balance||0n)," ",u.symbol]})})]}),(0,a.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,a.jsx)(i.z,{className:"w-1/2",onClick:ee,disabled:W||X,children:y||R?"1.授权中...":j||I?"1.确认中...":X?"1.已授权":"1.授权"}),(0,a.jsx)(i.z,{className:"w-1/2",onClick:es,disabled:!X||W||O||P||V,children:O?"2.兑换中...":P?"2.确认中...":V?"2.已兑换":"2.兑换"})]}),K&&(0,a.jsx)("div",{className:"text-red-500",children:K.message}),B&&(0,a.jsx)("div",{className:"text-red-500",children:B.message}),z&&(0,a.jsx)("div",{className:"text-red-500",children:z.message}),D&&(0,a.jsx)("div",{className:"text-red-500",children:D.message}),o.amount>0n&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-greyscale-400",children:"手续费 (0.3%)："}),(0,a.jsxs)("span",{children:[et," ",o.symbol]})]}),(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-greyscale-400",children:"滑点上限 (自动)："}),(0,a.jsx)("span",{children:"5.5%"})]})]})]}),(0,a.jsx)(E.Z,{isLoading:W||O||P})]})};function F(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Z,{title:"兑换代币"}),(0,a.jsx)("main",{className:"flex-grow",children:(0,a.jsx)(z,{})})]})}},78543:function(e,s,t){"use strict";t.d(s,{S:function(){return n}});var a=t(86501);let n=e=>!!e||(a.Am.error("请先将钱包链接 ".concat("sepolia")),!1)}},function(e){e.O(0,[2192,4637,2888,9774,179],function(){return e(e.s=17137)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{85719:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return r(48585)}])},74089:function(e,n,r){"use strict";var t=r(85893),s=r(67294),i=r(91529);n.Z=e=>{let{initialTimeLeft:n}=e,[r,c]=(0,s.useState)(n);(0,s.useEffect)(()=>{if(n<=0)return;c(n);let e=setInterval(()=>{c(n=>n<=1?(clearInterval(e),console.log("1.prevTime",n),window.location.reload(),0):(console.log("2.prevTime",n),n-1))},1e3);return()=>{clearInterval(e)}},[n]);let a=(0,i.ZC)(r);return(0,t.jsx)(t.Fragment,{children:a})}},91318:function(e,n,r){"use strict";var t=r(85893);n.Z=()=>(0,t.jsx)("span",{className:"flex justify-center items-center",children:(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,n,r){"use strict";var t=r(85893);r(67294);var s=r(3125),i=r(74089);n.Z=e=>{let{currentRound:n,roundName:r}=e,{data:c}=(0,s.O)(),a=Number("100")||0,l=Number("12")||0,o=c?a-Number(c)%a:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h1",{className:"text-base text-center font-bold",children:[r,"（第 ",(0,t.jsx)("span",{className:"text-red-500",children:Number(null!=n?n:0n)})," 轮）"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(i.Z,{initialTimeLeft:o>0?o*l:0})]})]})}},18308:function(e,n,r){"use strict";var t=r(85893),s=r(67294),i=r(92321),c=r(41664),a=r.n(c),l=r(7080),o=r(87250),d=r(93778),u=r(91529),x=r(91318),f=r(7191);n.Z=e=>{let{currentRound:n,showBtn:r=!0}=e,{token:c}=(0,s.useContext)(d.M)||{},{address:m}=(0,i.m)(),{votesNumByAccount:h,isPending:g,error:j}=(0,l.VI)(null==c?void 0:c.address,n,m||""),{scoreByVerifier:N,isPending:y,error:b}=(0,o.w3)(null==c?void 0:c.address,n,m||""),p=g||y?BigInt(0):h-N;return(0,t.jsxs)("div",{className:"flex flex-col items-center bg-white py-4",children:[(0,t.jsx)(f.Z,{currentRound:n,roundName:"验证轮"}),(0,t.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:y?(0,t.jsx)(x.Z,{}):(0,u.LH)(N||BigInt(0))})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:g||y?(0,t.jsx)(x.Z,{}):(0,u.LH)(p)})]})]}),r&&(g||y?(0,t.jsx)(x.Z,{}):h>N?(0,t.jsx)(a(),{href:"/verify",className:"btn-primary btn w-1/2",children:"去验证"}):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"无剩余验证票"}))]})}},48585:function(e,n,r){"use strict";r.r(n),r.d(n,{default:function(){return h}});var t=r(85893),s=r(35337),i=r(87250),c=r(18308),a=r(67294),l=r(41664),o=r.n(l),d=r(7080),u=r(94782),x=r(93778),f=r(91318),m=e=>{let{currentRound:n}=e,{token:r}=(0,a.useContext)(x.M)||{},{actionIds:s,votes:i,isPending:c,error:l}=(0,d.$S)((null==r?void 0:r.address)||"",n),{actionInfos:m,isPending:h,error:g}=(0,u.fT)((null==r?void 0:r.address)||"",s||[]);return c||s&&s.length>0&&h?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(f.Z,{})}):l||g?(console.log("errorVotesNums",l),console.log("errorActionInfosByIds",g),(0,t.jsx)("div",{children:"加载出错，请稍后再试。"})):(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h2",{className:"text-sm font-bold mb-4 text-gray-600",children:"待验证行动"}),(0,t.jsx)("div",{className:"space-y-4",children:null==m?void 0:m.map((e,n)=>(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg mb-4",children:(0,t.jsxs)(o(),{href:"/verify/".concat(e.head.id),children:[(0,t.jsxs)("div",{className:"font-semibold mb-2",children:[(0,t.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,t.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,t.jsx)("p",{className:"leading-tight",children:e.body.consensus})]},e.head.id)},e.head.id))})]})},h=()=>{let{currentRound:e}=(0,i.Bk)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Z,{title:"社区首页"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(c.Z,{currentRound:e,showBtn:!1}),(0,t.jsx)(m,{currentRound:e})]})]})}},3125:function(e,n,r){"use strict";r.d(n,{O:function(){return x}});var t=r(30202),s=r(97712),i=r(81946),c=r(36100),a=r(82451),l=r(82002),o=r(37122),d=r(65185),u=r(67294);function x(e={}){let{query:n={},watch:r}=e,x=(0,o.Z)(e),f=(0,t.NL)(),m=(0,l.x)({config:x}),h=e.chainId??m,g=function(e,n={}){return{gcTime:0,async queryFn({queryKey:n}){let{scopeKey:r,...t}=n[1];return await function(e,n={}){let{chainId:r,...t}=n,c=e.getClient({chainId:r});return(0,i.s)(c,s.z,"getBlockNumber")(t)}(e,t)??null},queryKey:function(e={}){return["blockNumber",(0,c.OP)(e)]}(n)}}(x,{...e,chainId:h});return!function(e={}){let{enabled:n=!0,onBlockNumber:r,config:t,...s}=e,c=(0,o.Z)(e),a=(0,l.x)({config:c}),x=e.chainId??a;(0,u.useEffect)(()=>{if(n&&r)return function(e,n){let r,t;let{syncConnectedChain:s=e._internal.syncConnectedChain,...c}=n,a=n=>{r&&r();let t=e.getClient({chainId:n});return r=(0,i.s)(t,d.q,"watchBlockNumber")(c)},l=a(n.chainId);return s&&!n.chainId&&(t=e.subscribe(({chainId:e})=>e,async e=>a(e))),()=>{l?.(),t?.()}}(c,{...s,chainId:x,onBlockNumber:r})},[x,c,n,r,s.onError,s.emitMissed,s.emitOnBegin,s.poll,s.pollingInterval,s.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof r?r:{}},enabled:!!((n.enabled??!0)&&("object"==typeof r?r.enabled:r)),onBlockNumber(e){f.setQueryData(g.queryKey,e)}}),(0,a.aM)({...n,...g})}},89810:function(e,n,r){"use strict";r.d(n,{u:function(){return l}});var t=r(37003),s=r(36100),i=r(82451),c=r(82002),a=r(37122);function l(e={}){let{abi:n,address:r,functionName:l,query:o={}}=e,d=e.code,u=(0,a.Z)(e),x=(0,c.x)({config:u}),f=function(e,n={}){return{async queryFn({queryKey:r}){let s=n.abi;if(!s)throw Error("abi is required");let{functionName:i,scopeKey:c,...a}=r[1],l=(()=>{let e=r[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!i)throw Error("functionName is required");return(0,t.L)(e,{abi:s,functionName:i,args:a.args,...l,...a})},queryKey:function(e={}){let{abi:n,...r}=e;return["readContract",(0,s.OP)(r)]}(n)}}(u,{...e,chainId:e.chainId??x}),m=!!((r||d)&&n&&l&&(o.enabled??!0));return(0,i.aM)({...o,...f,enabled:m,structuralSharing:o.structuralSharing??s.if})}}},function(e){e.O(0,[4784,7140,7080,7250,2888,9774,179],function(){return e(e.s=85719)}),_N_E=e.O()}]);
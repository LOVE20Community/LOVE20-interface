(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return t(75959)}])},34680:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return c},Zb:function(){return a},aY:function(){return o},eW:function(){return u},ll:function(){return d}});var n=t(85893),r=t(67294),l=t(40108);let a=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});a.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...r})});c.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...r})});u.displayName="CardFooter"},34426:function(e,s,t){"use strict";t.d(s,{Z:function(){return o}});var n=t(85893),r=t(67294),l=t(23432),a=t(93461),i=t(92321),d=t(32209),c=t(86501);function o(e){let{tokenAddress:s,tokenSymbol:t,tokenDecimals:o,tokenImage:u}=e,[x,m]=(0,r.useState)(!1),{isConnected:f}=(0,i.m)(),{data:j}=(0,d.p)(),h=async()=>{if(!f){alert("请先连接你的钱包");return}m(!0);try{if(!j){alert("无法获取钱包客户端");return}await j.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:t,decimals:o,image:u}}})?(console.log("代币已添加到 MetaMask 钱包"),c.ZP.success("代币已成功添加到 MetaMask 钱包")):(console.log("用户拒绝添加代币"),c.ZP.error("用户拒绝添加代币"))}catch(e){console.error("添加代币失败:",e),c.ZP.error("添加代币失败，请检查控制台以获取更多信息")}finally{m(!1)}};return(0,n.jsx)("button",{onClick:h,disabled:x,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:x?(0,n.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(a.Z,{className:"h-4 w-4 text-greyscale-500"})})}},74089:function(e,s,t){"use strict";var n=t(85893),r=t(67294);s.Z=e=>{let{initialTimeLeft:s}=e,[t,l]=(0,r.useState)(s);(0,r.useEffect)(()=>{if(s<=0)return;l(s);let e=setInterval(()=>{l(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let a=Math.floor(t/86400);return(0,n.jsxs)("div",{className:"inline-flex gap-1  text-secondary",children:[a>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":a}})}),"天"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":Math.floor(t%86400/3600)}})}),"时"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":Math.floor(t%3600/60)}})}),"分"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":t%60}})}),"秒"]})]})}},7191:function(e,s,t){"use strict";var n=t(85893),r=t(67294),l=t(42757),a=t(93778),i=t(74089);s.Z=e=>{let{currentRound:s,roundName:t}=e,{data:d}=(0,l.O)(),{token:c}=(0,r.useContext)(a.M)||{},o=Number("100")||0,u=Number("12")||0,x=d?o-(Number(d)-Number(null==c?void 0:c.voteOriginBlocks))%o:0;return(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsxs)("h1",{className:"text-lg font-bold",children:[t," 第 ",(0,n.jsx)("span",{className:"text-secondary",children:Number(null!=s?s:0n)})," 轮"]}),(0,n.jsxs)("span",{className:"text-sm text-greyscale-400 mt-1 pt-0",children:["本轮剩余：",(0,n.jsx)(i.Z,{initialTimeLeft:x>0?x*u:0})]})]})}},66247:function(e,s,t){"use strict";t.d(s,{Z:function(){return u}});var n=t(85893),r=t(67294),l=t(93778),a=t(19638),i=t(42083),d=t(27460),c=t(34426),o=e=>{let{}=e,{token:s}=(0,r.useContext)(l.M)||{};return s?(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)("div",{className:"mr-2",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-bold text-2xl mr-2",children:s.symbol}),(0,n.jsx)(d.Z,{address:s.address}),(0,n.jsx)(c.Z,{tokenAddress:s.address,tokenSymbol:s.symbol||"",tokenDecimals:s.decimals||0})]})})}):(0,n.jsx)(i.Z,{})};function u(){let{token:e}=(0,r.useContext)(l.M)||{},{totalSupply:s,isPending:t,error:d}=(0,a.A5)((null==e?void 0:e.address)||""),[c,u]=(0,r.useState)(!1);return(null==e?void 0:e.address)?(0,n.jsxs)("div",{className:"px-6 pt-2 pb-6",children:[(0,n.jsx)(o,{}),!1]}):(0,n.jsx)(i.Z,{})}},75959:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return g}});var n=t(85893),r=t(5028),l=t(67294),a=t(7399),i=t(93778),d=t(91529),c=t(42083),o=t(7191),u=e=>{let{currentRound:s}=e,{token:t}=(0,l.useContext)(i.M)||{},{rewardAvailable:u,isPending:x,error:m}=(0,a.CY)((null==t?void 0:t.address)||""),{joinedAmount:f,isPending:j,error:h}=(0,r.fP)((null==t?void 0:t.address)||"",s);return(0,n.jsxs)("div",{className:"px-6",children:[(0,n.jsx)(o.Z,{currentRound:s,roundName:"行动轮"}),(0,n.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title",children:"预计新增铸币"}),(0,n.jsx)("div",{className:"stat-value text-2xl",children:x||void 0===u?(0,n.jsx)(c.Z,{}):(0,d.LH)(99n*u/10000n)})]}),(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title",children:"参与行动代币"}),(0,n.jsx)("div",{className:"stat-value text-2xl",children:j?(0,n.jsx)(c.Z,{}):(0,d.LH)(f||BigInt(0))})]})]})]})},x=t(58732),m=t(41664),f=t.n(m),j=t(92321),h=t(34680),N=t(45551),v=t(94782),p=t(64777),y=e=>{let{currentRound:s}=e,{token:t}=(0,l.useContext)(i.M)||{},{address:r}=(0,j.m)(),{actions:a,isPending:o,error:u}=(0,N.jA)((null==t?void 0:t.address)||"",s);null==a||a.sort((e,s)=>Number(e.actionId)-Number(s.actionId));let x=null==a?void 0:a.map(e=>e.actionId),m=(null==a?void 0:a.reduce((e,s)=>e+s.votesNum,0n))||0n,{actionInfos:y,isPending:b,error:g}=(0,v.fT)((null==t?void 0:t.address)||"",x||[]),{joinedActions:w,isPending:Z,error:C}=(0,N.dB)((null==t?void 0:t.address)||"",r);if(u||g||C)return console.error("errorJoinableActions",u),console.error("errorActionInfosByIds",g),console.error("errorJoinedActions",C),(0,n.jsx)("div",{children:"加载出错，请稍后再试。"});let k=o||a&&a.length>0&&b||Z;return(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsx)(p.Z,{title:"进行中的行动"}),!r&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"}),r&&k&&(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(c.Z,{})}),!k&&!(null==x?void 0:x.length)&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"本轮暂无行动"}),!k&&x&&x.length>0&&(0,n.jsx)("div",{className:"mt-4 space-y-4",children:null==y?void 0:y.map((e,s)=>{let r=(null==w?void 0:w.some(s=>s.actionId===BigInt(e.head.id)))?"/action/".concat(e.head.id,"?type=join&symbol=").concat(null==t?void 0:t.symbol):"/acting/join?id=".concat(e.head.id,"&symbol=").concat(null==t?void 0:t.symbol);return(0,n.jsx)(h.Zb,{className:"shadow-none",children:(0,n.jsxs)(f(),{href:r,children:[(0,n.jsxs)(h.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,n.jsxs)(h.aY,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,n.jsxs)("span",{className:"text-secondary",children:[(100*Number((null==a?void 0:a[s].votesNum)||0n)/Number(m)).toFixed(1),"%"]})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"参与代币数"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,d.LH)((null==a?void 0:a[s].joinedAmount)||0n)})]})]})]})]})},e.head.id)})})]})},b=t(66247),g=()=>{let{currentRound:e}=(0,r.Bk)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{title:"社区首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(b.Z,{}),(0,n.jsx)(u,{currentRound:e}),(0,n.jsx)(y,{currentRound:e})]})]})}}},function(e){e.O(0,[1664,2209,3543,1502,4637,9871,5112,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1786],{75125:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote",function(){return s(36968)}])},27245:function(e,t,s){"use strict";s.d(t,{z:function(){return o}});var n=s(85893),r=s(67294),i=s(88426),a=s(45139),c=s(98997);let l=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,t)=>{let{className:s,variant:r,size:a,asChild:o=!1,...d}=e,u=o?i.g7:"button";return(0,n.jsx)(u,{className:(0,c.cn)(l({variant:r,size:a,className:s})),ref:t,...d})});o.displayName="Button"},98997:function(e,t,s){"use strict";s.d(t,{cn:function(){return i}});var n=s(90512),r=s(98388);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,r.m6)((0,n.W)(t))}},27460:function(e,t,s){"use strict";var n=s(85893),r=s(86501),i=s(74855),a=s(45356),c=s(91529);t.Z=e=>{let{address:t,showCopyButton:s=!0}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-xs text-gray-500",children:(0,c.Vu)(t)}),s&&(0,n.jsx)(i.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?r.ZP.success("复制成功"):r.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,n.jsx)(a.Z,{className:"h-4 w-4 text-xs text-gray-500"})})})]})}},91318:function(e,t,s){"use strict";var n=s(85893);t.Z=()=>(0,n.jsx)("span",{className:"flex justify-center items-center",children:(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,t,s){"use strict";var n=s(85893);s(67294);var r=s(3125),i=s(91529),a=s(34155);t.Z=e=>{let{currentRound:t,roundName:s}=e,{data:c}=(0,r.O)(),l=c?Number("100")-Number(c)%Number("100"):0,o=l>0?Number(l)*Number(a.env.NEXT_PUBLIC_BLOCK_TIME):0,d=(0,i.ZC)(o);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h1",{className:"text-base text-center font-bold",children:[s,"（第 ",(0,n.jsx)("span",{className:"text-red-500",children:Number(null!=t?t:0n)})," 轮）"]}),(0,n.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",d]})]})}},36968:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var n=s(85893),r=s(35337),i=s(41664),a=s.n(i),c=s(7080),l=s(67294),o=s(11163),d=s(86501),u=s(27245),x=s(94782),m=s(93778),h=s(91318),f=s(27460),g=e=>{let{currentRound:t}=e,{token:s}=(0,l.useContext)(m.M)||{},r=(0,o.useRouter)(),{votes:i,isPending:g,error:v}=(0,c.$S)((null==s?void 0:s.address)||"",t),{actionSubmits:b,isPending:p,error:N}=(0,x.WZ)((null==s?void 0:s.address)||"",t),j=Array.from(new Set((null==b?void 0:b.map(e=>BigInt(e.actionId)))||[])).sort((e,t)=>Number(e)-Number(t)),{actionInfos:y,isPending:w,error:k}=(0,x.fT)((null==s?void 0:s.address)||"",j),[_,C]=(0,l.useState)(new Set),Z=e=>{C(t=>{let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},B=(null==i?void 0:i.reduce((e,t)=>e+t,0n))||0n;return g||p||j&&j.length>0&&w?(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(h.Z,{})}):N||k?(0,n.jsx)("div",{children:"加载出错，请稍后再试。"}):(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h2",{className:"text-sm font-bold mb-4 text-gray-600",children:"行动列表 (行动轮)"}),(0,n.jsx)("div",{className:"space-y-4",children:j.length>0?(0,n.jsxs)(n.Fragment,{children:[null==y?void 0:y.map((e,t)=>{var s;let r=null==b?void 0:null===(s=b.find(t=>BigInt(t.actionId)===BigInt(e.head.id)))||void 0===s?void 0:s.submitter;return(0,n.jsxs)("div",{className:"flex bg-white p-4 rounded-lg mb-4",children:[(0,n.jsx)("input",{type:"checkbox",className:"checkbox checkbox-warning mr-2",checked:_.has(BigInt(e.head.id)),onChange:()=>Z(BigInt(e.head.id))}),(0,n.jsxs)(a(),{href:"/action/".concat(e.head.id,"?type=vote"),className:"flex-grow block",children:[(0,n.jsxs)("div",{className:"font-semibold mb-2",children:[(0,n.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,n.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,n.jsx)("p",{className:"leading-tight",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-gray-400",children:[(0,n.jsxs)("span",{className:"text-sm flex-1",children:["推举人 ",(0,n.jsx)(f.Z,{address:r,showCopyButton:!1})]}),(0,n.jsxs)("span",{className:"text-sm flex-1 text-right",children:[(0,n.jsx)("span",{className:"mr-1",children:"投票占比"}),0===Number((null==i?void 0:i[t])||0n)?"0":(100*Number((null==i?void 0:i[t])||0n)/Number(B)).toFixed(1),"%"]})]})]})]},e.head.id)}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:(0,n.jsx)(u.z,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>{let e=Array.from(_).join(",");if(0===e.length){d.Am.error("请选择行动");return}r.push("/vote/vote?ids=".concat(e))},children:"投票"})})]}):(0,n.jsx)("div",{className:"text-sm text-gray-500 text-center",children:"没有行动"})})]})},v=s(7191),b=()=>{let{currentRound:e,isPending:t,error:s}=(0,c.Bk)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.Z,{title:"投票首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-6 bg-white",children:[t?(0,n.jsx)(h.Z,{}):(0,n.jsx)(v.Z,{currentRound:e,roundName:"投票轮"}),(0,n.jsx)(a(),{href:"/vote/actions4submit",className:"w-1/2",children:(0,n.jsx)(u.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"推举其他行动"})})]}),(0,n.jsx)(g,{currentRound:e})]})]})}}},function(e){e.O(0,[4784,8424,8840,7140,7080,2888,9774,179],function(){return e(e.s=75125)}),_N_E=e.O()}]);
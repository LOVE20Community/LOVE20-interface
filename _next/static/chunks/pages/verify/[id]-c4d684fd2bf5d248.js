(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5394],{143:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify/[id]",function(){return r(37295)}])},27245:function(e,s,r){"use strict";r.d(s,{z:function(){return o}});var t=r(85893),n=r(67294),i=r(88426),a=r(45139),l=r(98997);let c=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,s)=>{let{className:r,variant:n,size:a,asChild:o=!1,...d}=e,u=o?i.g7:"button";return(0,t.jsx)(u,{className:(0,l.cn)(c({variant:n,size:a,className:r})),ref:s,...d})});o.displayName="Button"},98997:function(e,s,r){"use strict";r.d(s,{cn:function(){return i}});var t=r(90512),n=r(98388);function i(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,n.m6)((0,t.W)(s))}},91318:function(e,s,r){"use strict";var t=r(85893);s.Z=()=>(0,t.jsx)("span",{className:"flex justify-center items-center",children:(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},37295:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return j}});var t=r(85893),n=r(11163),i=r(67294),a=r(87250),l=r(35337),c=r(20725),o=r(92321),d=r(7080),u=r(93778),x=r(91529),m=r(91318),f=e=>{let{currentRound:s,actionId:r,onRemainingVotesChange:n}=e,{token:l}=(0,i.useContext)(u.M)||{},{address:c}=(0,o.m)(),{votesNumByAccountByActionId:f,isPending:g,error:h}=(0,d.Ol)(null==l?void 0:l.address,s,c||"",r),{scoreByVerifierByActionId:v,isPending:b,error:p}=(0,a.Tl)(null==l?void 0:l.address,s,c||"",r),j=g||b?BigInt(0):f-v;return(0,i.useEffect)(()=>{g||b||null==n||n(j)},[j]),(0,t.jsx)("div",{className:"mb-4 text-center",children:(0,t.jsxs)("span",{className:"font-semibold",children:["我的剩余验证票数：",g||b?(0,t.jsx)(m.Z,{}):(0,t.jsx)("span",{className:"text-orange-500",children:(0,x.LH)(j)})]})})},g=r(86501),h=r(45551),v=r(27460),b=r(27245),p=e=>{let{currentRound:s,actionId:r,remainingVotes:l}=e,{token:c}=(0,i.useContext)(u.M)||{},o=(0,n.useRouter)(),{accounts:d,infos:x,isPending:f,error:p}=(0,h.X5)(null==c?void 0:c.address,s,r);(0,i.useEffect)(()=>{if(d&&d.length>0){let e=Math.floor(100/d.length).toString(),s={};d.forEach(r=>{s[r]=e}),y(s)}},[d]);let[j,y]=(0,i.useState)({}),N=100-Object.values(j).reduce((e,s)=>e+(parseInt(s)||0),0),w=(e,s)=>{y({...j,[e]:s})},{verify:_,isWriting:k,isConfirmed:I,writeError:E}=(0,a.yl)();return(0,i.useEffect)(()=>{I&&!E&&(g.Am.success("提交成功",{duration:2e3}),setTimeout(()=>{o.push("/verify")},2e3))},[I,E]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"w-full max-w-2xl",children:(0,t.jsxs)("ul",{className:"space-y-4",children:[f&&(0,t.jsx)(m.Z,{}),d&&d.length>0?d.map((e,s)=>(0,t.jsxs)("li",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[(0,t.jsxs)("div",{className:"text-left",children:[(0,t.jsx)("div",{className:"font-mono",children:(0,t.jsx)(v.Z,{address:e})}),(0,t.jsx)("div",{className:"text-sm text-gray-800",children:x[s]})]}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"number",min:"0",max:"100",value:j[e]||"",onChange:s=>w(e,s.target.value),className:"w-13 px-1 py-1 border rounded",disabled:k||I}),"%"]})]},e)):(0,t.jsx)("div",{className:"text-center text-gray-500",children:"没有人参与活动"}),d&&(0,t.jsxs)("li",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[(0,t.jsx)("div",{className:"text-left",children:(0,t.jsx)("div",{className:"text-sm text-gray-800",children:(0,t.jsx)("span",{children:"弃权票数："})})}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{type:"number",min:"0",max:"100",value:N,className:"w-13 px-1 py-1 border rounded",disabled:!0}),"%"]})]})]})}),l>0&&(0,t.jsx)(b.z,{onClick:()=>{let e=d.map(e=>BigInt(parseInt(j[e]||"0"))*l/100n),s=BigInt(N)*l/100n;_(null==c?void 0:c.address,r,s,e)},disabled:k||I,className:"mt-6 px-6 py-2 rounded ".concat(I?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"," text-white"),children:I?"已提交":"提交"}),!l&&(0,t.jsx)(b.z,{disabled:!0,className:"w-full bg-gray-400 cursor-not-allowed",children:"提交"}),E&&(0,t.jsx)("div",{className:"text-red-500 text-center",children:E.message})]})},j=()=>{let{id:e}=(0,n.useRouter)().query,s=BigInt(e||"0"),{currentRound:r}=(0,a.Bk)(),[o,d]=(0,i.useState)(BigInt(0));return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(l.Z,{title:"验证页面"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center p-4 border-t border-gray-200 bg-white mb-4",children:[(0,t.jsx)(f,{currentRound:r,actionId:s,onRemainingVotesChange:function(e){d(e)}}),(0,t.jsx)(p,{currentRound:r,actionId:s,remainingVotes:o})]}),(0,t.jsx)(c.Z,{actionId:s,round:BigInt(r||0),showSubmitter:!0})]})]})}}},function(e){e.O(0,[9215,8424,6789,2077,5551,7250,379,2888,9774,179],function(){return e(e.s=143)}),_N_E=e.O()}]);
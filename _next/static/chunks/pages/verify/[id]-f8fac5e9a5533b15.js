(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5394],{143:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify/[id]",function(){return t(37295)}])},20725:function(e,s,t){"use strict";var n=t(85893),l=t(67294),r=t(94782),a=t(93778),i=t(91529),c=t(27460),d=t(42083);s.Z=e=>{var s;let{actionId:t,round:o,showSubmitter:x}=e,{token:m}=(0,l.useContext)(a.M)||{},{actionInfo:u,isPending:h,error:j}=(0,r.dI)(null==m?void 0:m.address,t),{actionSubmits:f,isPending:b,error:v}=(0,r.WZ)(null==m?void 0:m.address,x?o:0n),N=(null==f?void 0:null===(s=f.find(e=>e.actionId==Number(t)))||void 0===s?void 0:s.submitter)||"N/A";return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2 border-t border-greyscale-100",children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==u?void 0:u.head.id.toString()]}),(0,n.jsx)("span",{className:"text-xl font-bold text-black",children:null==u?void 0:u.body.action})]}),(0,n.jsx)("div",{className:"mt-1",children:(0,n.jsx)("span",{className:"text-greyscale-600",children:null==u?void 0:u.body.consensus})}),(0,n.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,n.jsx)(c.Z,{address:null==u?void 0:u.head.author})]}),x&&(0,n.jsxs)("div",{className:"flex items-center",children:["推举人 ",(0,n.jsx)(c.Z,{address:N})]})]})]}),(0,n.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"参与资产上限"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(0,i.LH)((null==u?void 0:u.body.maxStake)||BigInt(0))})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"随机奖励地址数"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.maxRandomAccounts.toString())||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationRule)||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"验证信息填写指引"}),(0,n.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationInfoGuide)||"-"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,n.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==u?void 0:u.body.whiteList.length)?u.body.whiteList.map((e,s)=>(0,n.jsx)("span",{className:"flex items-center mr-2",children:(0,n.jsx)(c.Z,{address:e})},s)):"无限制"})]})]}),(h||x&&b)&&(0,n.jsx)(d.Z,{}),(j||x&&v)&&(0,n.jsx)("div",{className:"text-center text-sm text-red-500",children:(null==j?void 0:j.message)||(null==v?void 0:v.message)})]})]})}},27460:function(e,s,t){"use strict";var n=t(85893),l=t(86501),r=t(74855),a=t(18289),i=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0,showAddress:c=!0,colorClassName:d=""}=e;return(0,n.jsxs)("span",{className:"flex items-center space-x-2",children:[c&&(0,n.jsx)("span",{className:"text-xs ".concat(null!=d?d:"text-greyscale-500"),children:(0,i.Vu)(s)}),t&&(0,n.jsx)(r.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?l.ZP.success("复制成功"):l.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,n.jsx)(a.Z,{className:"h-4 w-4 ".concat(null!=d?d:"text-greyscale-500")})})})]})}},91529:function(e,s,t){"use strict";t.d(s,{LH:function(){return a},Vu:function(){return r},bM:function(){return c},vz:function(){return i}});var n=t(21803),l=t(15229);let r=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",a=e=>{let s=c(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(s))},i=e=>{let s=parseInt("18",10);return(0,n.v)(e,s)},c=e=>{let s=parseInt("18",10);return(0,l.b)(e,s)}},37295:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return p}});var n=t(85893),l=t(11163),r=t(67294),a=t(87250),i=t(58732),c=t(20725),d=t(92321),o=t(7080),x=t(93778),m=t(91529),u=t(42083),h=e=>{let{currentRound:s,actionId:t,onRemainingVotesChange:l}=e,{token:i}=(0,r.useContext)(x.M)||{},{address:c}=(0,d.m)(),{votesNumByAccountByActionId:h,isPending:j,error:f}=(0,o.Ol)(null==i?void 0:i.address,s,c||"",t),{scoreByVerifierByActionId:b,isPending:v,error:N}=(0,a.Tl)(null==i?void 0:i.address,s,c||"",t),g=j||v?BigInt(0):h-b;return(0,r.useEffect)(()=>{j||v||null==l||l(g)},[g]),(0,n.jsx)("div",{className:"mb-4 text-center",children:(0,n.jsxs)("span",{className:"font-semibold",children:["我的剩余验证票数：",j||v?(0,n.jsx)(u.Z,{}):(0,n.jsx)("span",{className:"text-secondary",children:(0,m.LH)(g)})]})})},j=t(86501),f=t(27245),b=t(78543),v=t(45551),N=t(27460),g=e=>{let{currentRound:s,actionId:t,remainingVotes:i}=e,{token:c}=(0,r.useContext)(x.M)||{},{chain:o}=(0,d.m)(),m=(0,l.useRouter)(),{accounts:h,infos:g,isPending:p,error:y}=(0,v.X5)(null==c?void 0:c.address,s,t);(0,r.useEffect)(()=>{if(h&&h.length>0){let e=Math.floor(100/h.length).toString(),s={};h.forEach(t=>{s[t]=e}),I(s)}},[h]);let[w,I]=(0,r.useState)({}),Z=100-Object.values(w).reduce((e,s)=>e+(parseInt(s)||0),0),C=(e,s)=>{I({...w,[e]:s})},{verify:_,isWriting:E,isConfirmed:P,writeError:S}=(0,a.yl)(),k=()=>!!(0,b.S)(o);return(0,r.useEffect)(()=>{P&&!S&&(j.Am.success("提交成功",{duration:2e3}),setTimeout(()=>{m.push("/verify?symbol=".concat(null==c?void 0:c.symbol))},2e3))},[P,S]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"w-full max-w-2xl",children:(0,n.jsxs)("ul",{className:"space-y-4",children:[p&&(0,n.jsx)(u.Z,{}),h&&h.length>0?h.map((e,s)=>(0,n.jsxs)("li",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsx)("div",{className:"font-mono",children:(0,n.jsx)(N.Z,{address:e})}),(0,n.jsx)("div",{className:"text-sm text-greyscale-800",children:g[s]})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"number",min:"0",max:"100",value:w[e]||"",onChange:s=>C(e,s.target.value),className:"w-13 px-1 py-1 border rounded",disabled:E||P}),"%"]})]},e)):(0,n.jsx)("div",{className:"text-center text-greyscale-500",children:"没有人参与活动"}),h&&(0,n.jsxs)("li",{className:"flex justify-between items-center p-4 border-b border-gray-100",children:[(0,n.jsx)("div",{className:"text-left",children:(0,n.jsx)("div",{className:"text-sm text-greyscale-800",children:(0,n.jsx)("span",{children:"弃权票数："})})}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"number",min:"0",max:"100",value:Z,className:"w-13 px-1 py-1 border rounded",disabled:!0}),"%"]})]})]})}),i>0&&(0,n.jsx)(f.z,{onClick:()=>{if(!k())return;let e=h.map(e=>BigInt(parseInt(w[e]||"0"))*i/100n),s=BigInt(Z)*i/100n;_(null==c?void 0:c.address,t,s,e)},disabled:E||P,className:"mt-6 w-1/2",children:P?"已提交":"提交验证"}),!i&&(0,n.jsx)(f.z,{disabled:!0,className:"mt-6 w-1/2",children:"已验证"}),S&&(0,n.jsx)("div",{className:"text-red-500 text-center",children:S.message})]})},p=()=>{let{id:e}=(0,l.useRouter)().query,s=BigInt(e||"0"),{currentRound:t}=(0,a.Bk)(),[d,o]=(0,r.useState)(BigInt(0));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{title:"验证页面"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center p-4 border-t border-gray-200 mb-4",children:[(0,n.jsx)(h,{currentRound:t,actionId:s,onRemainingVotesChange:function(e){o(e)}}),(0,n.jsx)(g,{currentRound:t,actionId:s,remainingVotes:d})]}),(0,n.jsx)(c.Z,{actionId:s,round:BigInt(t||0),showSubmitter:!0})]})]})}},78543:function(e,s,t){"use strict";t.d(s,{S:function(){return l}});var n=t(86501);let l=e=>!!e||(n.Am.error("请先将钱包链接 ".concat("sepolia")),!1)}},function(e){e.O(0,[530,1502,7295,7250,2888,9774,179],function(){return e(e.s=143)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9178],{94515:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/my/actrewards",function(){return t(72510)}])},27245:function(e,r,t){"use strict";t.d(r,{z:function(){return d}});var s=t(85893),n=t(67294),i=t(88426),a=t(45139),l=t(98997);let c=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,r)=>{let{className:t,variant:n,size:a,asChild:d=!1,...o}=e,u=d?i.g7:"button";return(0,s.jsx)(u,{className:(0,l.cn)(c({variant:n,size:a,className:t})),ref:r,...o})});d.displayName="Button"},98997:function(e,r,t){"use strict";t.d(r,{cn:function(){return i}});var s=t(90512),n=t(98388);function i(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return(0,n.m6)((0,s.W)(r))}},91529:function(e,r,t){"use strict";t.d(r,{LH:function(){return a},Vu:function(){return i},bM:function(){return c},vz:function(){return l}});var s=t(21803),n=t(15229);let i=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",a=e=>{let r=c(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(r))},l=e=>{let r=parseInt("18",10);return(0,s.v)(e,r)},c=e=>{let r=parseInt("18",10);return(0,n.b)(e,r)}},72510:function(e,r,t){"use strict";t.r(r),t.d(r,{default:function(){return N}});var s=t(85893),n=t(67294),i=t(11163),a=t(35337),l=t(87250),c=t(20725),d=t(91318),o=t(92321),u=t(86501),x=t(27245),m=t(5028),f=t(93778),h=t(91529),g=e=>{let{actionId:r,currentRound:t}=e,{address:i}=(0,o.m)(),{token:a}=(0,n.useContext)(f.M)||{},{stakedAmountByAccountByActionId:l,isPending:c,error:g}=(0,m.um)((null==a?void 0:a.address)||"",i||"",r),{lastJoinedRound:b,isPending:j,error:v}=(0,m.NP)((null==a?void 0:a.address)||"",i||"",r),{withdraw:p,isPending:N,isConfirming:y,isConfirmed:w,error:I}=(0,m.Qc)(),k=async()=>{await p((null==a?void 0:a.address)||"",r)};return((0,n.useEffect)(()=>{w&&(u.Am.success("取回成功"),setTimeout(()=>{window.location.reload()},2e3))},[w]),c||j)?(0,s.jsx)(d.Z,{}):g||v?(console.error(g,v),(0,s.jsx)("div",{className:"text-red-500",children:"加载失败"})):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-6 pb-8 bg-white mb-4",children:[(0,s.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"我参与的代币数"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:(0,h.LH)(l||BigInt(0))})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("span",{className:"text-sm text-gray-500",children:"参加到第几轮"}),(0,s.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:null==b?void 0:b.toString()})]})]}),l<=0?(0,s.jsx)(x.z,{className:"w-full bg-gray-400 cursor-not-allowed",children:"已取回"}):b&&Number(b)+1<Number(t)?(0,s.jsx)(x.z,{className:"btn-primary btn w-1/2",onClick:k,disabled:N||y,children:N||y?(0,s.jsx)(d.Z,{}):"取回代币"}):(0,s.jsxs)("span",{className:"text-sm text-gray-500",children:["提示：到第 ",(1+Number(b)).toString()," 轮后可取回"]})]}),g&&(0,s.jsx)("div",{className:"text-red-500",children:g.message}),v&&(0,s.jsx)("div",{className:"text-red-500",children:v.message}),I&&(0,s.jsx)("div",{className:"text-red-500",children:I.message})]})},b=t(45551),j=t(7399),v=t(27460),p=e=>{let{round:r,actionId:t}=e,{token:i}=(0,n.useContext)(f.M)||{},{address:a}=(0,o.m)(),{verifiedAddresses:l,isPending:c,error:u}=(0,b.pK)(null==i?void 0:i.address,r,t),[x,m]=(0,n.useState)([]);(0,n.useEffect)(()=>{l&&m(l)},[l]);let{mintActionReward:g,isWriting:p,isConfirming:N,isConfirmed:y,writeError:w}=(0,j.Rb)(),I=async e=>{a&&e.reward>0&&(await g(null==i?void 0:i.address,r,t),y&&m(r=>r.map(r=>r.account===e.account?{...r,reward:0n}:r)))};return c?(0,s.jsx)(d.Z,{}):u?(0,s.jsxs)("div",{children:["发生错误: ",u.message]}):(0,s.jsxs)("div",{className:"relative pt-4 pl-4 bg-base-100 mb-4",children:[(0,s.jsx)("h2",{className:"relative pl-4 text-gray-700 text-base font-medium before:content-[''] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-red-500",children:"验证地址结果"}),0===x.length?(0,s.jsx)("div",{className:"text-center text-sm text-gray-500",children:"没有验证地址"}):(0,s.jsxs)("table",{className:"table w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,s.jsx)("th",{children:"地址"}),(0,s.jsx)("th",{children:"得分"}),(0,s.jsx)("th",{children:"奖励"}),(0,s.jsx)("th",{})]})}),(0,s.jsx)("tbody",{children:x.map(e=>(0,s.jsxs)("tr",{className:"border-b border-gray-100",children:[(0,s.jsx)("td",{children:(0,s.jsx)(v.Z,{address:e.account,showCopyButton:!1})}),(0,s.jsx)("td",{children:(0,h.LH)(e.score)}),(0,s.jsx)("td",{children:(0,h.LH)(e.reward)}),(0,s.jsx)("td",{children:e.account===a?e.reward>0?(0,s.jsx)("button",{className:"btn btn-primary btn-sm",onClick:()=>I(e),disabled:p||N,children:"领取"}):e.score>0?(0,s.jsx)("span",{className:"text-gray-500",children:"已领取"}):"":""})]},e.account))})]}),w&&(0,s.jsx)("div",{className:"text-red-500",children:w.message}),(p||N)&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-gray-500 bg-opacity-50 flex items-center justify-center z-20",children:(0,s.jsxs)("div",{className:"text-white text-lg flex items-center",children:[(0,s.jsxs)("svg",{className:"animate-spin mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]}),"正在提交中..."]})})]})},N=()=>{let{id:e}=(0,i.useRouter)().query,{currentRound:r,isPending:t,error:o}=(0,l.Bk)(),[u,m]=(0,n.useState)(!1),[f,h]=(0,n.useState)(null),b=()=>m(!u),j=e=>{h(e),m(!1)};return(0,n.useEffect)(()=>{h(r>0?Number(r)-1:null)},[r]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Z,{title:"行动详情"}),(0,s.jsxs)("main",{className:"flex-grow",children:[(0,s.jsx)("div",{className:"flex flex-col items-center space-y-6 p-4 bg-white border-t border-gray-100",children:(0,s.jsx)("h1",{className:"text-base text-center",children:t?(0,s.jsx)(d.Z,{}):r>0?(0,s.jsxs)(s.Fragment,{children:["已完成 (第",(0,s.jsx)("span",{className:"text-red-500",children:Number(f)}),"轮)",(0,s.jsx)(x.z,{onClick:b,className:"ml-4 px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600",children:"切换轮次"})]}):"没有完成的轮次"})}),(0,s.jsx)(g,{actionId:BigInt(e||0),currentRound:r}),(0,s.jsx)(p,{round:null!==f?BigInt(f):0n,actionId:BigInt(e||0)}),t?(0,s.jsx)(d.Z,{}):(0,s.jsx)(c.Z,{actionId:BigInt(e||0),round:null!==f?BigInt(f):0n,showSubmitter:r>0}),u&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"bg-white rounded-lg p-6 w-72",children:[(0,s.jsx)("h2",{className:"text-lg font-bold text-center mb-4",children:"选择轮次"}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto",children:Array.from({length:Number(r)},(e,t)=>{let n=Number(r)-1-t;return(0,s.jsxs)("div",{className:"p-2 text-center cursor-pointer hover:bg-gray-100",onClick:()=>j(n),children:["第 ",n," 轮"]},n)})}),(0,s.jsx)("button",{onClick:b,className:"mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded-md w-full hover:bg-gray-400",children:"取消"})]})})]})]})}},21803:function(e,r,t){"use strict";function s(e,r){let[t,s="0"]=e.split("."),n=t.startsWith("-");if(n&&(t=t.slice(1)),s=s.replace(/(0+)$/,""),0===r)1===Math.round(Number(`.${s}`))&&(t=`${BigInt(t)+1n}`),s="";else if(s.length>r){let[e,n,i]=[s.slice(0,r-1),s.slice(r-1,r),s.slice(r)],a=Math.round(Number(`${n}.${i}`));(s=a>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${a}`).length>r&&(s=s.slice(1),t=`${BigInt(t)+1n}`),s=s.slice(0,r)}else s=s.padEnd(r,"0");return BigInt(`${n?"-":""}${t}${s}`)}t.d(r,{v:function(){return s}})},89810:function(e,r,t){"use strict";t.d(r,{u:function(){return c}});var s=t(37003),n=t(36100),i=t(82451),a=t(82002),l=t(37122);function c(e={}){let{abi:r,address:t,functionName:c,query:d={}}=e,o=e.code,u=(0,l.Z)(e),x=(0,a.x)({config:u}),m=function(e,r={}){return{async queryFn({queryKey:t}){let n=r.abi;if(!n)throw Error("abi is required");let{functionName:i,scopeKey:a,...l}=t[1],c=(()=>{let e=t[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!i)throw Error("functionName is required");return(0,s.L)(e,{abi:n,functionName:i,args:l.args,...c,...l})},queryKey:function(e={}){let{abi:r,...t}=e;return["readContract",(0,n.OP)(t)]}(r)}}(u,{...e,chainId:e.chainId??x}),f=!!((t||o)&&r&&c&&(d.enabled??!0));return(0,i.aM)({...d,...m,enabled:f,structuralSharing:d.structuralSharing??n.if})}}},function(e){e.O(0,[9215,8424,6789,3601,5551,7250,7399,379,2888,9774,179],function(){return e(e.s=94515)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{85719:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return n(48585)}])},34680:function(e,t,n){"use strict";n.d(t,{Ol:function(){return c},SZ:function(){return o},Zb:function(){return i},aY:function(){return d},eW:function(){return u},ll:function(){return l}});var r=n(85893),s=n(67294),a=n(40108);let i=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...s})});i.displayName="Card";let c=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",n),...s})});c.displayName="CardHeader";let l=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",n),...s})});l.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",n),...s})});o.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",n),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",n),...s})});u.displayName="CardFooter"},64777:function(e,t,n){"use strict";var r=n(85893);t.Z=e=>{let{title:t}=e;return(0,r.jsx)("div",{className:"flex justify-between items-center",children:(0,r.jsx)("h1",{className:"text-lg font-bold",children:t})})}},18308:function(e,t,n){"use strict";var r=n(85893),s=n(67294),a=n(92321),i=n(27245),c=n(41664),l=n.n(c),o=n(91529),d=n(93778),u=n(7080),f=n(87250),m=n(42083),x=n(64777);t.Z=e=>{let{currentRound:t,showBtn:n=!0}=e,{token:c}=(0,s.useContext)(d.M)||{},{address:h}=(0,a.m)(),{votesNumByAccount:p,isPending:v,error:w}=(0,u.VI)(null==c?void 0:c.address,t,h||""),{scoreByVerifier:j,isPending:y,error:N}=(0,f.w3)(null==c?void 0:c.address,t,h||""),g=v||y?BigInt(0):p-j;return c?(0,r.jsxs)("div",{className:"flex-col items-center px-6 pt-6 pb-2",children:[(0,r.jsx)(x.Z,{title:"我的验证"}),(0,r.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"已验证票数"}),(0,r.jsx)("div",{className:"stat-value text-xl",children:v?(0,r.jsx)(m.Z,{}):(0,o.LH)(j||BigInt(0))})]}),(0,r.jsxs)("div",{className:"stat place-items-center",children:[(0,r.jsx)("div",{className:"stat-title text-sm",children:"未验证票数"}),(0,r.jsx)("div",{className:"stat-value text-xl",children:v||y?(0,r.jsx)(m.Z,{}):(0,o.LH)(g)})]})]}),n&&(0,r.jsx)("div",{className:"flex justify-center",children:v||y?(0,r.jsx)(m.Z,{}):p>j?(0,r.jsx)(i.z,{className:"w-1/2",children:(0,r.jsx)(l(),{href:"/verify?symbol=".concat(c.symbol),children:"去验证"})}):(0,r.jsx)(i.z,{disabled:!0,className:"w-1/2",children:j>0?"已验证":"未投票，无需验证"})})]}):""}},91529:function(e,t,n){"use strict";n.d(t,{LH:function(){return i},Vu:function(){return a},bM:function(){return l},vz:function(){return c}});var r=n(21803),s=n(15229);let a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",i=e=>{let t=l(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(t))},c=e=>{let t=parseInt("18",10);return(0,r.v)(e,t)},l=e=>{let t=parseInt("18",10);return(0,s.b)(e,t)}},48585:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(85893),s=n(58732),a=n(87250),i=n(18308),c=n(67294),l=n(41664),o=n.n(l),d=n(34680),u=n(93778),f=n(7080),m=n(94782),x=n(64777),h=n(42083),p=e=>{let{currentRound:t}=e,{token:n}=(0,c.useContext)(u.M)||{},{actionIds:s,votes:a,isPending:i,error:l}=(0,f.$S)((null==n?void 0:n.address)||"",t),{actionInfos:p,isPending:v,error:w}=(0,m.fT)((null==n?void 0:n.address)||"",s||[]);return i||s&&s.length>0&&v?(0,r.jsx)("div",{className:"p-6 flex justify-center items-center",children:(0,r.jsx)(h.Z,{})}):l||w?(console.log("errorVotesNums",l),console.log("errorActionInfosByIds",w),(0,r.jsx)("div",{children:"加载出错，请稍后再试。"})):n?(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)(x.Z,{title:"待验证行动"}),(0,r.jsx)("div",{className:"mt-4 space-y-4",children:null==p?void 0:p.map((e,t)=>(0,r.jsx)(d.Zb,{className:"shadow-none",children:(0,r.jsxs)(o(),{href:"/verify/".concat(e.head.id,"?symbol=").concat(null==n?void 0:n.symbol),children:[(0,r.jsxs)(d.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,r.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,r.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,r.jsx)(d.aY,{className:"px-3 pt-1 pb-2",children:(0,r.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus})})]})},e.head.id))})]}):(0,r.jsx)(h.Z,{})},v=()=>{let{currentRound:e}=(0,a.Bk)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{title:"社区首页"}),(0,r.jsxs)("main",{className:"flex-grow",children:[(0,r.jsx)(i.Z,{currentRound:e,showBtn:!1}),(0,r.jsx)(p,{currentRound:e})]})]})}},9008:function(e,t,n){e.exports=n(23867)},96128:function(e,t,n){"use strict";n.d(t,{T:function(){return p}});var r=n(14503),s=n(8998),a=n(33840),i=n(26445),c=n(33639),l=n(87469),o=n(61163),d=n(74688),u=n(93714),f=n(47531),m=n(79524),x=n(76404),h=n(99238);async function p(e,t){let{account:n=e.account,chain:p=e.chain,accessList:v,blobs:w,data:j,gas:y,gasPrice:N,maxFeePerBlobGas:g,maxFeePerGas:b,maxPriorityFeePerGas:C,nonce:I,to:R,value:Z,...P}=t;if(!n)throw new s.o({docsPath:"/docs/actions/wallet/sendTransaction"});let T=(0,r.T)(n);try{let n;if((0,f.F)(t),null!==p&&(n=await (0,u.s)(e,m.L,"getChainId")({}),(0,a.q)({currentChainId:n,chain:p})),"local"===T.type){let t=await (0,u.s)(e,x.Z,"prepareTransactionRequest")({account:T,accessList:v,blobs:w,chain:p,chainId:n,data:j,gas:y,gasPrice:N,maxFeePerBlobGas:g,maxFeePerGas:b,maxPriorityFeePerGas:C,nonce:I,parameters:[...x.Q,"sidecars"],to:R,value:Z,...P}),r=p?.serializers?.transaction,s=await T.signTransaction(t,{serializer:r});return await (0,u.s)(e,h.p,"sendRawTransaction")({serializedTransaction:s})}let r=e.chain?.formatters?.transactionRequest?.format,s=(r||d.tG)({...(0,o.K)(P,{format:r}),accessList:v,blobs:w,chainId:n,data:j,from:T.address,gas:y,gasPrice:N,maxFeePerBlobGas:g,maxFeePerGas:b,maxPriorityFeePerGas:C,nonce:I,to:R,value:Z});return await e.request({method:"eth_sendTransaction",params:[s]},{retryCount:0})}catch(e){throw function(e,{docsPath:t,...n}){let r=(()=>{let t=(0,l.k)(e,n);return t instanceof i.cj?e:t})();return new c.mk(r,{docsPath:t,...n})}(e,{...t,account:T,chain:t.chain||void 0})}}},61877:function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var r=n(55629),s=n(93714),a=n(96128);async function i(e,t){let{abi:n,address:i,args:c,dataSuffix:l,functionName:o,...d}=t,u=(0,r.R)({abi:n,args:c,functionName:o});return(0,s.s)(e,a.T,"sendTransaction")({data:`${u}${l?l.replace("0x",""):""}`,to:i,...d})}},33840:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(80377);function s({chain:e,currentChainId:t}){if(!e)throw new r.Bk;if(t!==e.id)throw new r.Yl({chain:e,currentChainId:t})}},21803:function(e,t,n){"use strict";function r(e,t){let[n,r="0"]=e.split("."),s=n.startsWith("-");if(s&&(n=n.slice(1)),r=r.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${r}`))&&(n=`${BigInt(n)+1n}`),r="";else if(r.length>t){let[e,s,a]=[r.slice(0,t-1),r.slice(t-1,t),r.slice(t)],i=Math.round(Number(`${s}.${a}`));(r=i>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${i}`).length>t&&(r=r.slice(1),n=`${BigInt(n)+1n}`),r=r.slice(0,t)}else r=r.padEnd(t,"0");return BigInt(`${s?"-":""}${n}${r}`)}n.d(t,{v:function(){return r}})},83540:function(e,t,n){"use strict";n.d(t,{A:function(){return m}});var r=n(95946),s=n(51973),a=n(23147),i=n(36083),c=n(81946);async function l(e,t){let{chainId:n,timeout:l=0,...o}=t,d=e.getClient({chainId:n}),u=(0,c.s)(d,s.e,"waitForTransactionReceipt"),f=await u({...o,timeout:l});if("reverted"===f.status){let e=(0,c.s)(d,a.f,"getTransaction"),t=await e({hash:f.transactionHash}),n=(0,c.s)(d,i.R,"call"),s=await n({...t,data:t.input,gasPrice:"eip1559"!==t.type?t.gasPrice:void 0,maxFeePerGas:"eip1559"===t.type?t.maxFeePerGas:void 0,maxPriorityFeePerGas:"eip1559"===t.type?t.maxPriorityFeePerGas:void 0});throw Error(s?.data?(0,r.rR)(`0x${s.data.substring(138)}`):"unknown reason")}return{...f,chainId:d.chain.id}}var o=n(36100),d=n(82451),u=n(82002),f=n(37122);function m(e={}){let{hash:t,query:n={}}=e,r=(0,f.Z)(e),s=(0,u.x)({config:r}),a=function(e,t={}){return{async queryFn({queryKey:n}){let{hash:r,...s}=n[1];if(!r)throw Error("hash is required");return l(e,{...s,onReplaced:t.onReplaced,hash:r})},queryKey:function(e={}){let{onReplaced:t,...n}=e;return["waitForTransactionReceipt",(0,o.OP)(n)]}(t)}}(r,{...e,chainId:e.chainId??s}),i=!!(t&&(n.enabled??!0));return(0,d.aM)({...n,...a,enabled:i})}},75593:function(e,t,n){"use strict";n.d(t,{S:function(){return f}});var r=n(98029),s=n(61877),a=n(81946),i=n(52425),c=n(75230),l=n(66432);async function o(e,t){let n;let{abi:r,chainId:s,connector:i,...o}=t;n=t.account?t.account:(await (0,c.e)(e,{chainId:s,connector:i})).account;let d=e.getClient({chainId:s}),u=(0,a.s)(d,l.a,"simulateContract"),{result:f,request:m}=await u({...o,abi:r,account:n});return{chainId:d.chain.id,result:f,request:{__mode:"prepared",...m,chainId:s}}}async function d(e,t){let n,r;let{account:l,chainId:d,connector:u,__mode:f,...m}=t;n="object"==typeof l&&l?.type==="local"?e.getClient({chainId:d}):await (0,c.e)(e,{account:l??void 0,chainId:d,connector:u});let{connector:x}=(0,i.D)(e);if("prepared"===f||x?.supportsSimulation)r=m;else{let{request:t}=await o(e,{...m,account:l,chainId:d});r=t}let h=(0,a.s)(n,s.n,"writeContract");return await h({...r,...l?{account:l}:{},chain:d?{id:d}:null})}var u=n(37122);function f(e={}){var t;let{mutation:n}=e,s=(t=(0,u.Z)(e),{mutationFn:e=>d(t,e),mutationKey:["writeContract"]}),{mutate:a,mutateAsync:i,...c}=(0,r.D)({...n,...s});return{...c,writeContract:a,writeContractAsync:i}}}},function(e){e.O(0,[1664,1502,7295,7250,2888,9774,179],function(){return e(e.s=85719)}),_N_E=e.O()}]);
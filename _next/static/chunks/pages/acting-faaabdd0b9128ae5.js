(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return t(75959)}])},34680:function(e,s,t){"use strict";t.d(s,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return r},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var n=t(85893),a=t(67294),l=t(40108);let r=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});r.displayName="Card";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",t),...a})});c.displayName="CardHeader";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});i.displayName="CardTitle";let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",t),...a})});d.displayName="CardDescription";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",t),...a})});o.displayName="CardContent";let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,n.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},4307:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});let n=(0,t(31134).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},96693:function(e,s,t){"use strict";t.d(s,{Z:function(){return d}});var n=t(85893),a=t(67294),l=t(42757),r=t(93778),c=e=>{let{initialTimeLeft:s,onTick:t}=e,[l,r]=(0,a.useState)(Date.now()+1e3*s),[c,i]=(0,a.useState)(s);(0,a.useEffect)(()=>{r(Date.now()+1e3*s)},[s]),(0,a.useEffect)(()=>{let e=setInterval(()=>{let s=Math.max(0,Math.floor((l-Date.now())/1e3));i(s),t&&t(s),s<=0&&(clearInterval(e),window.location.reload())},1e3);return()=>clearInterval(e)},[l,t]);let d=Math.floor(c/86400),o=Math.floor(c%86400/3600);return(0,n.jsxs)("div",{className:"inline-flex gap-1 text-secondary",children:[d>0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":d}})}),"天"]}),(o>0||d>0)&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":o}})}),"时"]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":Math.floor(c%3600/60)}})}),"分"]}),d<=0&&(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"countdown font-mono",children:(0,n.jsx)("span",{style:{"--value":c%60}})}),"秒"]})]})},i=t(42083),d=e=>{let{currentRound:s,roundType:t}=e,{data:d}=(0,l.O)(),o=(0,a.useContext)(r.M),u=o?o.token:void 0,x=!d||!u||void 0===u.voteOriginBlocks||!u.initialStakeRound,[m,f]=(0,a.useState)(0n),h=Number("100")||0,j=Number("3")||0,N=u?Number(u.voteOriginBlocks):0,p=h-(Number(d)-N)%h,v=p>0?p*j:0,[y,b]=(0,a.useState)(v);(0,a.useEffect)(()=>{if(!d)return;let e=h-(Number(d)-N)%h;b(e>0?e*j:0)},[d,h,j,N]),(0,a.useEffect)(()=>{u&&s>0n&&f(s-BigInt(u.initialStakeRound)+1n)},[s,u]);let g=null!=m?m.toString():"0";return x?(0,n.jsx)(i.Z,{}):(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsxs)("h1",{className:"text-lg font-bold",children:["第 ",(0,n.jsx)("span",{className:"text-secondary",children:g})," 轮","vote"===t?"投票":"行动","阶段"]}),(0,n.jsxs)("span",{className:"text-sm mt-1 pt-0",children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"剩余:"}),(0,n.jsx)("span",{className:"text-secondary mr-1",children:Math.ceil(y/j)}),(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"块, 约"}),(0,n.jsx)(c,{initialTimeLeft:v,onTick:b})]})]})}},75959:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var n=t(85893),a=t(67294),l=t(11163),r=t(93778),c=t(67068),i=t(19638),d=t(7399),o=t(91529),u=t(42083),x=t(96693),m=e=>{let{currentRound:s}=e,{token:t}=(0,a.useContext)(r.M)||{},{rewardAvailable:l,isPending:m,error:f}=(0,d.CY)((null==t?void 0:t.address)||""),{balance:h,isPending:j,error:N}=(0,i.hS)((null==t?void 0:t.address)||"","0x738536dA6B704fD66742d5CF9025A5F50b69291e"),{handleContractError:p}=(0,c.S)();return(0,a.useEffect)(()=>{N&&p(N,"join"),f&&p(f,"mint")},[N,f]),(0,n.jsxs)("div",{className:"px-4",children:[(0,n.jsx)(x.Z,{currentRound:s||0n,roundType:"act"}),(0,n.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title",children:"预计新增铸币"}),(0,n.jsx)("div",{className:"stat-value text-2xl",children:m||void 0===l?(0,n.jsx)(u.Z,{}):(0,o.LH)(99n*l/10000n,0)})]}),(0,n.jsxs)("div",{className:"stat place-items-center",children:[(0,n.jsx)("div",{className:"stat-title",children:"参与行动代币"}),(0,n.jsx)("div",{className:"stat-value text-2xl",children:j?(0,n.jsx)(u.Z,{}):(0,o.LH)(h||BigInt(0),0)})]})]})]})},f=t(37436),h=t(41664),j=t.n(h),N=t(92321),p=t(4307),v=t(34680),y=t(45551),b=t(64777),g=e=>{let{currentRound:s}=e,{token:t}=(0,a.useContext)(r.M)||{},{address:l}=(0,N.m)(),{joinableActionDetails:i,joinedActions:d,isPending:x,error:m}=(0,y.eN)((null==t?void 0:t.address)||"",s||0n,l);null==i||i.sort((e,s)=>Number(e.action.head.id)-Number(s.action.head.id));let f=(null==i?void 0:i.reduce((e,s)=>e+s.votesNum,0n))||0n,{handleContractError:h}=(0,c.S)();return(0,a.useEffect)(()=>{m&&h(m,"dataViewer")},[m]),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)(b.Z,{title:"进行中的行动"}),!l&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"请先连接钱包"}),l&&x&&(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(u.Z,{})}),!x&&!(null==i?void 0:i.length)&&(0,n.jsx)("div",{className:"text-sm mt-4 text-greyscale-500 text-center",children:"本轮暂无行动"}),!x&&i&&i.length>0&&(0,n.jsx)("div",{className:"mt-4 space-y-4",children:i.map((e,s)=>{let a=(null==d?void 0:d.some(s=>s.actionId===BigInt(e.action.head.id)))?"/action/".concat(e.action.head.id,"?type=join&symbol=").concat(null==t?void 0:t.symbol):"/acting/join?id=".concat(e.action.head.id,"&symbol=").concat(null==t?void 0:t.symbol);return(0,n.jsx)(v.Zb,{className:"shadow-none",children:(0,n.jsxs)(j(),{href:a,className:"relative block",children:[(0,n.jsxs)(v.Ol,{className:"px-3 pt-2 pb-1 flex-row items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.action.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.action.body.action)})]}),(0,n.jsxs)(v.aY,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.action.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,n.jsxs)("span",{className:"text-secondary",children:[(100*Number(i[s].votesNum||0n)/Number(f)).toFixed(1),"%"]})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"参与代币数"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,o.LH)(i[s].joinedAmount||0n)})]})]})]}),(0,n.jsx)(p.Z,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-greyscale-400 pointer-events-none"})]})},e.action.head.id)})})]})},w=t(4062),k=t(5028),C=()=>{let e=(0,l.useRouter)(),{currentRound:s,error:t}=(0,k.Bk)(),{token:i}=(0,a.useContext)(r.M)||{},{handleContractError:d}=(0,c.S)();return(0,a.useEffect)(()=>{t&&d(t,"join")},[t]),(0,a.useEffect)(()=>{i&&!i.hasEnded?e.push("/launch?symbol=".concat(i.symbol)):i&&!i.initialStakeRound&&e.push("/gov/stakelp/?symbol=".concat(i.symbol,"&first=true"))},[i]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{title:"社区首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(w.Z,{}),(0,n.jsx)(m,{currentRound:s}),(0,n.jsx)(g,{currentRound:s})]})]})}}},function(e){e.O(0,[1664,2209,1335,6242,1250,7380,9871,7399,4062,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);
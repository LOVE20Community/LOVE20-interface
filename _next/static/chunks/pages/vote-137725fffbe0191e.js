(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1786],{75125:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/vote",function(){return s(36968)}])},34680:function(e,t,s){"use strict";s.d(t,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var n=s(85893),r=s(67294),a=s(40108);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",s),...r})});l.displayName="Card";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",s),...r})});c.displayName="CardHeader";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",s),...r})});i.displayName="CardTitle";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",s),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",s),...r})});o.displayName="CardContent";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,n.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",s),...r})});u.displayName="CardFooter"},27460:function(e,t,s){"use strict";var n=s(85893),r=s(86501),a=s(74855),l=s(18289),c=s(91529);t.Z=e=>{let{address:t,showCopyButton:s=!0,showAddress:i=!0,colorClassName:d=""}=e;return(0,n.jsxs)("span",{className:"flex items-center space-x-2",children:[i&&(0,n.jsx)("span",{className:"text-xs ".concat(null!=d?d:"text-greyscale-500"),children:(0,c.Vu)(t)}),s&&(0,n.jsx)(a.CopyToClipboard,{text:t,onCopy:(e,t)=>{t?r.ZP.success("复制成功"):r.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,n.jsx)(l.Z,{className:"h-4 w-4 ".concat(null!=d?d:"text-greyscale-500")})})})]})}},64777:function(e,t,s){"use strict";var n=s(85893);t.Z=e=>{let{title:t}=e;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:t})})}},91529:function(e,t,s){"use strict";s.d(t,{LH:function(){return l},Vu:function(){return a},bM:function(){return i},vz:function(){return c}});var n=s(21803),r=s(15229);let a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=e=>{let t=i(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(t))},c=e=>{let t=parseInt("18",10);return(0,n.v)(e,t)},i=e=>{let t=parseInt("18",10);return(0,r.b)(e,t)}},36968:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var n=s(85893),r=s(7080),a=s(58732),l=s(67294),c=s(11163),i=s(86501),d=s(27245),o=s(34680),u=s(93778),m=s(94782),x=s(41664),f=s.n(x),h=s(42083),j=s(27460),p=s(64777),N=e=>{let{currentRound:t}=e,{token:s}=(0,l.useContext)(u.M)||{},a=(0,c.useRouter)(),{votes:x,isPending:N,error:v}=(0,r.$S)((null==s?void 0:s.address)||"",t),{actionSubmits:y,isPending:b,error:g}=(0,m.WZ)((null==s?void 0:s.address)||"",t),w=Array.from(new Set((null==y?void 0:y.map(e=>BigInt(e.actionId)))||[])).sort((e,t)=>Number(e)-Number(t)),{actionInfos:C,isPending:Z,error:_}=(0,m.fT)((null==s?void 0:s.address)||"",w),[k,I]=(0,l.useState)(new Set),P=e=>{I(t=>{console.log("prevSelected",t);let s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s})},R=(null==x?void 0:x.reduce((e,t)=>e+t,0n))||0n;return N||b||w&&w.length>0&&Z?(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(h.Z,{})}):g||_?(0,n.jsx)("div",{children:"加载出错，请稍后再试。"}):s?(1===w.length&&a.push("/vote/vote?ids=".concat(w[0],"&symbol=").concat(null==s?void 0:s.symbol)),1!==w.length&&(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(p.Z,{title:"投票中的行动"}),s&&(0,n.jsx)(d.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(f(),{href:"/vote/actions4submit?symbol=".concat(null==s?void 0:s.symbol),children:"推举其他行动"})})]}),(0,n.jsx)("div",{className:"space-y-4",children:w.length>0?(0,n.jsxs)(n.Fragment,{children:[null==C?void 0:C.map((e,t)=>{var r;let a=null==y?void 0:null===(r=y.find(t=>BigInt(t.actionId)===BigInt(e.head.id)))||void 0===r?void 0:r.submitter;return(0,n.jsxs)(o.Zb,{className:"shadow-none flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"checkbox accent-secondary ml-2",checked:k.has(BigInt(e.head.id)),onChange:()=>P(BigInt(e.head.id))}),(0,n.jsxs)(f(),{href:"/action/".concat(e.head.id,"?type=vote&symbol=").concat(null==s?void 0:s.symbol),className:"w-full",children:[(0,n.jsxs)(o.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,n.jsxs)(o.aY,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"推举人"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,n.jsx)(j.Z,{address:a,showCopyButton:!1})})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,n.jsxs)("span",{className:"text-secondary",children:[0===Number((null==x?void 0:x[t])||0n)?"0":(100*Number((null==x?void 0:x[t])||0n)/Number(R)).toFixed(1),"%"]})]})]})]})]},e.head.id)]},e.head.id)}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:(0,n.jsx)(d.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",onClick:()=>{let e=Array.from(k).join(",");if(0===e.length){i.Am.error("请选择行动");return}a.push("/vote/vote?ids=".concat(e,"&symbol=").concat(null==s?void 0:s.symbol))},children:"给选中的行动投票"})})]}):(0,n.jsx)("div",{className:"text-sm text-greyscale-500 text-center",children:"没有行动"})})]})):(0,n.jsx)(h.Z,{})},v=()=>{let{currentRound:e,isPending:t,error:s}=(0,r.Bk)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{title:"投票首页"}),(0,n.jsx)("main",{className:"flex-grow",children:(0,n.jsx)(N,{currentRound:e})})]})}}},function(e){e.O(0,[1664,530,1502,7295,2888,9774,179],function(){return e(e.s=75125)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6843],{63783:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[symbol]/vote",function(){return t(29250)}])},27460:function(e,s,t){"use strict";var n=t(85893),r=t(86501),l=t(74855),a=t(18289),c=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0,showAddress:i=!0}=e;return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&(0,n.jsx)("span",{className:"text-xs text-gray-500",children:(0,c.Vu)(s)}),t&&(0,n.jsx)(l.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?r.ZP.success("复制成功"):r.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,n.jsx)(a.Z,{className:"h-4 w-4 text-gray-500"})})})]})}},74089:function(e,s,t){"use strict";var n=t(85893),r=t(67294),l=t(91529);s.Z=e=>{let{initialTimeLeft:s}=e,[t,a]=(0,r.useState)(s);(0,r.useEffect)(()=>{if(s<=0)return;a(s);let e=setInterval(()=>{a(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let c=(0,l.ZC)(t);return(0,n.jsx)(n.Fragment,{children:c})}},91318:function(e,s,t){"use strict";var n=t(85893);s.Z=()=>(0,n.jsx)("span",{className:"flex justify-center items-center",children:(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,s,t){"use strict";var n=t(85893);t(67294);var r=t(3125),l=t(74089);s.Z=e=>{let{currentRound:s,roundName:t}=e,{data:a}=(0,r.O)(),c=Number("100")||0,i=Number("12")||0,o=a?c-Number(a)%c:0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h1",{className:"text-base text-center font-bold",children:[t,"（第 ",(0,n.jsx)("span",{className:"text-red-500",children:Number(null!=s?s:0n)})," 轮）"]}),(0,n.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,n.jsx)(l.Z,{initialTimeLeft:o>0?o*i:0})]})]})}},29250:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return b}});var n=t(85893),r=t(67294),l=t(27245),a=t(41664),c=t.n(a),i=t(7080),o=t(93778),d=t(35337),u=t(91318),x=t(7191),m=t(11163),h=t(86501),j=t(94782),f=t(27460),N=e=>{let{currentRound:s}=e,{token:t}=(0,r.useContext)(o.M)||{},a=(0,m.useRouter)(),{votes:d,isPending:x,error:N}=(0,i.$S)((null==t?void 0:t.address)||"",s),{actionSubmits:b,isPending:g,error:v}=(0,j.WZ)((null==t?void 0:t.address)||"",s),p=Array.from(new Set((null==b?void 0:b.map(e=>BigInt(e.actionId)))||[])).sort((e,s)=>Number(e)-Number(s)),{actionInfos:y,isPending:w,error:Z}=(0,j.fT)((null==t?void 0:t.address)||"",p),[k,C]=(0,r.useState)(new Set),_=e=>{C(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},I=(null==d?void 0:d.reduce((e,s)=>e+s,0n))||0n;return x||g||p&&p.length>0&&w?(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(u.Z,{})}):v||Z?(0,n.jsx)("div",{children:"加载出错，请稍后再试。"}):t?(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h2",{className:"text-sm font-bold mb-4 text-gray-600",children:"行动列表 (行动轮)"}),(0,n.jsx)("div",{className:"space-y-4",children:p.length>0?(0,n.jsxs)(n.Fragment,{children:[null==y?void 0:y.map((e,s)=>{var r;let l=null==b?void 0:null===(r=b.find(s=>BigInt(s.actionId)===BigInt(e.head.id)))||void 0===r?void 0:r.submitter;return(0,n.jsxs)("div",{className:"flex bg-white p-4 rounded-lg mb-4",children:[(0,n.jsx)("input",{type:"checkbox",className:"checkbox checkbox-warning mr-2",checked:k.has(BigInt(e.head.id)),onChange:()=>_(BigInt(e.head.id))}),(0,n.jsxs)(c(),{href:"/".concat(t.symbol,"/action/").concat(e.head.id,"?type=vote"),className:"flex-grow block",children:[(0,n.jsxs)("div",{className:"font-semibold mb-2",children:[(0,n.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,n.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,n.jsx)("p",{className:"leading-tight",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-gray-400",children:[(0,n.jsxs)("span",{className:"text-sm flex-1",children:["推举人 ",(0,n.jsx)(f.Z,{address:l,showCopyButton:!1})]}),(0,n.jsxs)("span",{className:"text-sm flex-1 text-right",children:[(0,n.jsx)("span",{className:"mr-1",children:"投票占比"}),0===Number((null==d?void 0:d[s])||0n)?"0":(100*Number((null==d?void 0:d[s])||0n)/Number(I)).toFixed(1),"%"]})]})]})]},e.head.id)}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:(0,n.jsx)(l.z,{className:"w-full bg-blue-600 hover:bg-blue-700",onClick:()=>{let e=Array.from(k).join(",");if(0===e.length){h.Am.error("请选择行动");return}a.push("/".concat(null==t?void 0:t.symbol,"/vote/vote?ids=").concat(e))},children:"投票"})})]}):(0,n.jsx)("div",{className:"text-sm text-gray-500 text-center",children:"没有行动"})})]}):(0,n.jsx)(u.Z,{})},b=()=>{let{currentRound:e,isPending:s,error:t}=(0,i.Bk)(),{token:a}=(0,r.useContext)(o.M)||{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Z,{title:"投票首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-6 bg-white",children:[s?(0,n.jsx)(u.Z,{}):(0,n.jsx)(x.Z,{currentRound:e,roundName:"投票轮"}),a&&(0,n.jsx)(c(),{href:"/".concat(a.symbol,"/vote/actions4submit"),className:"w-1/2",children:(0,n.jsx)(l.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"推举其他行动"})})]}),(0,n.jsx)(N,{currentRound:e})]})]})}}},function(e){e.O(0,[9689,8424,9767,7140,5714,2888,9774,179],function(){return e(e.s=63783)}),_N_E=e.O()}]);
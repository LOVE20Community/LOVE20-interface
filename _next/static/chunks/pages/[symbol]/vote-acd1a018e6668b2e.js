(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6843],{63783:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[symbol]/vote",function(){return t(29250)}])},34680:function(e,s,t){"use strict";t.d(s,{Ol:function(){return c},SZ:function(){return d},Zb:function(){return l},aY:function(){return o},eW:function(){return u},ll:function(){return i}});var n=t(85893),r=t(67294),a=t(40108);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...r})});l.displayName="Card";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",t),...r})});c.displayName="CardHeader";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("text-2xl font-semibold leading-none tracking-tight",t),...r})});i.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("text-sm text-muted-foreground",t),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("p-6 pt-0",t),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,n.jsx)("div",{ref:s,className:(0,a.cn)("flex items-center p-6 pt-0",t),...r})});u.displayName="CardFooter"},27460:function(e,s,t){"use strict";var n=t(85893),r=t(86501),a=t(74855),l=t(18289),c=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0,showAddress:i=!0,colorClassName:d=""}=e;return(0,n.jsxs)("span",{className:"flex items-center space-x-2",children:[i&&(0,n.jsx)("span",{className:"text-xs ".concat(null!=d?d:"text-greyscale-500"),children:(0,c.Vu)(s)}),t&&(0,n.jsx)(a.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?r.ZP.success("复制成功"):r.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,n.jsx)(l.Z,{className:"h-4 w-4 ".concat(null!=d?d:"text-greyscale-500")})})})]})}},64777:function(e,s,t){"use strict";var n=t(85893);s.Z=e=>{let{title:s}=e;return(0,n.jsx)("div",{className:"flex justify-between items-center",children:(0,n.jsx)("h1",{className:"text-lg font-bold",children:s})})}},42083:function(e,s,t){"use strict";var n=t(85893);s.Z=()=>(0,n.jsx)("span",{className:"flex justify-center items-center",children:(0,n.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-greyscale-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,n.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,n.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},91529:function(e,s,t){"use strict";t.d(s,{LH:function(){return l},Vu:function(){return a},bM:function(){return i},vz:function(){return c}});var n=t(21803),r=t(15229);let a=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",l=e=>{let s=i(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(s))},c=e=>{let s=parseInt("18",10);return(0,n.v)(e,s)},i=e=>{let s=parseInt("18",10);return(0,r.b)(e,s)}},29250:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return v}});var n=t(85893),r=t(67294),a=t(7080),l=t(93778),c=t(58732),i=t(11163),d=t(86501),o=t(27245),u=t(34680),x=t(94782),m=t(41664),f=t.n(m),h=t(42083),j=t(27460),p=t(64777),N=e=>{let{currentRound:s}=e,{token:t}=(0,r.useContext)(l.M)||{},c=(0,i.useRouter)(),{votes:m,isPending:N,error:v}=(0,a.$S)((null==t?void 0:t.address)||"",s),{actionSubmits:y,isPending:g,error:b}=(0,x.WZ)((null==t?void 0:t.address)||"",s),w=Array.from(new Set((null==y?void 0:y.map(e=>BigInt(e.actionId)))||[])).sort((e,s)=>Number(e)-Number(s)),{actionInfos:C,isPending:Z,error:k}=(0,x.fT)((null==t?void 0:t.address)||"",w),[_,I]=(0,r.useState)(new Set),P=e=>{I(s=>{console.log("prevSelected",s);let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},B=(null==m?void 0:m.reduce((e,s)=>e+s,0n))||0n;return N||g||w&&w.length>0&&Z?(0,n.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,n.jsx)(h.Z,{})}):b||k?(0,n.jsx)("div",{children:"加载出错，请稍后再试。"}):t?(0,n.jsxs)("div",{className:"p-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,n.jsx)(p.Z,{title:"投票中的行动"}),t&&(0,n.jsx)(o.z,{variant:"outline",size:"sm",className:"text-secondary border-secondary",asChild:!0,children:(0,n.jsx)(f(),{href:"/".concat(t.symbol,"/vote/actions4submit"),children:"推举其他行动"})})]}),(0,n.jsx)("div",{className:"space-y-4",children:w.length>0?(0,n.jsxs)(n.Fragment,{children:[null==C?void 0:C.map((e,s)=>{var r;let a=null==y?void 0:null===(r=y.find(s=>BigInt(s.actionId)===BigInt(e.head.id)))||void 0===r?void 0:r.submitter;return(0,n.jsxs)(u.Zb,{className:"shadow-none flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"checkbox accent-secondary ml-2",checked:_.has(BigInt(e.head.id)),onChange:()=>P(BigInt(e.head.id))}),(0,n.jsxs)(f(),{href:"/".concat(t.symbol,"/action/").concat(e.head.id,"?type=vote"),className:"w-full",children:[(0,n.jsxs)(u.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,n.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,n.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,n.jsxs)(u.aY,{className:"px-3 pt-1 pb-2",children:[(0,n.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,n.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,n.jsxs)("span",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"推举人"}),(0,n.jsx)("span",{className:"text-secondary",children:(0,n.jsx)(j.Z,{address:a,showCopyButton:!1})})]}),(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,n.jsxs)("span",{className:"text-secondary",children:[0===Number((null==m?void 0:m[s])||0n)?"0":(100*Number((null==m?void 0:m[s])||0n)/Number(B)).toFixed(1),"%"]})]})]})]})]},e.head.id)]},e.head.id)}),(0,n.jsx)("div",{className:"flex justify-center mt-4",children:(0,n.jsx)(o.z,{className:"w-full",onClick:()=>{let e=Array.from(_).join(",");if(0===e.length){d.Am.error("请选择行动");return}c.push("/".concat(null==t?void 0:t.symbol,"/vote/vote?ids=").concat(e))},children:"去给选中的行动投票"})})]}):(0,n.jsx)("div",{className:"text-sm text-greyscale-500 text-center",children:"没有行动"})})]}):(0,n.jsx)(h.Z,{})},v=()=>{let{currentRound:e,isPending:s,error:t}=(0,a.Bk)(),{token:i}=(0,r.useContext)(l.M)||{};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(c.Z,{title:"投票首页"}),(0,n.jsx)("main",{className:"flex-grow",children:(0,n.jsx)(N,{currentRound:e})})]})}}},function(e){e.O(0,[1664,7221,1502,7080,2888,9774,179],function(){return e(e.s=63783)}),_N_E=e.O()}]);
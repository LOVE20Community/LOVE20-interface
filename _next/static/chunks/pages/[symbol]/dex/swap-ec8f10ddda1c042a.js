(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5568],{30089:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[symbol]/dex/swap",function(){return s(35226)}])},27245:function(e,t,s){"use strict";s.d(t,{z:function(){return d}});var n=s(85893),a=s(67294),r=s(88426),i=s(45139),l=s(98997);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:s,variant:a,size:i,asChild:d=!1,...c}=e,u=d?r.g7:"button";return(0,n.jsx)(u,{className:(0,l.cn)(o({variant:a,size:i,className:s})),ref:t,...c})});d.displayName="Button"},21774:function(e,t,s){"use strict";s.d(t,{I:function(){return i}});var n=s(85893),a=s(67294),r=s(98997);let i=a.forwardRef((e,t)=>{let{className:s,type:a,...i}=e;return(0,n.jsx)("input",{type:a,className:(0,r.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",s),ref:t,...i})});i.displayName="Input"},98997:function(e,t,s){"use strict";s.d(t,{cn:function(){return r}});var n=s(90512),a=s(98388);function r(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,a.m6)((0,n.W)(t))}},35337:function(e,t,s){"use strict";s.d(t,{Z:function(){return m}});var n=s(85893),a=s(9008),r=s.n(a),i=s(67294),l=s(45420),o=s(41664),d=s.n(o),c=s(93778),u=()=>{let[e,t]=(0,i.useState)(!1),{token:s}=(0,i.useContext)(c.M)||{};return s?(0,n.jsxs)("div",{children:[(0,n.jsxs)("button",{className:"ml-4 mt-2 focus:outline-none",onClick:()=>{t(!e)},children:[(0,n.jsx)("div",{className:"w-6 h-1 bg-black mb-1"}),(0,n.jsx)("div",{className:"w-6 h-1 bg-black mb-1"}),(0,n.jsx)("div",{className:"w-6 h-1 bg-black"})]}),e&&(0,n.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40",onClick:()=>{t(!1)}}),(0,n.jsx)("div",{className:"fixed top-0 left-0 z-50 h-full w-64 bg-gray-800 text-white transform ".concat(e?"translate-x-0":"-translate-x-full"," transition-transform duration-300 ease-in-out"),children:(0,n.jsxs)("ul",{className:"mt-8",children:[(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/acting"),children:(0,n.jsx)("span",{children:"社区首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/gov"),children:(0,n.jsx)("span",{children:"治理首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/my"),children:(0,n.jsx)("span",{children:"我的首页"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/tokens",children:(0,n.jsx)("span",{children:"所有代币"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/launch"),children:(0,n.jsx)("span",{children:"发射平台"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/dex/swap"),children:(0,n.jsx)("span",{children:"交易代币"})})}),(0,n.jsx)("li",{className:"p-4 hover:bg-gray-700",children:(0,n.jsx)(d(),{href:"/".concat(s.symbol,"/launch/deposit"),children:(0,n.jsxs)("span",{children:["兑换","ETH20"]})})})]})})]}):""},m=e=>{let{title:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(r(),{children:[(0,n.jsx)("title",{children:"".concat(t," - LIFE20")}),(0,n.jsx)("meta",{name:"".concat(t," - LIFE20"),content:"A Web3 DApp for Life20 token management"})]}),(0,n.jsxs)("header",{className:"flex justify-between items-center p-4 bg-white border-b border-gray-100",children:[(0,n.jsx)(u,{}),(0,n.jsx)(l.NL,{})]})]})}},301:function(e,t,s){"use strict";s.d(t,{AT:function(){return d},op:function(){return o},oN:function(){return c}});var n=s(89810),a=s(75593),r=s(83540);let i=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],l="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",o=function(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:a,error:r,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsOut",args:[e,t],query:{enabled:!!e&&t.length>=2&&s}});return{data:a,error:r,isLoading:o}},d=function(e,t){let s=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:a,error:r,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsIn",args:[e,t],query:{enabled:!!e&&t.length>=2&&s}});return{data:a,error:r,isLoading:o}};function c(){let{writeContract:e,isPending:t,data:s,error:n}=(0,a.S)(),o=async(t,s,n,a,r)=>{try{await e({address:l,abi:i,functionName:"swapExactTokensForTokens",args:[t,s,n,a,r]})}catch(e){console.error("Swap failed:",e)}},{isLoading:d,isSuccess:c}=(0,r.A)({hash:s});return{swap:o,writeData:s,isWriting:t,writeError:n,isConfirming:d,isConfirmed:c}}},91529:function(e,t,s){"use strict";s.d(t,{LH:function(){return i},Vu:function(){return r},ZC:function(){return d},bM:function(){return o},vz:function(){return l}});var n=s(21803),a=s(15229);let r=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",i=e=>{let t=o(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(t))},l=e=>{let t=parseInt("18",10);return(0,n.v)(e,t)},o=e=>{let t=parseInt("18",10);return(0,a.b)(e,t)},d=e=>e>86400?"".concat(Math.floor(e/86400),"天").concat(Math.floor(e%86400/3600),"小时").concat(Math.floor(e%3600/60),"分"):e>3600?"".concat(Math.floor(e/3600),"小时").concat(Math.floor(e%3600/60),"分"):"".concat(Math.floor(e/60),"分").concat(e%60,"秒")},35226:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return z}});var n=s(85893),a=s(35337),r=s(67294),i=s(92321),l=s(62634),o=s(23432),d=s(86501),c=s(27245),u=s(21774),m=s(55209),f=s(42171),h=s(15432),x=s(78865),p=s(98997);let b=m.fC;m.ZA;let g=m.B4,y=r.forwardRef((e,t)=>{let{className:s,children:a,...r}=e;return(0,n.jsxs)(m.xz,{ref:t,className:(0,p.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...r,children:[a,(0,n.jsx)(m.JO,{asChild:!0,children:(0,n.jsx)(f.Z,{className:"h-4 w-4 opacity-50"})})]})});y.displayName=m.xz.displayName;let j=r.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(m.u_,{ref:t,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,n.jsx)(h.Z,{className:"h-4 w-4"})})});j.displayName=m.u_.displayName;let v=r.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(m.$G,{ref:t,className:(0,p.cn)("flex cursor-default items-center justify-center py-1",s),...a,children:(0,n.jsx)(f.Z,{className:"h-4 w-4"})})});v.displayName=m.$G.displayName;let w=r.forwardRef((e,t)=>{let{className:s,children:a,position:r="popper",...i}=e;return(0,n.jsx)(m.h_,{children:(0,n.jsxs)(m.VY,{ref:t,className:(0,p.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:r,...i,children:[(0,n.jsx)(j,{}),(0,n.jsx)(m.l_,{className:(0,p.cn)("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,n.jsx)(v,{})]})})});w.displayName=m.VY.displayName,r.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(m.__,{ref:t,className:(0,p.cn)("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=m.__.displayName;let N=r.forwardRef((e,t)=>{let{className:s,children:a,...r}=e;return(0,n.jsxs)(m.ck,{ref:t,className:(0,p.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...r,children:[(0,n.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,n.jsx)(m.wU,{children:(0,n.jsx)(x.Z,{className:"h-4 w-4"})})}),(0,n.jsx)(m.eT,{children:a})]})});N.displayName=m.ck.displayName,r.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)(m.Z0,{ref:t,className:(0,p.cn)("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=m.Z0.displayName;var k=s(93778),S=()=>{let e=(0,r.useContext)(k.M);if(void 0===e)throw Error("useTokenContext must be used within a TokenProvider");return e},T=s(19638),C=s(91529),E=s(301),_=()=>{let{address:e}=(0,i.m)(),{token:t}=S(),[s,a]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),[m,f]=(0,r.useState)({symbol:"",address:"0x0",amount:0n,amountShow:"0",balance:0n}),{approve:h,isWriting:x,isConfirmed:p,writeError:j}=(0,T.yA)(null==t?void 0:t.address),{approve:v,isWriting:k,isConfirmed:_,writeError:z}=(0,T.yA)(null==t?void 0:t.parentTokenAddress),{swap:A,isWriting:M,writeError:I,isConfirming:F,isConfirmed:Z}=(0,E.oN)(),[D,L]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&(a({address:t.parentTokenAddress,amount:0n,amountShow:"0",balance:0n,symbol:t.parentTokenSymbol}),f({address:t.address,amount:0n,amountShow:"0",balance:0n,symbol:t.symbol}))},[t]);let{balance:R,isPending:B,error:O}=(0,T.hS)(s.address,e),{balance:P,isPending:V,error:W}=(0,T.hS)(m.address,e);(0,r.useEffect)(()=>{R&&a(e=>({...e,balance:R})),P&&f(e=>({...e,balance:P}))},[R,P]);let{data:H,error:q,isLoading:G}=(0,E.op)(s.amount,[s.address,m.address]);(0,r.useEffect)(()=>{(O||W)&&d.Am.error("授权失败")},[O,W]),(0,r.useEffect)(()=>{if(H&&H.length>1){let e=BigInt(H[1]);f(t=>({...t,amount:e,amountShow:(0,C.bM)(e)}))}},[H]);let U=async()=>{try{let e=(null==t?void 0:t.symbol)===s.symbol?h:v;await e("0xCB54233742E93C680B634DF5aDf33d28b288Dc95",s.amount)}catch(e){console.error(e),d.Am.error((null==e?void 0:e.message)||"授权失败")}};(0,r.useEffect)(()=>{(p||_)&&(d.Am.success("授权成功"),L(!0))},[p,_]);let X=async()=>{try{let t=BigInt(Math.floor(Date.now()/1e3)+1200);await A(s.amount,s.amount/1055n*1000n,[s.address,m.address],e,t)}catch(e){console.error(e),d.Am.error((null==e?void 0:e.message)||"兑换失败")}};(0,r.useEffect)(()=>{Z&&(d.Am.success("兑换成功"),setTimeout(()=>{window.location.reload()},2e3))},[Z]);let[Y,$]=(0,r.useState)("0");return(0,r.useEffect)(()=>{s.amountShow?$((.3*parseFloat(s.amountShow)/100).toFixed(4)):$("0")},[s.amountShow]),(0,n.jsx)("div",{className:"flex items-center justify-center bg-gray-100",children:(0,n.jsxs)("div",{className:"w-full max-w-md p-6 bg-white ",children:[(0,n.jsx)("h1",{className:"text-xl font-bold mb-6",children:"兑换"}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,n.jsx)(u.I,{type:"number",placeholder:"0.0",className:"flex-grow",value:s.amountShow,onChange:e=>{let t=e.target.value;a({...s,amountShow:t}),""===t||parseFloat(t),t.endsWith(".")||a({...s,amount:(0,C.vz)(t),amountShow:t})},disabled:B||V||x||k||D||M}),(0,n.jsxs)(b,{value:s.address,onValueChange:e=>a({...s,address:e}),children:[(0,n.jsx)(y,{className:"w-[120px]",children:(0,n.jsx)(g,{placeholder:"选择代币"})}),(0,n.jsx)(w,{children:(0,n.jsx)(N,{value:s.address,children:s.symbol})})]})]}),(0,n.jsxs)("div",{className:"flex items-center text-sm gap-2",children:[(0,n.jsxs)("span",{className:"text-gray-400",children:[(0,C.LH)(s.balance||0n)," ",s.symbol]}),(0,n.jsx)(c.z,{variant:"outline",size:"sm",onClick:()=>{a(e=>({...e,amount:e.balance,amountShow:(0,C.bM)(e.balance)}))},children:"最高"})]})]}),(0,n.jsx)("div",{className:"flex justify-center my-4",children:(0,n.jsx)(c.z,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-gray-100",onClick:()=>{m.amount=s.amount,m.amountShow=s.amountShow,s.amount=0n,s.amountShow="0",a(m),f(s)},children:(0,n.jsx)(l.Z,{className:"h-6 w-6"})})}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,n.jsx)(u.I,{type:"text",disabled:!0,placeholder:"0.0",className:"flex-grow",value:m.amountShow,readOnly:!0}),(0,n.jsxs)(b,{value:m.address,onValueChange:e=>f({...m,address:e}),children:[(0,n.jsx)(y,{className:"w-[120px]",children:(0,n.jsx)(g,{placeholder:"选择代币"})}),(0,n.jsx)(w,{children:(0,n.jsx)(N,{value:m.address,children:m.symbol})})]})]}),(0,n.jsx)("div",{className:"flex justify-between items-center text-sm",children:(0,n.jsxs)("span",{className:"text-gray-400",children:[(0,C.LH)(m.balance||0n)," ",m.symbol]})})]}),(0,n.jsxs)("div",{className:"flex flex-row gap-2",children:[(0,n.jsxs)(c.z,{className:"w-1/2 text-white ".concat(D?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"),onClick:U,disabled:x||k||D,children:[(x||k)&&(0,n.jsx)(o.Z,{className:"animate-spin"}),D?"1.已授权":"1.授权"]}),(0,n.jsxs)(c.z,{className:"w-1/2 text-white ".concat(D?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"),onClick:X,disabled:!D||x||k||M||F||Z,children:[(M||F)&&(0,n.jsx)(o.Z,{className:"animate-spin"}),M||F?"2.兑换中":"2.兑换"]})]}),q&&(0,n.jsx)("div",{className:"text-red-500",children:q.message}),I&&(0,n.jsx)("div",{className:"text-red-500",children:I.message}),j&&(0,n.jsx)("div",{className:"text-red-500",children:j.message}),z&&(0,n.jsx)("div",{className:"text-red-500",children:z.message}),s.amount>0n&&(0,n.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-md",children:[(0,n.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"手续费 (0.3%)："}),(0,n.jsxs)("span",{children:[Y," ",s.symbol]})]}),(0,n.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,n.jsx)("span",{className:"text-gray-400",children:"滑点上限 (自动)："}),(0,n.jsx)("span",{children:"5.5%"})]})]})]})})};function z(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{title:"Swap"}),(0,n.jsx)("main",{className:"flex-grow",children:(0,n.jsx)(_,{})})]})}}},function(e){e.O(0,[9689,8424,146,9638,2888,9774,179],function(){return e(e.s=30089)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9035],{15492:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[symbol]/action/[id]",function(){return l(79658)}])},20725:function(e,s,l){"use strict";var t=l(85893),n=l(67294),r=l(94782),a=l(93778),i=l(91529),c=l(27460),d=l(91318);s.Z=e=>{var s;let{actionId:l,round:x,showSubmitter:o}=e,{token:m}=(0,n.useContext)(a.M)||{},{actionInfo:u,isPending:h,error:j}=(0,r.dI)(null==m?void 0:m.address,l),{actionSubmits:g,isPending:f,error:N}=(0,r.WZ)(null==m?void 0:m.address,o?x:0n),b=(null==g?void 0:null===(s=g.find(e=>e.actionId==Number(l)))||void 0===s?void 0:s.submitter)||"N/A";return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white mb-4",children:[(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsxs)("span",{className:"text-sm text-gray-500",children:["No.",null==u?void 0:u.head.id.toString()]}),(0,t.jsx)("span",{className:"text-2xl font-bold text-black",children:null==u?void 0:u.body.action})]}),(0,t.jsx)("div",{className:"mt-2",children:(0,t.jsx)("span",{className:"text-gray-600",children:null==u?void 0:u.body.consensus})}),(0,t.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,t.jsx)(c.Z,{address:null==u?void 0:u.head.author})]}),o&&(0,t.jsxs)("div",{className:"flex items-center",children:["推举人 ",(0,t.jsx)(c.Z,{address:b})]})]})]}),(0,t.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white",children:[(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-base text-gray-500",children:"参与资产上限"}),(0,t.jsx)("p",{className:"text-lg",children:(0,i.LH)((null==u?void 0:u.body.maxStake)||BigInt(0))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-base text-gray-500",children:"随机奖励地址数"}),(0,t.jsx)("p",{className:"text-lg",children:(null==u?void 0:u.body.maxRandomAccounts.toString())||"-"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-base text-gray-500",children:"验证规则"}),(0,t.jsx)("p",{className:"text-lg",children:(null==u?void 0:u.body.verificationRule)||"-"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-base text-gray-500",children:"验证信息填写指引"}),(0,t.jsx)("p",{className:"text-lg",children:(null==u?void 0:u.body.verificationInfoGuide)||"-"})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-base text-gray-500",children:"白名单"}),(0,t.jsx)("p",{className:"text-lg flex flex-wrap items-center",children:(null==u?void 0:u.body.whiteList.length)?u.body.whiteList.map((e,s)=>(0,t.jsx)("span",{className:"flex items-center mr-2",children:(0,t.jsx)(c.Z,{address:e})},s)):"无限制"})]})]}),(h||o&&f)&&(0,t.jsx)(d.Z,{}),(j||o&&N)&&(0,t.jsx)("div",{className:"text-center text-sm text-red-500",children:(null==j?void 0:j.message)||(null==N?void 0:N.message)})]})]})}},74089:function(e,s,l){"use strict";var t=l(85893),n=l(67294),r=l(91529);s.Z=e=>{let{initialTimeLeft:s}=e,[l,a]=(0,n.useState)(s);(0,n.useEffect)(()=>{if(s<=0)return;a(s);let e=setInterval(()=>{a(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let i=(0,r.ZC)(l);return(0,t.jsx)(t.Fragment,{children:i})}},7191:function(e,s,l){"use strict";var t=l(85893);l(67294);var n=l(3125),r=l(74089);s.Z=e=>{let{currentRound:s,roundName:l}=e,{data:a}=(0,n.O)(),i=Number("100")||0,c=Number("12")||0,d=a?i-Number(a)%i:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h1",{className:"text-base text-center font-bold",children:[l,"（第 ",(0,t.jsx)("span",{className:"text-red-500",children:Number(null!=s?s:0n)})," 轮）"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(r.Z,{initialTimeLeft:d>0?d*c:0})]})]})}},79658:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return E}});var t=l(85893),n=l(67294),r=l(11163),a=l(35337),i=l(20725),c=l(86501),d=l(27245),x=l(94782),o=l(93778),m=l(91318),u=l(7191),h=e=>{let{actionId:s,submitted:l,onRoundChange:a}=e,{token:i}=(0,n.useContext)(o.M)||{},h=(0,r.useRouter)(),{currentRound:j,isPending:g,error:f}=(0,x.Bk)();(0,n.useEffect)(()=>{a&&"function"==typeof a&&a(j)},[j,a]);let{submit:N,isWriting:b,isConfirming:v,isConfirmed:p,writeError:y}=(0,x.qd)();return(0,n.useEffect)(()=>{p&&!y&&(c.Am.success("推举成功",{duration:2e3}),setTimeout(()=>{h.push("/".concat(null==i?void 0:i.symbol,"/vote"))},2e3))},[p,y]),(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4 ",children:[g?(0,t.jsx)(m.Z,{}):(0,t.jsx)(u.Z,{currentRound:j,roundName:"投票轮"}),l||p?(0,t.jsx)(d.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"已推举"}):(0,t.jsx)(d.z,{onClick:()=>{b||v||N(null==i?void 0:i.address,s)},className:"w-1/2 bg-blue-600 hover:bg-blue-700",children:b||v?(0,t.jsx)(m.Z,{}):"推举"}),y?(0,t.jsxs)("p",{className:"text-red-500",children:["Error: ",y.shortMessage||y.message]}):null]})},j=l(92321),g=l(92180),f=l(7080),N=l(91529),b=e=>{let{actionId:s,onRoundChange:l}=e,{address:r}=(0,j.m)(),{token:a}=(0,n.useContext)(o.M)||{},{currentRound:i,isPending:c,error:x}=(0,f.Bk)();(0,n.useEffect)(()=>{l&&"function"==typeof l&&l(i)},[i,l]);let{validGovVotes:h,isPending:b}=(0,g.Ty)(null==a?void 0:a.address,r),{votesNumByAccountByActionId:v,isPending:p,error:y}=(0,f.Ol)(null==a?void 0:a.address,i,r,s),{vote:w,isWriting:Z,isConfirming:I,isConfirmed:E,writeError:C}=(0,f.rv)();return(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-8 bg-white mb-4  ",children:[c?(0,t.jsx)(m.Z,{}):(0,t.jsx)(u.Z,{currentRound:i,roundName:"投票轮"}),(0,t.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投票数"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:p?(0,t.jsx)(m.Z,{}):(0,N.LH)(v||BigInt(0))})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余票数"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:b||p?(0,t.jsx)(m.Z,{}):(0,N.LH)(h-v)})]})]}),p||v?(0,t.jsx)("div",{className:"flex flex-col items-center",children:(0,t.jsx)(d.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"您已投票"})}):(0,t.jsx)(d.z,{className:"w-1/2 bg-blue-600 hover:bg-blue-700",onClick:()=>{Z||I||w(null==a?void 0:a.address,[s],[h])},disabled:Z||I,children:Z||I?(0,t.jsx)(m.Z,{}):"投100%票"}),y?(0,t.jsxs)("p",{className:"text-red-500",children:["Error:",y.shortMessage||y.message]}):null,C?(0,t.jsxs)("p",{className:"text-red-500",children:["Error: ",C.shortMessage||C.message]}):null]})},v=l(41664),p=l.n(v),y=l(5028),w=e=>{let{actionId:s,onRoundChange:l}=e,{address:r}=(0,j.m)(),{token:a}=(0,n.useContext)(o.M)||{},{currentRound:i,isPending:c,error:x}=(0,y.Bk)();(0,n.useEffect)(()=>{l&&"function"==typeof l&&l(i)},[i,l]);let{joinedAmountByActionIdByAccount:h,isPending:g,error:f}=(0,y.X9)((null==a?void 0:a.address)||"",i,s,r||""),{joinedAmountByActionId:b,isPending:v,error:w}=(0,y.PL)((null==a?void 0:a.address)||"",i,s),Z=h&&h>0&&b&&b>0,I=Z?100*Number(h/b)+"%":"0%",{verificationInfo:E,isPending:C,error:P}=(0,y.Y5)((null==a?void 0:a.address)||"",i,s,r||"",Z);return(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4  ",children:[c?(0,t.jsx)(m.Z,{}):(0,t.jsx)(u.Z,{currentRound:i,roundName:"行动轮"}),(0,t.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我参与的代币数"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:v?(0,t.jsx)(m.Z,{}):(0,N.LH)(h||BigInt(0))})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"所占比例"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:I})]})]}),Z?(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)(d.z,{disabled:!0,className:"w-full bg-gray-400 cursor-not-allowed",children:"您已参与"}),(0,t.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:C?"加载中...":E})]}):(0,t.jsx)(p(),{href:"/".concat(null==a?void 0:a.symbol,"/acting/join?id=").concat(s),className:"w-1/2",children:(0,t.jsx)(d.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"参与行动"})})]})},Z=l(87250),I=e=>{let{actionId:s,onRoundChange:l}=e,{token:r}=(0,n.useContext)(o.M)||{},{address:a}=(0,j.m)(),{currentRound:i,isPending:c,error:x}=(0,Z.Bk)();(0,n.useEffect)(()=>{l&&"function"==typeof l&&l(i)},[i,l]);let{scoreByVerifierByActionId:h,isPending:g,error:f}=(0,Z.Tl)(null==r?void 0:r.address,i,a,s);return(0,t.jsx)(t.Fragment,{children:(0,t.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4 ",children:[c?(0,t.jsx)(m.Z,{}):(0,t.jsx)(u.Z,{currentRound:i,roundName:"验证轮"}),g?(0,t.jsx)(m.Z,{}):h?(0,t.jsx)(d.z,{className:"w-full bg-gray-400 cursor-not-allowed",children:"已验证"}):(0,t.jsx)(p(),{href:"/".concat(null==r?void 0:r.symbol,"/verify/").concat(s),className:"w-1/2",children:(0,t.jsx)(d.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去验证"})}),x&&(0,t.jsxs)("p",{className:"text-red-500",children:["Error: ",x.shortMessage||x.message]}),f&&(0,t.jsxs)("p",{className:"text-red-500",children:["Error:"," ",f.shortMessage||f.message]})]})})},E=()=>{let{id:e,type:s,submitted:l}=(0,r.useRouter)().query,[c,d]=(0,n.useState)(null),x=e=>{d(e)};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(a.Z,{title:"行动详情"}),(0,t.jsxs)("main",{className:"flex-grow",children:["submit"===s&&(0,t.jsx)(h,{actionId:BigInt(e||0),submitted:"true"===l,onRoundChange:x}),"vote"===s&&(0,t.jsx)(b,{actionId:BigInt(e||0),onRoundChange:x}),("join"===s||void 0===s)&&(0,t.jsx)(w,{actionId:BigInt(e||0),onRoundChange:x}),"verify"===s&&(0,t.jsx)(I,{actionId:BigInt(e||0),onRoundChange:x}),(0,t.jsx)(i.Z,{actionId:BigInt(e||0),round:BigInt(c||0),showSubmitter:"submit"!==s})]})]})}}},function(e){e.O(0,[9689,8424,118,7140,2624,5714,7250,2180,2888,9774,179],function(){return e(e.s=15492)}),_N_E=e.O()}]);
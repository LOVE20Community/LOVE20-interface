(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4143],{85719:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verify",function(){return n(48585)}])},74089:function(e,r,n){"use strict";var t=n(85893),s=n(67294),c=n(91529);r.Z=e=>{let{initialTimeLeft:r}=e,[n,i]=(0,s.useState)(r),a=(0,s.useRef)(null),l=(0,s.useRef)(!1);(0,s.useEffect)(()=>(l.current=!0,r<=0)?void 0:(i(r),a.current&&clearInterval(a.current),a.current=setInterval(()=>{l.current&&i(e=>e<=1?(clearInterval(a.current),console.log("1.prevTime",e),0):(console.log("2.prevTime",e),e-1))},1e3),()=>{l.current=!1,a.current&&clearInterval(a.current)}),[r]);let o=(0,c.ZC)(n);return(0,t.jsx)(t.Fragment,{children:o})}},91318:function(e,r,n){"use strict";var t=n(85893);r.Z=()=>(0,t.jsx)("span",{className:"flex justify-center items-center",children:(0,t.jsxs)("svg",{className:"animate-spin h-5 w-5 mr-3 text-gray-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8H4z"})]})})},7191:function(e,r,n){"use strict";var t=n(85893);n(67294);var s=n(3125),c=n(74089);r.Z=e=>{let{currentRound:r,roundName:n}=e,{data:i}=(0,s.O)(),a=Number("100")||0,l=Number("12")||0,o=i?a-Number(i)%a:0;return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h1",{className:"text-base text-center font-bold",children:[n,"（第 ",(0,t.jsx)("span",{className:"text-red-500",children:Number(null!=r?r:0n)})," 轮）"]}),(0,t.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(c.Z,{initialTimeLeft:o>0?o*l:0})]})]})}},18308:function(e,r,n){"use strict";var t=n(85893),s=n(67294),c=n(92321),i=n(41664),a=n.n(i),l=n(7080),o=n(87250),d=n(93778),u=n(91529),x=n(91318),f=n(7191);r.Z=e=>{let{currentRound:r,showBtn:n=!0}=e,{token:i}=(0,s.useContext)(d.M)||{},{address:m}=(0,c.m)(),{votesNumByAccount:h,isPending:g,error:j}=(0,l.VI)(null==i?void 0:i.address,r,m||""),{scoreByVerifier:N,isPending:y,error:b}=(0,o.w3)(null==i?void 0:i.address,r,m||""),v=g||y?BigInt(0):h-N;return(0,t.jsxs)("div",{className:"flex flex-col items-center bg-white py-4",children:[(0,t.jsx)(f.Z,{currentRound:r,roundName:"验证轮"}),(0,t.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:y?(0,t.jsx)(x.Z,{}):(0,u.LH)(N||BigInt(0))})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余验证票"}),(0,t.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:g||y?(0,t.jsx)(x.Z,{}):(0,u.LH)(v)})]})]}),n&&(g||y?(0,t.jsx)(x.Z,{}):h>N?(0,t.jsx)(a(),{href:"/verify",className:"btn-primary btn w-1/2",children:"去验证"}):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"无剩余验证票"}))]})}},48585:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return h}});var t=n(85893),s=n(35337),c=n(87250),i=n(18308),a=n(67294),l=n(41664),o=n.n(l),d=n(7080),u=n(94782),x=n(93778),f=n(91318),m=e=>{let{currentRound:r}=e,{token:n}=(0,a.useContext)(x.M)||{},{actionIds:s,votes:c,isPending:i,error:l}=(0,d.$S)((null==n?void 0:n.address)||"",r),{actionInfos:m,isPending:h,error:g}=(0,u.fT)((null==n?void 0:n.address)||"",s||[]);return i||s&&s.length>0&&h?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(f.Z,{})}):l||g?(console.log("errorVotesNums",l),console.log("errorActionInfosByIds",g),(0,t.jsx)("div",{children:"加载出错，请稍后再试。"})):(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsx)("h2",{className:"text-sm font-bold mb-4 text-gray-600",children:"待验证行动"}),(0,t.jsx)("div",{className:"space-y-4",children:null==m?void 0:m.map((e,r)=>(0,t.jsx)("div",{className:"bg-white p-4 rounded-lg mb-4",children:(0,t.jsxs)(o(),{href:"/verify/".concat(e.head.id),children:[(0,t.jsxs)("div",{className:"font-semibold mb-2",children:[(0,t.jsx)("span",{className:"text-gray-400 text-base mr-1",children:"No.".concat(e.head.id)}),(0,t.jsx)("span",{className:"text-gray-800 text-lg",children:"".concat(e.body.action)})]}),(0,t.jsx)("p",{className:"leading-tight",children:e.body.consensus})]},e.head.id)},e.head.id))})]})},h=()=>{let{currentRound:e}=(0,c.Bk)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.Z,{title:"社区首页"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(i.Z,{currentRound:e,showBtn:!1}),(0,t.jsx)(m,{currentRound:e})]})]})}},3125:function(e,r,n){"use strict";n.d(r,{O:function(){return x}});var t=n(30202),s=n(97712),c=n(81946),i=n(36100),a=n(82451),l=n(82002),o=n(37122),d=n(65185),u=n(67294);function x(e={}){let{query:r={},watch:n}=e,x=(0,o.Z)(e),f=(0,t.NL)(),m=(0,l.x)({config:x}),h=e.chainId??m,g=function(e,r={}){return{gcTime:0,async queryFn({queryKey:r}){let{scopeKey:n,...t}=r[1];return await function(e,r={}){let{chainId:n,...t}=r,i=e.getClient({chainId:n});return(0,c.s)(i,s.z,"getBlockNumber")(t)}(e,t)??null},queryKey:function(e={}){return["blockNumber",(0,i.OP)(e)]}(r)}}(x,{...e,chainId:h});return!function(e={}){let{enabled:r=!0,onBlockNumber:n,config:t,...s}=e,i=(0,o.Z)(e),a=(0,l.x)({config:i}),x=e.chainId??a;(0,u.useEffect)(()=>{if(r&&n)return function(e,r){let n,t;let{syncConnectedChain:s=e._internal.syncConnectedChain,...i}=r,a=r=>{n&&n();let t=e.getClient({chainId:r});return n=(0,c.s)(t,d.q,"watchBlockNumber")(i)},l=a(r.chainId);return s&&!r.chainId&&(t=e.subscribe(({chainId:e})=>e,async e=>a(e))),()=>{l?.(),t?.()}}(i,{...s,chainId:x,onBlockNumber:n})},[x,i,r,n,s.onError,s.emitMissed,s.emitOnBegin,s.poll,s.pollingInterval,s.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof n?n:{}},enabled:!!((r.enabled??!0)&&("object"==typeof n?n.enabled:n)),onBlockNumber(e){f.setQueryData(g.queryKey,e)}}),(0,a.aM)({...r,...g})}},89810:function(e,r,n){"use strict";n.d(r,{u:function(){return l}});var t=n(37003),s=n(36100),c=n(82451),i=n(82002),a=n(37122);function l(e={}){let{abi:r,address:n,functionName:l,query:o={}}=e,d=e.code,u=(0,a.Z)(e),x=(0,i.x)({config:u}),f=function(e,r={}){return{async queryFn({queryKey:n}){let s=r.abi;if(!s)throw Error("abi is required");let{functionName:c,scopeKey:i,...a}=n[1],l=(()=>{let e=n[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!c)throw Error("functionName is required");return(0,t.L)(e,{abi:s,functionName:c,args:a.args,...l,...a})},queryKey:function(e={}){let{abi:r,...n}=e;return["readContract",(0,s.OP)(n)]}(r)}}(u,{...e,chainId:e.chainId??x}),m=!!((n||d)&&r&&l&&(o.enabled??!0));return(0,c.aM)({...o,...f,enabled:m,structuralSharing:o.structuralSharing??s.if})}}},function(e){e.O(0,[4784,7140,7080,7250,2888,9774,179],function(){return e(e.s=85719)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6700],{54889:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov",function(){return t(7263)}])},27460:function(e,s,t){"use strict";var l=t(85893),n=t(86501),a=t(74855),r=t(18289),c=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0}=e;return(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:(0,c.Vu)(s)}),t&&(0,l.jsx)(a.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?n.ZP.success("复制成功"):n.ZP.error("复制失败")},children:(0,l.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,l.jsx)(r.Z,{className:"h-4 w-4 text-gray-500"})})})]})}},74089:function(e,s,t){"use strict";var l=t(85893),n=t(67294),a=t(91529);s.Z=e=>{let{initialTimeLeft:s}=e,[t,r]=(0,n.useState)(s);(0,n.useEffect)(()=>{if(s<=0)return;r(s);let e=setInterval(()=>{r(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let c=(0,a.ZC)(t);return(0,l.jsx)(l.Fragment,{children:c})}},7191:function(e,s,t){"use strict";var l=t(85893);t(67294);var n=t(3125),a=t(74089);s.Z=e=>{let{currentRound:s,roundName:t}=e,{data:r}=(0,n.O)(),c=Number("100")||0,i=Number("12")||0,x=r?c-Number(r)%c:0;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h1",{className:"text-base text-center font-bold",children:[t,"（第 ",(0,l.jsx)("span",{className:"text-red-500",children:Number(null!=s?s:0n)})," 轮）"]}),(0,l.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,l.jsx)(a.Z,{initialTimeLeft:x>0?x*i:0})]})]})}},18308:function(e,s,t){"use strict";var l=t(85893),n=t(67294),a=t(92321),r=t(41664),c=t.n(r),i=t(7080),x=t(87250),d=t(93778),o=t(91529),m=t(91318),u=t(7191);s.Z=e=>{let{currentRound:s,showBtn:t=!0}=e,{token:r}=(0,n.useContext)(d.M)||{},{address:f}=(0,a.m)(),{votesNumByAccount:j,isPending:h,error:N}=(0,i.VI)(null==r?void 0:r.address,s,f||""),{scoreByVerifier:g,isPending:v,error:b}=(0,x.w3)(null==r?void 0:r.address,s,f||""),p=h||v?BigInt(0):j-g;return(0,l.jsxs)("div",{className:"flex flex-col items-center bg-white py-4",children:[(0,l.jsx)(u.Z,{currentRound:s,roundName:"验证轮"}),(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投验证票"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:v?(0,l.jsx)(m.Z,{}):(0,o.LH)(g||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余验证票"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:h||v?(0,l.jsx)(m.Z,{}):(0,o.LH)(p)})]})]}),t&&(h||v?(0,l.jsx)(m.Z,{}):j>g?(0,l.jsx)(c(),{href:"/verify",className:"btn-primary btn w-1/2",children:"去验证"}):(0,l.jsx)("span",{className:"text-gray-500 text-sm",children:"无剩余验证票"}))]})}},33484:function(e,s,t){"use strict";t.d(s,{Z:function(){return f}});var l=t(85893),n=t(67294),a=t(41664),r=t.n(a),c=t(93778),i=t(27460),x=t(23432),d=t(93461),o=t(92321),m=t(89469);function u(e){let{tokenAddress:s,tokenSymbol:t,tokenDecimals:a,tokenImage:r}=e,[c,i]=(0,n.useState)(!1),{isConnected:u}=(0,o.m)(),{data:f}=(0,m.p)(),j=async()=>{if(!u){alert("请先连接你的钱包");return}i(!0);try{if(!f){alert("无法获取钱包客户端");return}await f.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:t,decimals:a,image:r}}})?(console.log("代币已添加到 MetaMask 钱包"),alert("代币已成功添加到 MetaMask 钱包")):(console.log("用户拒绝添加代币"),alert("用户拒绝添加代币"))}catch(e){console.error("添加代币失败:",e),alert("添加代币失败，请检查控制台以获取更多信息")}finally{i(!1)}};return(0,l.jsx)("button",{onClick:j,disabled:c,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:c?(0,l.jsx)(x.Z,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(d.Z,{className:"h-4 w-4 text-gray-500"})})}var f=e=>{let{showGovernanceLink:s=!1}=e,t=(0,n.useContext)(c.M);if(!t||!t.token)return(0,l.jsx)("div",{className:"text-center text-error",children:"Token information is not available."});let{token:a}=t;return(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)("div",{className:"mr-2",children:(0,l.jsxs)("div",{className:"flex items-center",children:[(0,l.jsx)("span",{className:"font-bold text-2xl text-yellow-500",children:"$"}),(0,l.jsx)("span",{className:"font-bold text-2xl mr-2",children:a.symbol}),(0,l.jsx)(i.Z,{address:a.address}),(0,l.jsx)(u,{tokenAddress:null==a?void 0:a.address,tokenSymbol:(null==a?void 0:a.symbol)||"",tokenDecimals:(null==a?void 0:a.decimals)||0})]})}),s&&(0,l.jsx)(r(),{href:"/gov",className:"text-blue-400 text-sm hover:underline ml-auto",children:"参与治理>>"})]})}},7263:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var l=t(85893),n=t(35337),a=t(7080),r=t(67294),c=t(92180),i=t(77156),x=t(93778),d=t(91529),o=t(33484),m=t(18303),u=()=>{let{token:e}=(0,r.useContext)(x.M)||{},{govVotesNum:s,isPending:t}=(0,c.kc)(null==e?void 0:e.address),{totalSupply:n,isPending:a}=(0,i.A5)(null==e?void 0:e.stTokenAddress);return(0,l.jsxs)("div",{className:"p-6 bg-white ",children:[(0,l.jsx)(o.Z,{}),(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20 mb-4",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"总治理票"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:t?"Loading...":(0,d.LH)(s||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"代币质押量"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:a?"Loading...":(0,d.LH)(n||BigInt(0))})]})]}),(0,l.jsx)("div",{className:"w-full flex flex-col items-center space-y-4 bg-gray-100 rounded p-4",children:(0,l.jsx)(m.Z,{})})]})},f=t(92321),j=t(91318),h=t(41664),N=t.n(h),g=t(27245),v=()=>{let{token:e}=(0,r.useContext)(x.M)||{},{address:s}=(0,f.m)(),{govVotes:t,stAmount:n,isPending:a,error:i}=(0,c.L)((null==e?void 0:e.address)||"",s||"");return(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-6 bg-white  mt-4",children:[(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的治理票数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:a?(0,l.jsx)(j.Z,{}):(0,d.LH)(t||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的质押数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:a?(0,l.jsx)(j.Z,{}):(0,d.LH)(n||BigInt(0))})]})]}),(0,l.jsx)(N(),{href:"/gov/stake",className:"w-1/2",children:(0,l.jsx)(g.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去质押"})})]})},b=t(7191),p=e=>{let{currentRound:s}=e,{token:t}=(0,r.useContext)(x.M)||{},{address:n}=(0,f.m)(),{validGovVotes:i,isPending:o}=(0,c.Ty)((null==t?void 0:t.address)||"",n||""),{votesNumByAccount:m,isPending:u}=(0,a.VI)((null==t?void 0:t.address)||"",s,n||"");return console.log("validGovVotes",i),console.log("votesNumByAccount",m),(0,l.jsxs)("div",{className:"flex flex-col items-center p-6 bg-white mt-4 mb-4",children:[(0,l.jsx)(b.Z,{currentRound:s,roundName:"投票轮"}),(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投票数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:u?(0,l.jsx)(j.Z,{}):(0,d.LH)(m||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余票数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:o||u?(0,l.jsx)(j.Z,{}):(0,d.LH)(i-m||BigInt(0))})]})]}),o||u?(0,l.jsx)(j.Z,{}):i>m?(0,l.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,l.jsx)(N(),{href:"/vote/actions4submit",children:(0,l.jsx)(g.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去推举"})}),(0,l.jsx)(N(),{href:"/vote",children:(0,l.jsx)(g.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去投票"})})]}):(0,l.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,l.jsx)(N(),{href:"/vote/actions4submit",children:(0,l.jsx)(g.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去推举"})}),(0,l.jsx)(g.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"去投票"})]})]})},y=t(18308),w=()=>{let{currentRound:e}=(0,a.Bk)();return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{title:"治理首页"}),(0,l.jsxs)("main",{className:"flex-grow",children:[(0,l.jsx)(u,{}),(0,l.jsx)(v,{}),(0,l.jsx)(p,{currentRound:e}),(0,l.jsx)(y.Z,{currentRound:e>2?e-2n:0n})]})]})}}},function(e){e.O(0,[4846,8424,3311,7080,765,7250,7716,2888,9774,179],function(){return e(e.s=54889)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9082],{87869:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/acting",function(){return n(75959)}])},34680:function(e,s,n){"use strict";n.d(s,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return a},aY:function(){return o},eW:function(){return u},ll:function(){return c}});var t=n(85893),r=n(67294),l=n(40108);let a=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",n),...r})});a.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",n),...r})});i.displayName="CardHeader";let c=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",n),...r})});c.displayName="CardTitle";let d=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",n),...r})});d.displayName="CardDescription";let o=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",n),...r})});o.displayName="CardContent";let u=r.forwardRef((e,s)=>{let{className:n,...r}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",n),...r})});u.displayName="CardFooter"},34426:function(e,s,n){"use strict";n.d(s,{Z:function(){return o}});var t=n(85893),r=n(67294),l=n(23432),a=n(93461),i=n(92321),c=n(89469),d=n(86501);function o(e){let{tokenAddress:s,tokenSymbol:n,tokenDecimals:o,tokenImage:u}=e,[x,m]=(0,r.useState)(!1),{isConnected:f}=(0,i.m)(),{data:j}=(0,c.p)(),h=async()=>{if(!f){alert("请先连接你的钱包");return}m(!0);try{if(!j){alert("无法获取钱包客户端");return}await j.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:n,decimals:o,image:u}}})?(console.log("代币已添加到 MetaMask 钱包"),d.ZP.success("代币已成功添加到 MetaMask 钱包")):(console.log("用户拒绝添加代币"),d.ZP.error("用户拒绝添加代币"))}catch(e){console.error("添加代币失败:",e),d.ZP.error("添加代币失败，请检查控制台以获取更多信息")}finally{m(!1)}};return(0,t.jsx)("button",{onClick:h,disabled:x,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:x?(0,t.jsx)(l.Z,{className:"h-4 w-4 animate-spin"}):(0,t.jsx)(a.Z,{className:"h-4 w-4 text-greyscale-500"})})}},74089:function(e,s,n){"use strict";var t=n(85893),r=n(67294);s.Z=e=>{let{initialTimeLeft:s}=e,[n,l]=(0,r.useState)(s);(0,r.useEffect)(()=>{if(s<=0)return;l(s);let e=setInterval(()=>{l(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let a=Math.floor(n/86400);return(0,t.jsxs)("div",{className:"inline-flex gap-1  text-secondary",children:[a>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":a}})}),"天"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":Math.floor(n%86400/3600)}})}),"时"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":Math.floor(n%3600/60)}})}),"分"]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"countdown font-mono",children:(0,t.jsx)("span",{style:{"--value":n%60}})}),"秒"]})]})}},7191:function(e,s,n){"use strict";var t=n(85893);n(67294);var r=n(3125),l=n(74089);s.Z=e=>{let{currentRound:s,roundName:n}=e,{data:a}=(0,r.O)(),i=Number("100")||0,c=Number("12")||0,d=a?i-Number(a)%i:0;return(0,t.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,t.jsxs)("h1",{className:"text-lg font-bold",children:[n," 第 ",(0,t.jsx)("span",{className:"text-secondary",children:Number(null!=s?s:0n)})," 轮"]}),(0,t.jsxs)("span",{className:"text-sm text-greyscale-400 mt-1 pt-0",children:["本轮剩余：",(0,t.jsx)(l.Z,{initialTimeLeft:d>0?d*c:0})]})]})}},66247:function(e,s,n){"use strict";n.d(s,{Z:function(){return u}});var t=n(85893),r=n(67294),l=n(93778),a=n(19638),i=n(42083),c=n(27460),d=n(34426),o=e=>{let{}=e,{token:s}=(0,r.useContext)(l.M)||{};return s?(0,t.jsx)("div",{className:"flex items-center",children:(0,t.jsx)("div",{className:"mr-2",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("span",{className:"font-bold text-2xl mr-2",children:s.symbol}),(0,t.jsx)(c.Z,{address:s.address}),(0,t.jsx)(d.Z,{tokenAddress:null==s?void 0:s.address,tokenSymbol:(null==s?void 0:s.symbol)||"",tokenDecimals:(null==s?void 0:s.decimals)||0})]})})}):(0,t.jsx)(i.Z,{})};function u(){let{token:e}=(0,r.useContext)(l.M)||{},{totalSupply:s,isPending:n,error:c}=(0,a.A5)((null==e?void 0:e.address)||""),[d,u]=(0,r.useState)(!1);return(null==e?void 0:e.address)?(0,t.jsxs)("div",{className:"px-6 pt-2 pb-6",children:[(0,t.jsx)(o,{}),!1]}):(0,t.jsx)(i.Z,{})}},75959:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return g}});var t=n(85893),r=n(5028),l=n(67294),a=n(7399),i=n(93778),c=n(91529),d=n(42083),o=n(7191),u=e=>{let{currentRound:s}=e,{token:n}=(0,l.useContext)(i.M)||{},{rewardAvailable:u,isPending:x,error:m}=(0,a.CY)((null==n?void 0:n.address)||""),{joinedAmount:f,isPending:j,error:h}=(0,r.fP)((null==n?void 0:n.address)||"",s);return(0,t.jsxs)("div",{className:"px-6",children:[(0,t.jsx)(o.Z,{currentRound:s,roundName:"行动轮"}),(0,t.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title",children:"预计新增铸币"}),(0,t.jsx)("div",{className:"stat-value text-2xl",children:x||void 0===u?(0,t.jsx)(d.Z,{}):(0,c.LH)(99n*u/10000n)})]}),(0,t.jsxs)("div",{className:"stat place-items-center",children:[(0,t.jsx)("div",{className:"stat-title",children:"参与行动代币"}),(0,t.jsx)("div",{className:"stat-value text-2xl",children:j?(0,t.jsx)(d.Z,{}):(0,c.LH)(f||BigInt(0))})]})]})]})},x=n(58732),m=n(41664),f=n.n(m),j=n(92321),h=n(34680),N=n(45551),v=n(94782),p=n(64777),y=e=>{let{currentRound:s}=e,{token:n}=(0,l.useContext)(i.M)||{},{address:r}=(0,j.m)(),{actions:a,isPending:o,error:u}=(0,N.jA)((null==n?void 0:n.address)||"",s);null==a||a.sort((e,s)=>Number(e.actionId)-Number(s.actionId));let x=null==a?void 0:a.map(e=>e.actionId),m=(null==a?void 0:a.reduce((e,s)=>e+s.votesNum,0n))||0n,{actionInfos:y,isPending:b,error:g}=(0,v.fT)((null==n?void 0:n.address)||"",x||[]),{joinedActions:w,isPending:Z,error:C}=(0,N.dB)((null==n?void 0:n.address)||"",r);return o||x&&x.length>0&&b||Z?(0,t.jsx)("div",{className:"p-4 flex justify-center items-center",children:(0,t.jsx)(d.Z,{})}):u||g||C?(console.error("errorJoinableActions",u),console.error("errorActionInfosByIds",g),console.error("errorJoinedActions",C),(0,t.jsx)("div",{children:"加载出错，请稍后再试。"})):(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsx)(p.Z,{title:"进行中的行动"}),(null==x?void 0:x.length)?(0,t.jsx)("div",{className:"mt-4 space-y-4",children:null==y?void 0:y.map((e,s)=>{let r=(null==w?void 0:w.some(s=>s.actionId===BigInt(e.head.id)))?"/action/".concat(e.head.id,"?type=join&symbol=").concat(null==n?void 0:n.symbol):"/acting/join?id=".concat(e.head.id,"&symbol=").concat(null==n?void 0:n.symbol);return(0,t.jsx)(h.Zb,{className:"shadow-none",children:(0,t.jsxs)(f(),{href:r,children:[(0,t.jsxs)(h.Ol,{className:"px-3 pt-2 pb-1 flex-row justify-start items-baseline",children:[(0,t.jsx)("span",{className:"text-greyscale-400 text-sm mr-1",children:"No.".concat(e.head.id)}),(0,t.jsx)("span",{className:"font-bold text-greyscale-800",children:"".concat(e.body.action)})]}),(0,t.jsxs)(h.aY,{className:"px-3 pt-1 pb-2",children:[(0,t.jsx)("div",{className:"text-greyscale-500",children:e.body.consensus}),(0,t.jsxs)("div",{className:"flex justify-between mt-1 text-sm",children:[(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"投票占比"}),(0,t.jsxs)("span",{className:"text-secondary",children:[(100*Number((null==a?void 0:a[s].votesNum)||0n)/Number(m)).toFixed(1),"%"]})]}),(0,t.jsxs)("span",{children:[(0,t.jsx)("span",{className:"text-greyscale-400 mr-1",children:"参与代币数"}),(0,t.jsx)("span",{className:"text-secondary",children:(0,c.LH)((null==a?void 0:a[s].joinedAmount)||0n)})]})]})]})]})},e.head.id)})}):(0,t.jsx)("div",{className:"text-sm text-greyscale-500 text-center",children:"没有行动"})]})},b=n(66247),g=()=>{let{currentRound:e}=(0,r.Bk)();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(x.Z,{title:"社区首页"}),(0,t.jsxs)("main",{className:"flex-grow",children:[(0,t.jsx)(b.Z,{}),(0,t.jsx)(u,{currentRound:e}),(0,t.jsx)(y,{currentRound:e})]})]})}},3125:function(e,s,n){"use strict";n.d(s,{O:function(){return x}});var t=n(30202),r=n(97712),l=n(81946),a=n(36100),i=n(82451),c=n(82002),d=n(37122),o=n(65185),u=n(67294);function x(e={}){let{query:s={},watch:n}=e,x=(0,d.Z)(e),m=(0,t.NL)(),f=(0,c.x)({config:x}),j=e.chainId??f,h=function(e,s={}){return{gcTime:0,async queryFn({queryKey:s}){let{scopeKey:n,...t}=s[1];return await function(e,s={}){let{chainId:n,...t}=s,a=e.getClient({chainId:n});return(0,l.s)(a,r.z,"getBlockNumber")(t)}(e,t)??null},queryKey:function(e={}){return["blockNumber",(0,a.OP)(e)]}(s)}}(x,{...e,chainId:j});return!function(e={}){let{enabled:s=!0,onBlockNumber:n,config:t,...r}=e,a=(0,d.Z)(e),i=(0,c.x)({config:a}),x=e.chainId??i;(0,u.useEffect)(()=>{if(s&&n)return function(e,s){let n,t;let{syncConnectedChain:r=e._internal.syncConnectedChain,...a}=s,i=s=>{n&&n();let t=e.getClient({chainId:s});return n=(0,l.s)(t,o.q,"watchBlockNumber")(a)},c=i(s.chainId);return r&&!s.chainId&&(t=e.subscribe(({chainId:e})=>e,async e=>i(e))),()=>{c?.(),t?.()}}(a,{...r,chainId:x,onBlockNumber:n})},[x,a,s,n,r.onError,r.emitMissed,r.emitOnBegin,r.poll,r.pollingInterval,r.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof n?n:{}},enabled:!!((s.enabled??!0)&&("object"==typeof n?n.enabled:n)),onBlockNumber(e){m.setQueryData(h.queryKey,e)}}),(0,i.aM)({...s,...h})}}},function(e){e.O(0,[1664,7221,7548,1502,4637,9871,5112,2888,9774,179],function(){return e(e.s=87869)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6700],{54889:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov",function(){return t(7263)}])},34426:function(e,s,t){"use strict";t.d(s,{Z:function(){return o}});var n=t(85893),l=t(67294),r=t(23432),a=t(93461),c=t(92321),i=t(89469),x=t(86501);function o(e){let{tokenAddress:s,tokenSymbol:t,tokenDecimals:o,tokenImage:d}=e,[u,m]=(0,l.useState)(!1),{isConnected:f}=(0,c.m)(),{data:h}=(0,i.p)(),j=async()=>{if(!f){alert("请先连接你的钱包");return}m(!0);try{if(!h){alert("无法获取钱包客户端");return}await h.request({method:"wallet_watchAsset",params:{type:"ERC20",options:{address:s,symbol:t,decimals:o,image:d}}})?(console.log("代币已添加到 MetaMask 钱包"),x.ZP.success("代币已成功添加到 MetaMask 钱包")):(console.log("用户拒绝添加代币"),x.ZP.error("用户拒绝添加代币"))}catch(e){console.error("添加代币失败:",e),x.ZP.error("添加代币失败，请检查控制台以获取更多信息")}finally{m(!1)}};return(0,n.jsx)("button",{onClick:j,disabled:u,className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",children:u?(0,n.jsx)(r.Z,{className:"h-4 w-4 animate-spin"}):(0,n.jsx)(a.Z,{className:"h-4 w-4 text-gray-500"})})}},27460:function(e,s,t){"use strict";var n=t(85893),l=t(86501),r=t(74855),a=t(18289),c=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0,showAddress:i=!0}=e;return(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[i&&(0,n.jsx)("span",{className:"text-xs text-gray-500",children:(0,c.Vu)(s)}),t&&(0,n.jsx)(r.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?l.ZP.success("复制成功"):l.ZP.error("复制失败")},children:(0,n.jsx)("button",{className:"flex items-center justify-center p-1 rounded hover:bg-gray-200 focus:outline-none",onClick:e=>{e.preventDefault(),e.stopPropagation()},"aria-label":"复制地址",children:(0,n.jsx)(a.Z,{className:"h-4 w-4 text-gray-500"})})})]})}},74089:function(e,s,t){"use strict";var n=t(85893),l=t(67294),r=t(91529);s.Z=e=>{let{initialTimeLeft:s}=e,[t,a]=(0,l.useState)(s);(0,l.useEffect)(()=>{if(s<=0)return;a(s);let e=setInterval(()=>{a(s=>s<=1?(clearInterval(e),window.location.reload(),0):s-1)},1e3);return()=>{clearInterval(e)}},[s]);let c=(0,r.ZC)(t);return(0,n.jsx)(n.Fragment,{children:c})}},7191:function(e,s,t){"use strict";var n=t(85893);t(67294);var l=t(3125),r=t(74089);s.Z=e=>{let{currentRound:s,roundName:t}=e,{data:a}=(0,l.O)(),c=Number("100")||0,i=Number("12")||0,x=a?c-Number(a)%c:0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h1",{className:"text-base text-center font-bold",children:[t,"（第 ",(0,n.jsx)("span",{className:"text-red-500",children:Number(null!=s?s:0n)})," 轮）"]}),(0,n.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,n.jsx)(r.Z,{initialTimeLeft:x>0?x*i:0})]})]})}},18308:function(e,s,t){"use strict";var n=t(85893),l=t(67294),r=t(92321),a=t(27245),c=t(41664),i=t.n(c),x=t(7080),o=t(87250),d=t(93778),u=t(91529),m=t(91318),f=t(7191);s.Z=e=>{let{currentRound:s,showBtn:t=!0}=e,{token:c}=(0,l.useContext)(d.M)||{},{address:h}=(0,r.m)(),{votesNumByAccount:j,isPending:g,error:N}=(0,x.VI)(null==c?void 0:c.address,s,h||""),{scoreByVerifier:b,isPending:v,error:p}=(0,o.w3)(null==c?void 0:c.address,s,h||""),y=g||v?BigInt(0):j-b;return(0,n.jsxs)("div",{className:"flex flex-col items-center bg-white py-4",children:[(0,n.jsx)(f.Z,{currentRound:s,roundName:"验证轮"}),(0,n.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投验证票"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:v?(0,n.jsx)(m.Z,{}):(0,u.LH)(b||BigInt(0))})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余验证票"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:g||v?(0,n.jsx)(m.Z,{}):(0,u.LH)(y)})]})]}),t&&(g||v?(0,n.jsx)(m.Z,{}):j>b?(0,n.jsx)(i(),{href:"/verify",className:"w-1/2",children:(0,n.jsx)(a.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去验证"})}):(0,n.jsx)("span",{className:"text-gray-500 text-sm",children:"无剩余验证票"}))]})}},68789:function(e,s,t){"use strict";var n=t(85893),l=t(67294),r=t(41664),a=t.n(r),c=t(93778),i=t(27460),x=t(34426);s.Z=e=>{let{showGovernanceLink:s=!1}=e,t=(0,l.useContext)(c.M);if(!t||!t.token)return(0,n.jsx)("div",{className:"text-center text-error",children:"Token information is not available."});let{token:r}=t;return(0,n.jsxs)("div",{className:"flex items-center mb-4",children:[(0,n.jsx)("div",{className:"mr-2",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"font-bold text-2xl text-yellow-500",children:"$"}),(0,n.jsx)("span",{className:"font-bold text-2xl mr-2",children:r.symbol}),(0,n.jsx)(i.Z,{address:r.address}),(0,n.jsx)(x.Z,{tokenAddress:null==r?void 0:r.address,tokenSymbol:(null==r?void 0:r.symbol)||"",tokenDecimals:(null==r?void 0:r.decimals)||0})]})}),s&&(0,n.jsx)(a(),{href:"/gov",className:"text-blue-400 text-sm hover:underline ml-auto",children:"参与治理>>"})]})}},7263:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var n=t(85893),l=t(35337),r=t(7080),a=t(67294),c=t(92180),i=t(77156),x=t(93778),o=t(91529),d=t(68789),u=t(18303),m=()=>{let{token:e}=(0,a.useContext)(x.M)||{},{govVotesNum:s,isPending:t}=(0,c.kc)(null==e?void 0:e.address),{totalSupply:l,isPending:r}=(0,i.A5)(null==e?void 0:e.stTokenAddress);return(0,n.jsxs)("div",{className:"p-6 bg-white ",children:[(0,n.jsx)(d.Z,{}),(0,n.jsxs)("div",{className:"flex w-full justify-center space-x-20 mb-4",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"总治理票"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:t?"Loading...":(0,o.LH)(s||BigInt(0))})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"代币质押量"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:r?"Loading...":(0,o.LH)(l||BigInt(0))})]})]}),(0,n.jsx)("div",{className:"w-full flex flex-col items-center space-y-4 bg-gray-100 rounded p-4",children:(0,n.jsx)(u.Z,{})})]})},f=t(92321),h=t(91318),j=t(41664),g=t.n(j),N=t(27245),b=()=>{let{token:e}=(0,a.useContext)(x.M)||{},{address:s}=(0,f.m)(),{govVotes:t,stAmount:l,isPending:r,error:i}=(0,c.L)((null==e?void 0:e.address)||"",s||"");return(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-6 bg-white  mt-4",children:[(0,n.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的治理票数"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:r?(0,n.jsx)(h.Z,{}):(0,o.LH)(t||BigInt(0))})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的质押数"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:r?(0,n.jsx)(h.Z,{}):(0,o.LH)(l||BigInt(0))})]})]}),(0,n.jsx)(g(),{href:"/gov/stake",className:"w-1/2",children:(0,n.jsx)(N.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去质押"})})]})},v=t(7191),p=e=>{let{currentRound:s}=e,{token:t}=(0,a.useContext)(x.M)||{},{address:l}=(0,f.m)(),{validGovVotes:i,isPending:d}=(0,c.Ty)((null==t?void 0:t.address)||"",l||""),{votesNumByAccount:u,isPending:m}=(0,r.VI)((null==t?void 0:t.address)||"",s,l||"");return console.log("validGovVotes",i),console.log("votesNumByAccount",u),(0,n.jsxs)("div",{className:"flex flex-col items-center p-6 bg-white mt-4 mb-4",children:[(0,n.jsx)(v.Z,{currentRound:s,roundName:"投票轮"}),(0,n.jsxs)("div",{className:"flex w-full justify-center space-x-20 my-4",children:[(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投票数"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:m?(0,n.jsx)(h.Z,{}):(0,o.LH)(u||BigInt(0))})]}),(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余票数"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:d||m?(0,n.jsx)(h.Z,{}):(0,o.LH)(i-u||BigInt(0))})]})]}),d||m?(0,n.jsx)(h.Z,{}):i>u?(0,n.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,n.jsx)(g(),{href:"/vote/actions4submit",children:(0,n.jsx)(N.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去推举"})}),(0,n.jsx)(g(),{href:"/vote",children:(0,n.jsx)(N.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去投票"})})]}):(0,n.jsxs)("div",{className:"flex justify-center space-x-6",children:[(0,n.jsx)(g(),{href:"/vote/actions4submit",children:(0,n.jsx)(N.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去推举"})}),(0,n.jsx)(N.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"去投票"})]})]})},y=t(18308),w=()=>{let{currentRound:e}=(0,r.Bk)();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{title:"治理首页"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)(m,{}),(0,n.jsx)(b,{}),(0,n.jsx)(p,{currentRound:e}),(0,n.jsx)(y.Z,{currentRound:e>2?e-2n:0n})]})]})}},3125:function(e,s,t){"use strict";t.d(s,{O:function(){return u}});var n=t(30202),l=t(97712),r=t(81946),a=t(36100),c=t(82451),i=t(82002),x=t(37122),o=t(65185),d=t(67294);function u(e={}){let{query:s={},watch:t}=e,u=(0,x.Z)(e),m=(0,n.NL)(),f=(0,i.x)({config:u}),h=e.chainId??f,j=function(e,s={}){return{gcTime:0,async queryFn({queryKey:s}){let{scopeKey:t,...n}=s[1];return await function(e,s={}){let{chainId:t,...n}=s,a=e.getClient({chainId:t});return(0,r.s)(a,l.z,"getBlockNumber")(n)}(e,n)??null},queryKey:function(e={}){return["blockNumber",(0,a.OP)(e)]}(s)}}(u,{...e,chainId:h});return!function(e={}){let{enabled:s=!0,onBlockNumber:t,config:n,...l}=e,a=(0,x.Z)(e),c=(0,i.x)({config:a}),u=e.chainId??c;(0,d.useEffect)(()=>{if(s&&t)return function(e,s){let t,n;let{syncConnectedChain:l=e._internal.syncConnectedChain,...a}=s,c=s=>{t&&t();let n=e.getClient({chainId:s});return t=(0,r.s)(n,o.q,"watchBlockNumber")(a)},i=c(s.chainId);return l&&!s.chainId&&(n=e.subscribe(({chainId:e})=>e,async e=>c(e))),()=>{i?.(),n?.()}}(a,{...l,chainId:u,onBlockNumber:t})},[u,a,s,t,l.onError,l.emitMissed,l.emitOnBegin,l.poll,l.pollingInterval,l.syncConnectedChain])}({...{config:e.config,chainId:e.chainId,..."object"==typeof t?t:{}},enabled:!!((s.enabled??!0)&&("object"==typeof t?t.enabled:t)),onBlockNumber(e){m.setQueryData(j.queryKey,e)}}),(0,c.aM)({...s,...j})}}},function(e){e.O(0,[4846,8424,7526,5714,7250,2180,7716,2888,9774,179],function(){return e(e.s=54889)}),_N_E=e.O()}]);
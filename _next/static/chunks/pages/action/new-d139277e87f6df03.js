(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3594],{84455:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/new",function(){return n(5854)}])},68655:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(31134).Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},23432:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});let a=(0,n(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},64777:function(e,t,n){"use strict";var a=n(85893);t.Z=e=>{let{title:t}=e;return(0,a.jsx)("div",{className:"flex justify-between items-center",children:(0,a.jsx)("h1",{className:"text-lg font-bold",children:t})})}},44576:function(e,t,n){"use strict";var a=n(85893);n(67294);var r=n(23432);t.Z=e=>{let{isLoading:t}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(r.Z,{className:"mx-auto h-8 w-8 animate-spin text-white"}),(0,a.jsx)("p",{className:"mt-2 text-sm font-medium text-white",children:"Loading"})]})}):null}},91529:function(e,t,n){"use strict";n.d(t,{LH:function(){return s},Vu:function(){return i},bM:function(){return l},vz:function(){return c}});var a=n(21803),r=n(15229);let i=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",s=e=>{let t=l(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(t))},c=e=>{let t=parseInt("18",10);return(0,a.v)(e,t)},l=e=>{let t=parseInt("18",10);return(0,r.b)(e,t)}},5854:function(e,t,n){"use strict";n.r(t);var a=n(85893),r=n(67294),i=n(11163),s=n(27245),c=n(94782),l=n(93778),o=n(91529),u=n(58732),d=n(64777),m=n(44576);t.default=()=>{let e=(0,i.useRouter)(),{submitNewAction:t,isWriting:n,isConfirming:f,isConfirmed:x,writeError:h,writeData:p}=(0,c.Xo)(),{token:w}=(0,r.useContext)(l.M)||{},[b,y]=(0,r.useState)({actionName:"",consensus:"",verificationRule:"",verificationInfoGuide:"",rewardAddressCount:"",maxStake:"",whiteList:""}),v=e=>{y({...b,[e.target.name]:e.target.value})},g=async()=>{let e={maxStake:b.maxStake?(0,o.vz)(b.maxStake):0n,maxRandomAccounts:b.rewardAddressCount?BigInt(b.rewardAddressCount):0n,whiteList:b.whiteList?b.whiteList.split(",").map(e=>e.trim()):[],action:b.actionName,consensus:b.consensus,verificationRule:b.verificationRule,verificationInfoGuide:b.verificationInfoGuide};await t(null==w?void 0:w.address,e)};return(0,r.useEffect)(()=>{x&&e.push("/vote/actions4submit?symbol=".concat(null==w?void 0:w.symbol))},[x,p]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Z,{title:"创建新行动"}),(0,a.jsxs)("div",{className:"max-w-xl mx-auto p-4",children:[(0,a.jsx)(d.Z,{title:"创建新行动"}),(0,a.jsxs)("div",{className:"mt-4 space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"行动名称"}),(0,a.jsx)("input",{type:"text",name:"actionName",value:b.actionName,placeholder:"一句话说明行动",onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"行动共识"}),(0,a.jsx)("input",{type:"text",name:"consensus",value:b.consensus,placeholder:"描述行动所基于的共识",onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 "})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"验证规则"}),(0,a.jsx)("textarea",{name:"verificationRule",value:b.verificationRule,placeholder:"验证者验证的规则",onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"验证提示"}),(0,a.jsx)("input",{type:"text",name:"verificationInfoGuide",value:b.verificationInfoGuide,placeholder:"提示给行动参与者，辅助参与者填写信息",onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"奖励地址数"}),(0,a.jsx)("input",{type:"number",name:"rewardAddressCount",value:b.rewardAddressCount,placeholder:"地址数必须大于0",onChange:v,className:"mt-1 block w-full border border-gray-300 rounded-md p-2 "})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"最大质押"}),(0,a.jsx)("input",{type:"number",name:"maxStake",value:b.maxStake,onChange:v,placeholder:"最大质押数必须大于0",className:"mt-1 block w-full border border-gray-300 rounded-md p-2 "})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"白名单"}),(0,a.jsx)("input",{type:"text",name:"whiteList",value:b.whiteList,onChange:v,placeholder:"不填为不限，或多个地址用逗号分隔",className:"mt-1 block w-full border border-gray-300 rounded-md p-2"})]}),(0,a.jsx)(s.z,{onClick:g,disabled:n||f,className:"mt-4 w-full",children:n||f?"提交中...":"提交"}),(0,a.jsx)("p",{className:"text-greyscale-500 text-sm",children:"发起后，会自动推举该行动到当前投票轮的行动列表 / 本轮已推举或提交过"})]}),h&&(0,a.jsx)("div",{className:"text-red-500 text-center",children:h.message})]}),(0,a.jsx)(m.Z,{isLoading:n||f})]})}},9008:function(e,t,n){e.exports=n(23867)},13876:function(e,t,n){"use strict";n.d(t,{a:function(){return s}});var a=n(66432),r=n(81946),i=n(87831);async function s(e,t){let n;let{abi:s,chainId:c,connector:l,...o}=t;n=t.account?t.account:(await (0,i.e)(e,{chainId:c,connector:l})).account;let u=e.getClient({chainId:c}),d=(0,r.s)(u,a.a,"simulateContract"),{result:m,request:f}=await d({...o,abi:s,account:n});return{chainId:u.chain.id,result:m,request:{__mode:"prepared",...f,chainId:c}}}},96128:function(e,t,n){"use strict";n.d(t,{T:function(){return p}});var a=n(14503),r=n(8998),i=n(33840),s=n(26445),c=n(33639),l=n(87469),o=n(61163),u=n(74688),d=n(93714),m=n(47531),f=n(79524),x=n(76404),h=n(99238);async function p(e,t){let{account:n=e.account,chain:p=e.chain,accessList:w,blobs:b,data:y,gas:v,gasPrice:g,maxFeePerBlobGas:j,maxFeePerGas:N,maxPriorityFeePerGas:k,nonce:C,to:I,value:R,...$}=t;if(!n)throw new r.o({docsPath:"/docs/actions/wallet/sendTransaction"});let _=(0,a.T)(n);try{let n;if((0,m.F)(t),null!==p&&(n=await (0,d.s)(e,f.L,"getChainId")({}),(0,i.q)({currentChainId:n,chain:p})),"local"===_.type){let t=await (0,d.s)(e,x.Z,"prepareTransactionRequest")({account:_,accessList:w,blobs:b,chain:p,chainId:n,data:y,gas:v,gasPrice:g,maxFeePerBlobGas:j,maxFeePerGas:N,maxPriorityFeePerGas:k,nonce:C,parameters:[...x.Q,"sidecars"],to:I,value:R,...$}),a=p?.serializers?.transaction,r=await _.signTransaction(t,{serializer:a});return await (0,d.s)(e,h.p,"sendRawTransaction")({serializedTransaction:r})}let a=e.chain?.formatters?.transactionRequest?.format,r=(a||u.tG)({...(0,o.K)($,{format:a}),accessList:w,blobs:b,chainId:n,data:y,from:_.address,gas:v,gasPrice:g,maxFeePerBlobGas:j,maxFeePerGas:N,maxPriorityFeePerGas:k,nonce:C,to:I,value:R});return await e.request({method:"eth_sendTransaction",params:[r]},{retryCount:0})}catch(e){throw function(e,{docsPath:t,...n}){let a=(()=>{let t=(0,l.k)(e,n);return t instanceof s.cj?e:t})();return new c.mk(a,{docsPath:t,...n})}(e,{...t,account:_,chain:t.chain||void 0})}}},61877:function(e,t,n){"use strict";n.d(t,{n:function(){return s}});var a=n(55629),r=n(93714),i=n(96128);async function s(e,t){let{abi:n,address:s,args:c,dataSuffix:l,functionName:o,...u}=t,d=(0,a.R)({abi:n,args:c,functionName:o});return(0,r.s)(e,i.T,"sendTransaction")({data:`${d}${l?l.replace("0x",""):""}`,to:s,...u})}},33840:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var a=n(80377);function r({chain:e,currentChainId:t}){if(!e)throw new a.Bk;if(t!==e.id)throw new a.Yl({chain:e,currentChainId:t})}},21803:function(e,t,n){"use strict";function a(e,t){let[n,a="0"]=e.split("."),r=n.startsWith("-");if(r&&(n=n.slice(1)),a=a.replace(/(0+)$/,""),0===t)1===Math.round(Number(`.${a}`))&&(n=`${BigInt(n)+1n}`),a="";else if(a.length>t){let[e,r,i]=[a.slice(0,t-1),a.slice(t-1,t),a.slice(t)],s=Math.round(Number(`${r}.${i}`));(a=s>9?`${BigInt(e)+BigInt(1)}0`.padStart(e.length+1,"0"):`${e}${s}`).length>t&&(a=a.slice(1),n=`${BigInt(n)+1n}`),a=a.slice(0,t)}else a=a.padEnd(t,"0");return BigInt(`${r?"-":""}${n}${a}`)}n.d(t,{v:function(){return a}})},83540:function(e,t,n){"use strict";n.d(t,{A:function(){return f}});var a=n(95946),r=n(51973),i=n(23147),s=n(36083),c=n(81946);async function l(e,t){let{chainId:n,timeout:l=0,...o}=t,u=e.getClient({chainId:n}),d=(0,c.s)(u,r.e,"waitForTransactionReceipt"),m=await d({...o,timeout:l});if("reverted"===m.status){let e=(0,c.s)(u,i.f,"getTransaction"),t=await e({hash:m.transactionHash}),n=(0,c.s)(u,s.R,"call"),r=await n({...t,data:t.input,gasPrice:"eip1559"!==t.type?t.gasPrice:void 0,maxFeePerGas:"eip1559"===t.type?t.maxFeePerGas:void 0,maxPriorityFeePerGas:"eip1559"===t.type?t.maxPriorityFeePerGas:void 0});throw Error(r?.data?(0,a.rR)(`0x${r.data.substring(138)}`):"unknown reason")}return{...m,chainId:u.chain.id}}var o=n(36100),u=n(45631),d=n(82002),m=n(80666);function f(e={}){let{hash:t,query:n={}}=e,a=(0,m.Z)(e),r=(0,d.x)({config:a}),i=function(e,t={}){return{async queryFn({queryKey:n}){let{hash:a,...r}=n[1];if(!a)throw Error("hash is required");return l(e,{...r,onReplaced:t.onReplaced,hash:a})},queryKey:function(e={}){let{onReplaced:t,...n}=e;return["waitForTransactionReceipt",(0,o.OP)(n)]}(t)}}(a,{...e,chainId:e.chainId??r}),s=!!(t&&(n.enabled??!0));return(0,u.aM)({...n,...i,enabled:s})}},71366:function(e,t,n){"use strict";n.d(t,{S:function(){return d}});var a=n(98029),r=n(61877),i=n(81946),s=n(52425),c=n(87831),l=n(13876);async function o(e,t){let n,a;let{account:o,chainId:u,connector:d,__mode:m,...f}=t;n="object"==typeof o&&o?.type==="local"?e.getClient({chainId:u}):await (0,c.e)(e,{account:o??void 0,chainId:u,connector:d});let{connector:x}=(0,s.D)(e);if("prepared"===m||x?.supportsSimulation)a=f;else{let{request:t}=await (0,l.a)(e,{...f,account:o,chainId:u});a=t}let h=(0,i.s)(n,r.n,"writeContract");return await h({...a,...o?{account:o}:{},chain:u?{id:u}:null})}var u=n(80666);function d(e={}){var t;let{mutation:n}=e,r=(t=(0,u.Z)(e),{mutationFn:e=>o(t,e),mutationKey:["writeContract"]}),{mutate:i,mutateAsync:s,...c}=(0,a.D)({...n,...r});return{...c,writeContract:i,writeContractAsync:s}}}},function(e){e.O(0,[1502,2888,9774,179],function(){return e(e.s=84455)}),_N_E=e.O()}]);
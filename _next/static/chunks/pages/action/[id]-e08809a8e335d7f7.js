(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{44104:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/[id]",function(){return t(49637)}])},20725:function(e,s,t){"use strict";var l=t(85893),n=t(67294),r=t(94782),i=t(93778),a=t(91529),d=t(27460),c=t(42083);s.Z=e=>{var s;let{actionId:t,round:o,showSubmitter:x}=e,{token:m}=(0,n.useContext)(i.M)||{},{actionInfo:u,isPending:h,error:v}=(0,r.dI)(null==m?void 0:m.address,t),{actionSubmits:j,isPending:N,error:f}=(0,r.WZ)(null==m?void 0:m.address,x?o:0n),g=(null==j?void 0:null===(s=j.find(e=>e.actionId==Number(t)))||void 0===s?void 0:s.submitter)||"N/A";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2 border-t border-greyscale-100",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==u?void 0:u.head.id.toString()]}),(0,l.jsx)("span",{className:"text-xl font-bold text-black",children:null==u?void 0:u.body.action})]}),(0,l.jsx)("div",{className:"mt-1",children:(0,l.jsx)("span",{className:"text-greyscale-600",children:null==u?void 0:u.body.consensus})}),(0,l.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,l.jsx)(d.Z,{address:null==u?void 0:u.head.author})]}),x&&(0,l.jsxs)("div",{className:"flex items-center",children:["推举人 ",(0,l.jsx)(d.Z,{address:g})]})]})]}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"参与资产上限"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(0,a.LH)((null==u?void 0:u.body.maxStake)||BigInt(0))})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"随机奖励地址数"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.maxRandomAccounts.toString())||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationRule)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"验证信息填写指引"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationInfoGuide)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,l.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==u?void 0:u.body.whiteList.length)?u.body.whiteList.map((e,s)=>(0,l.jsx)("span",{className:"flex items-center mr-2",children:(0,l.jsx)(d.Z,{address:e})},s)):"无限制"})]})]}),(h||x&&N)&&(0,l.jsx)(c.Z,{}),(v||x&&f)&&(0,l.jsx)("div",{className:"text-center text-sm text-red-500",children:(null==v?void 0:v.message)||(null==f?void 0:f.message)})]})]})}},91529:function(e,s,t){"use strict";t.d(s,{LH:function(){return i},Vu:function(){return r},bM:function(){return d},vz:function(){return a}});var l=t(21803),n=t(15229);let r=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",i=e=>{let s=d(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(s))},a=e=>{let s=parseInt("18",10);return(0,l.v)(e,s)},d=e=>{let s=parseInt("18",10);return(0,n.b)(e,s)}},49637:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return I}});var l=t(85893),n=t(67294),r=t(11163),i=t(58732),a=t(20725),d=t(27245),c=t(86501),o=t(92321),x=t(78543),m=t(94782),u=t(93778),h=t(42083),v=e=>{let{actionId:s,submitted:t,onRoundChange:i}=e,{token:a}=(0,n.useContext)(u.M)||{},{chain:v}=(0,o.m)(),j=(0,r.useRouter)(),{currentRound:N,isPending:f,error:g}=(0,m.Bk)();(0,n.useEffect)(()=>{i&&"function"==typeof i&&i(N)},[N,i]);let{submit:b,isWriting:p,isConfirming:y,isConfirmed:w,writeError:I}=(0,m.qd)();return(0,n.useEffect)(()=>{w&&!I&&(c.Am.success("推举成功",{duration:2e3}),setTimeout(()=>{j.push("/vote?symbol=".concat(null==a?void 0:a.symbol))},2e3))},[w,I]),(0,l.jsxs)("div",{className:"flex flex-col items-center my-4",children:[t||w?(0,l.jsx)(d.z,{className:"w-1/2",disabled:!0,children:"已推举"}):(0,l.jsx)(d.z,{onClick:()=>{!(0,x.S)(v)||p||y||b(null==a?void 0:a.address,s)},className:"w-1/2",children:p||y?(0,l.jsx)(h.Z,{}):"推举本行动"}),I?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",I.shortMessage||I.message]}):null]})},j=t(92180),N=t(7080),f=t(91529),g=e=>{let{actionId:s,onRoundChange:t}=e,{address:r}=(0,o.m)(),{token:i}=(0,n.useContext)(u.M)||{},{currentRound:a,isPending:c,error:x}=(0,N.Bk)();(0,n.useEffect)(()=>{t&&"function"==typeof t&&t(a)},[a,t]);let{validGovVotes:m,isPending:v}=(0,j.Ty)(null==i?void 0:i.address,r),{votesNumByAccountByActionId:g,isPending:b,error:p}=(0,N.Ol)(null==i?void 0:i.address,a,r,s),{vote:y,isWriting:w,isConfirming:I,isConfirmed:C,writeError:E}=(0,N.rv)();return(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-6 mb-4",children:[(0,l.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我的已投票数"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:b?(0,l.jsx)(h.Z,{}):(0,f.LH)(g/10000n)})]}),(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我的剩余票数"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:v||b?(0,l.jsx)(h.Z,{}):(0,f.LH)(m-g)})]})]}),b||g?(0,l.jsx)(d.z,{className:"w-1/2",disabled:!0,children:"您已投票"}):(0,l.jsx)(d.z,{className:"w-1/2",onClick:()=>{w||I||y(null==i?void 0:i.address,[s],[m])},disabled:w||I,children:w||I?(0,l.jsx)(h.Z,{}):"将100%票投给此行动"}),p?(0,l.jsxs)("p",{className:"text-red-500",children:["Error:",p.shortMessage||p.message]}):null,E?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",E.shortMessage||E.message]}):null]})},b=t(41664),p=t.n(b),y=t(5028),w=e=>{let{actionId:s,onRoundChange:t}=e,{address:r}=(0,o.m)(),{token:i}=(0,n.useContext)(u.M)||{},{currentRound:a,isPending:c,error:x}=(0,y.Bk)();(0,n.useEffect)(()=>{t&&"function"==typeof t&&t(a)},[a,t]);let{joinedAmountByActionIdByAccount:m,isPending:v,error:j}=(0,y.X9)((null==i?void 0:i.address)||"",a,s,r||""),{joinedAmountByActionId:N,isPending:g,error:b}=(0,y.PL)((null==i?void 0:i.address)||"",a,s),w=m&&m>0&&N&&N>0,I=w?100*Number(m/N)+"%":"0%",{verificationInfo:C,isPending:E,error:P}=(0,y.Y5)((null==i?void 0:i.address)||"",a,s,r||"",w);return j?(console.error("errorJoinedAmountByAccount",j),(0,l.jsxs)("div",{children:["发生错误: ",j.message]})):b?(console.error("errorJoinedAmount",b),(0,l.jsxs)("div",{children:["发生错误: ",b.message]})):P?(console.error("errorVerificationInfo",P),(0,l.jsxs)("div",{children:["发生错误: ",P.message]})):(0,l.jsxs)("div",{className:"flex flex-col items-center px-6 pt-1 pb-4",children:[w&&(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我参与本行动的代币"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:g?(0,l.jsx)(h.Z,{}):(0,f.LH)(m||BigInt(0))})]}),(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"所占比例"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:I})]})]}),w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary py-0",disabled:!0,children:"您已加入"}),(0,l.jsx)("div",{className:"flex flex-col items-center mt-2",children:(0,l.jsx)("div",{className:"text-sm text-greyscale-600",children:E?"加载中...":"我的信息：".concat(C)})})]}):(0,l.jsx)(d.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(p(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==i?void 0:i.symbol),children:"参与行动"})})]})},I=()=>{let{id:e,type:s,submitted:t}=(0,r.useRouter)().query,[d,c]=(0,n.useState)(null),o=e=>{c(e)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.Z,{title:"行动详情"}),(0,l.jsxs)("main",{className:"flex-grow",children:["submit"===s&&(0,l.jsx)(v,{actionId:BigInt(e||0),submitted:"true"===t,onRoundChange:o}),"vote"===s&&(0,l.jsx)(g,{actionId:BigInt(e||0),onRoundChange:o}),("join"===s||void 0===s)&&(0,l.jsx)(w,{actionId:BigInt(e||0),onRoundChange:o}),(0,l.jsx)(a.Z,{actionId:BigInt(e||0),round:BigInt(d||0),showSubmitter:"submit"!==s})]})]})}},78543:function(e,s,t){"use strict";t.d(s,{S:function(){return n}});var l=t(86501);let n=e=>!!e||(l.Am.error("请先将钱包链接 ".concat("sepolia")),!1)}},function(e){e.O(0,[1664,530,1502,2180,7295,9871,2888,9774,179],function(){return e(e.s=44104)}),_N_E=e.O()}]);
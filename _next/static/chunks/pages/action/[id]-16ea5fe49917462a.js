(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{44104:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/[id]",function(){return t(89703)}])},20725:function(e,s,t){"use strict";var l=t(85893),r=t(67294),n=t(94782),a=t(93778),i=t(91529),c=t(27460),d=t(91318);s.Z=e=>{var s;let{actionId:t,round:x,showSubmitter:o}=e,{token:u}=(0,r.useContext)(a.M)||{},{actionInfo:m,isPending:h,error:j}=(0,n.dI)(null==u?void 0:u.address,t),{actionSubmits:g,isPending:f,error:N}=(0,n.WZ)(null==u?void 0:u.address,o?x:0n),v=(null==g?void 0:null===(s=g.find(e=>e.actionId==Number(t)))||void 0===s?void 0:s.submitter)||"N/A";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white mb-4",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("span",{className:"text-sm text-gray-500",children:["No.",null==m?void 0:m.head.id.toString()]}),(0,l.jsx)("span",{className:"text-2xl font-bold text-black",children:null==m?void 0:m.body.action})]}),(0,l.jsx)("div",{className:"mt-2",children:(0,l.jsx)("span",{className:"text-gray-600",children:null==m?void 0:m.body.consensus})}),(0,l.jsxs)("div",{className:"mt-2 text-xs text-gray-500 flex justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,l.jsx)(c.Z,{address:null==m?void 0:m.head.author})]}),o&&(0,l.jsxs)("div",{className:"flex items-center",children:["推举人 ",(0,l.jsx)(c.Z,{address:v})]})]})]}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 bg-white",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-base text-gray-500",children:"参与资产上限"}),(0,l.jsx)("p",{className:"text-lg",children:(0,i.LH)((null==m?void 0:m.body.maxStake)||BigInt(0))})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-base text-gray-500",children:"随机奖励地址数"}),(0,l.jsx)("p",{className:"text-lg",children:(null==m?void 0:m.body.maxRandomAccounts.toString())||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-base text-gray-500",children:"验证规则"}),(0,l.jsx)("p",{className:"text-lg",children:(null==m?void 0:m.body.verificationRule)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-base text-gray-500",children:"验证信息填写指引"}),(0,l.jsx)("p",{className:"text-lg",children:(null==m?void 0:m.body.verificationInfoGuide)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-base text-gray-500",children:"白名单"}),(0,l.jsx)("p",{className:"text-lg flex flex-wrap items-center",children:(null==m?void 0:m.body.whiteList.length)?m.body.whiteList.map((e,s)=>(0,l.jsx)("span",{className:"flex items-center mr-2",children:(0,l.jsx)(c.Z,{address:e})},s)):"无限制"})]})]}),(h||o&&f)&&(0,l.jsx)(d.Z,{}),(j||o&&N)&&(0,l.jsx)("div",{className:"text-center text-sm text-red-500",children:(null==j?void 0:j.message)||(null==N?void 0:N.message)})]})]})}},27460:function(e,s,t){"use strict";var l=t(85893),r=t(86501),n=t(74855),a=t(45356),i=t(91529);s.Z=e=>{let{address:s,showCopyButton:t=!0}=e;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("span",{className:"text-xs text-gray-500",children:(0,i.Vu)(s)}),t&&(0,l.jsx)(n.CopyToClipboard,{text:s,onCopy:(e,s)=>{s?r.ZP.success("复制成功"):r.ZP.error("复制失败")},children:(0,l.jsx)("button",{className:"",onClick:e=>{e.preventDefault(),e.stopPropagation()},children:(0,l.jsx)(a.Z,{className:"h-4 w-4 text-xs text-gray-500"})})})]})}},74089:function(e,s,t){"use strict";var l=t(85893),r=t(67294),n=t(91529);s.Z=e=>{let{initialTimeLeft:s}=e,[t,a]=(0,r.useState)(s),i=(0,r.useRef)(null),c=(0,r.useRef)(!1);(0,r.useEffect)(()=>(c.current=!0,s<=0)?void 0:(a(s),i.current&&clearInterval(i.current),i.current=setInterval(()=>{c.current&&a(e=>e<=1?(clearInterval(i.current),console.log("1.prevTime",e),0):(console.log("2.prevTime",e),e-1))},1e3),()=>{c.current=!1,i.current&&clearInterval(i.current)}),[s]);let d=(0,n.ZC)(t);return(0,l.jsx)(l.Fragment,{children:d})}},7191:function(e,s,t){"use strict";var l=t(85893);t(67294);var r=t(3125),n=t(74089),a=t(34155);s.Z=e=>{let{currentRound:s,roundName:t}=e,{data:i}=(0,r.O)(),c=Number("100")||0,d=Number(a.env.NEXT_PUBLIC_BLOCK_TIME)||0,x=i?c-Number(i)%c:0;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("h1",{className:"text-base text-center font-bold",children:[t,"（第 ",(0,l.jsx)("span",{className:"text-red-500",children:Number(null!=s?s:0n)})," 轮）"]}),(0,l.jsxs)("span",{className:"text-sm text-gray-400 mt-1 pt-0",children:["本轮剩余：",(0,l.jsx)(n.Z,{initialTimeLeft:x>0?x*d:0})]})]})}},89703:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return C}});var l=t(85893),r=t(67294),n=t(11163),a=t(35337),i=t(20725),c=t(86501),d=t(27245),x=t(94782),o=t(93778),u=t(91318),m=t(7191),h=e=>{let{actionId:s,submitted:t,onRoundChange:a}=e,{token:i}=(0,r.useContext)(o.M)||{},h=(0,n.useRouter)(),{currentRound:j,isPending:g,error:f}=(0,x.Bk)();(0,r.useEffect)(()=>{a&&"function"==typeof a&&a(j)},[j,a]);let{submit:N,isWriting:v,isConfirming:b,isConfirmed:p,writeError:y}=(0,x.qd)();return(0,r.useEffect)(()=>{p&&!y&&(c.Am.success("推举成功",{duration:2e3}),setTimeout(()=>{h.push("/vote")},2e3))},[p,y]),(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4 ",children:[g?(0,l.jsx)(u.Z,{}):(0,l.jsx)(m.Z,{currentRound:j,roundName:"投票轮"}),t||p?(0,l.jsx)(d.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"已推举"}):(0,l.jsx)(d.z,{onClick:()=>{v||b||N(null==i?void 0:i.address,s)},className:"w-1/2 bg-blue-600 hover:bg-blue-700",children:v||b?(0,l.jsx)(u.Z,{}):"推举"}),y?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",y.shortMessage||y.message]}):null]})},j=t(92321),g=t(92180),f=t(7080),N=t(91529),v=e=>{let{actionId:s,onRoundChange:t}=e,{address:n}=(0,j.m)(),{token:a}=(0,r.useContext)(o.M)||{},{currentRound:i,isPending:c,error:x}=(0,f.Bk)();(0,r.useEffect)(()=>{t&&"function"==typeof t&&t(i)},[i,t]);let{validGovVotes:h,isPending:v}=(0,g.Ty)(null==a?void 0:a.address,n),{votesNumByAccountByActionId:b,isPending:p,error:y}=(0,f.Ol)(null==a?void 0:a.address,i,n,s),{vote:w,isWriting:Z,isConfirming:I,isConfirmed:C,writeError:E}=(0,f.rv)();return(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-8 bg-white mb-4  ",children:[c?(0,l.jsx)(u.Z,{}):(0,l.jsx)(m.Z,{currentRound:i,roundName:"投票轮"}),(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的已投票数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:p?(0,l.jsx)(u.Z,{}):(0,N.LH)(b||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我的剩余票数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:v||p?(0,l.jsx)(u.Z,{}):(0,N.LH)(h-b)})]})]}),p||b?(0,l.jsx)("div",{className:"flex flex-col items-center",children:(0,l.jsx)(d.z,{className:"w-1/2 bg-gray-400 cursor-not-allowed",children:"您已投票"})}):(0,l.jsx)(d.z,{className:"w-1/2 bg-blue-600 hover:bg-blue-700",onClick:()=>{Z||I||w(null==a?void 0:a.address,[s],[h])},disabled:Z||I,children:Z||I?(0,l.jsx)(u.Z,{}):"投100%票"}),y?(0,l.jsxs)("p",{className:"text-red-500",children:["Error:",y.shortMessage||y.message]}):null,E?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",E.shortMessage||E.message]}):null]})},b=t(41664),p=t.n(b),y=t(5028),w=e=>{let{actionId:s,onRoundChange:t}=e,{address:n}=(0,j.m)(),{token:a}=(0,r.useContext)(o.M)||{},{currentRound:i,isPending:c,error:x}=(0,y.Bk)();(0,r.useEffect)(()=>{t&&"function"==typeof t&&t(i)},[i,t]);let{joinedAmountByActionIdByAccount:h,isPending:g,error:f}=(0,y.X9)((null==a?void 0:a.address)||"",i,s,n||""),{joinedAmountByActionId:v,isPending:b,error:w}=(0,y.PL)((null==a?void 0:a.address)||"",i,s),Z=h&&h>0&&v&&v>0,I=Z?100*Number(h/v)+"%":"0%",{verificationInfo:C,isPending:E,error:P}=(0,y.Y5)((null==a?void 0:a.address)||"",i,s,n||"",Z);return(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4  ",children:[c?(0,l.jsx)(u.Z,{}):(0,l.jsx)(m.Z,{currentRound:i,roundName:"行动轮"}),(0,l.jsxs)("div",{className:"flex w-full justify-center space-x-20",children:[(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"我参与的代币数"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:b?(0,l.jsx)(u.Z,{}):(0,N.LH)(h||BigInt(0))})]}),(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)("span",{className:"text-sm text-gray-500",children:"所占比例"}),(0,l.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:I})]})]}),Z?(0,l.jsxs)("div",{className:"flex flex-col items-center",children:[(0,l.jsx)(d.z,{disabled:!0,className:"w-full bg-gray-400 cursor-not-allowed",children:"您已参与"}),(0,l.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:E?"加载中...":C})]}):(0,l.jsx)(p(),{href:"/acting/join?id=".concat(s),className:"w-1/2",children:(0,l.jsx)(d.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"参与行动"})})]})},Z=t(87250),I=e=>{let{actionId:s,onRoundChange:t}=e,{token:n}=(0,r.useContext)(o.M)||{},{address:a}=(0,j.m)(),{currentRound:i,isPending:c,error:x}=(0,Z.Bk)();(0,r.useEffect)(()=>{t&&"function"==typeof t&&t(i)},[i,t]);let{scoreByVerifierByActionId:h,isPending:g,error:f}=(0,Z.Tl)(null==n?void 0:n.address,i,a,s);return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white mb-4 ",children:[c?(0,l.jsx)(u.Z,{}):(0,l.jsx)(m.Z,{currentRound:i,roundName:"验证轮"}),g?(0,l.jsx)(u.Z,{}):h?(0,l.jsx)(d.z,{className:"w-full bg-gray-400 cursor-not-allowed",children:"已验证"}):(0,l.jsx)(p(),{href:"/verify/".concat(s),className:"w-1/2",children:(0,l.jsx)(d.z,{className:"w-full bg-blue-600 hover:bg-blue-700",children:"去验证"})}),x&&(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",x.shortMessage||x.message]}),f&&(0,l.jsxs)("p",{className:"text-red-500",children:["Error:"," ",f.shortMessage||f.message]})]})})},C=()=>{let{id:e,type:s,submitted:t}=(0,n.useRouter)().query,[c,d]=(0,r.useState)(null),x=e=>{d(e)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.Z,{title:"行动详情"}),(0,l.jsxs)("main",{className:"flex-grow",children:["submit"===s&&(0,l.jsx)(h,{actionId:BigInt(e||0),submitted:"true"===t,onRoundChange:x}),"vote"===s&&(0,l.jsx)(v,{actionId:BigInt(e||0),onRoundChange:x}),("join"===s||void 0===s)&&(0,l.jsx)(w,{actionId:BigInt(e||0),onRoundChange:x}),"verify"===s&&(0,l.jsx)(I,{actionId:BigInt(e||0),onRoundChange:x}),(0,l.jsx)(i.Z,{actionId:BigInt(e||0),round:BigInt(c||0),showSubmitter:"submit"!==s})]})]})}}},function(e){e.O(0,[4784,8424,3980,7140,3601,7080,765,7250,2888,9774,179],function(){return e(e.s=44104)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[986],{44104:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/action/[id]",function(){return t(49637)}])},20725:function(e,s,t){"use strict";var l=t(85893),n=t(67294),i=t(94782),r=t(93778),a=t(91529),d=t(27460),c=t(42083);s.Z=e=>{var s;let{actionId:t,round:o,showSubmitter:x}=e,{token:m}=(0,n.useContext)(r.M)||{},{actionInfo:u,isPending:h,error:j}=(0,i.dI)(null==m?void 0:m.address,t),{actionSubmits:v,isPending:N,error:f}=(0,i.WZ)(null==m?void 0:m.address,x?o:0n),g=(null==v?void 0:null===(s=v.find(e=>e.actionId==Number(t)))||void 0===s?void 0:s.submitter)||"N/A";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2 border-t border-greyscale-100",children:[(0,l.jsxs)("div",{className:"flex flex-col",children:[(0,l.jsxs)("span",{className:"text-sm text-greyscale-500",children:["No.",null==u?void 0:u.head.id.toString()]}),(0,l.jsx)("span",{className:"text-xl font-bold text-black",children:null==u?void 0:u.body.action})]}),(0,l.jsx)("div",{className:"mt-1",children:(0,l.jsx)("span",{className:"text-greyscale-600",children:null==u?void 0:u.body.consensus})}),(0,l.jsxs)("div",{className:"mt-0 text-xs text-greyscale-500 flex justify-between",children:[(0,l.jsxs)("div",{className:"flex items-center",children:["创建人 ",(0,l.jsx)(d.Z,{address:null==u?void 0:u.head.author})]}),x&&(0,l.jsxs)("div",{className:"flex items-center",children:["推举人 ",(0,l.jsx)(d.Z,{address:g})]})]})]}),(0,l.jsxs)("div",{className:"max-w-4xl mx-auto p-6 pt-4 pb-2",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"参与资产上限"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(0,a.LH)((null==u?void 0:u.body.maxStake)||BigInt(0))})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"随机奖励地址数"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.maxRandomAccounts.toString())||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"验证规则"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationRule)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"验证信息填写指引"}),(0,l.jsx)("p",{className:"text-greyscale-500",children:(null==u?void 0:u.body.verificationInfoGuide)||"-"})]}),(0,l.jsxs)("div",{className:"mb-4",children:[(0,l.jsx)("h3",{className:"text-sm font-bold",children:"白名单"}),(0,l.jsx)("p",{className:"text-greyscale-500 flex flex-wrap items-center",children:(null==u?void 0:u.body.whiteList.length)?u.body.whiteList.map((e,s)=>(0,l.jsx)("span",{className:"flex items-center mr-2",children:(0,l.jsx)(d.Z,{address:e})},s)):"无限制"})]})]}),(h||x&&N)&&(0,l.jsx)(c.Z,{}),(j||x&&f)&&(0,l.jsx)("div",{className:"text-center text-sm text-red-500",children:(null==j?void 0:j.message)||(null==f?void 0:f.message)})]})]})}},91529:function(e,s,t){"use strict";t.d(s,{LH:function(){return r},Vu:function(){return i},bM:function(){return d},vz:function(){return a}});var l=t(21803),n=t(15229);let i=e=>e?"".concat(e.substring(0,6),"...").concat(e.substring(e.length-4)):"",r=e=>{let s=d(e);return new Intl.NumberFormat("en-US",{maximumFractionDigits:2}).format(Number(s))},a=e=>{let s=parseInt("18",10);return(0,l.v)(e,s)},d=e=>{let s=parseInt("18",10);return(0,n.b)(e,s)}},49637:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return w}});var l=t(85893),n=t(67294),i=t(11163),r=t(58732),a=t(20725),d=t(86501),c=t(27245),o=t(94782),x=t(93778),m=t(42083),u=e=>{let{actionId:s,submitted:t,onRoundChange:r}=e,{token:a}=(0,n.useContext)(x.M)||{},u=(0,i.useRouter)(),{currentRound:h,isPending:j,error:v}=(0,o.Bk)();(0,n.useEffect)(()=>{r&&"function"==typeof r&&r(h)},[h,r]);let{submit:N,isWriting:f,isConfirming:g,isConfirmed:b,writeError:p}=(0,o.qd)();return(0,n.useEffect)(()=>{b&&!p&&(d.Am.success("推举成功",{duration:2e3}),setTimeout(()=>{u.push("/vote?symbol=".concat(null==a?void 0:a.symbol))},2e3))},[b,p]),(0,l.jsxs)("div",{className:"flex flex-col items-center my-4",children:[t||b?(0,l.jsx)(c.z,{className:"w-1/2",disabled:!0,children:"已推举"}):(0,l.jsx)(c.z,{onClick:()=>{f||g||N(null==a?void 0:a.address,s)},className:"w-1/2",children:f||g?(0,l.jsx)(m.Z,{}):"推举本行动"}),p?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",p.shortMessage||p.message]}):null]})},h=t(92321),j=t(92180),v=t(7080),N=t(91529),f=e=>{let{actionId:s,onRoundChange:t}=e,{address:i}=(0,h.m)(),{token:r}=(0,n.useContext)(x.M)||{},{currentRound:a,isPending:d,error:o}=(0,v.Bk)();(0,n.useEffect)(()=>{t&&"function"==typeof t&&t(a)},[a,t]);let{validGovVotes:u,isPending:f}=(0,j.Ty)(null==r?void 0:r.address,i),{votesNumByAccountByActionId:g,isPending:b,error:p}=(0,v.Ol)(null==r?void 0:r.address,a,i,s),{vote:y,isWriting:w,isConfirming:I,isConfirmed:C,writeError:E}=(0,v.rv)();return(0,l.jsxs)("div",{className:"flex flex-col items-center space-y-6 p-6 mb-4",children:[(0,l.jsxs)("div",{className:"stats w-full border grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我的已投票数"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:b?(0,l.jsx)(m.Z,{}):(0,N.LH)(g/10000n)})]}),(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我的剩余票数"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:f||b?(0,l.jsx)(m.Z,{}):(0,N.LH)(u-g)})]})]}),b||g?(0,l.jsx)(c.z,{className:"w-1/2",disabled:!0,children:"您已投票"}):(0,l.jsx)(c.z,{className:"w-1/2",onClick:()=>{w||I||y(null==r?void 0:r.address,[s],[u])},disabled:w||I,children:w||I?(0,l.jsx)(m.Z,{}):"将100%票投给此行动"}),p?(0,l.jsxs)("p",{className:"text-red-500",children:["Error:",p.shortMessage||p.message]}):null,E?(0,l.jsxs)("p",{className:"text-red-500",children:["Error: ",E.shortMessage||E.message]}):null]})},g=t(41664),b=t.n(g),p=t(5028),y=e=>{let{actionId:s,onRoundChange:t}=e,{address:i}=(0,h.m)(),{token:r}=(0,n.useContext)(x.M)||{},{currentRound:a,isPending:d,error:o}=(0,p.Bk)();(0,n.useEffect)(()=>{t&&"function"==typeof t&&t(a)},[a,t]);let{joinedAmountByActionIdByAccount:u,isPending:j,error:v}=(0,p.X9)((null==r?void 0:r.address)||"",a,s,i||""),{joinedAmountByActionId:f,isPending:g,error:y}=(0,p.PL)((null==r?void 0:r.address)||"",a,s),w=u&&u>0&&f&&f>0,I=w?100*Number(u/f)+"%":"0%",{verificationInfo:C,isPending:E,error:P}=(0,p.Y5)((null==r?void 0:r.address)||"",a,s,i||"",w);return v?(console.error("errorJoinedAmountByAccount",v),(0,l.jsxs)("div",{children:["发生错误: ",v.message]})):y?(console.error("errorJoinedAmount",y),(0,l.jsxs)("div",{children:["发生错误: ",y.message]})):P?(console.error("errorVerificationInfo",P),(0,l.jsxs)("div",{children:["发生错误: ",P.message]})):(0,l.jsxs)("div",{className:"flex flex-col items-center px-6 pt-1 pb-4",children:[w&&(0,l.jsxs)("div",{className:"stats w-full grid grid-cols-2 divide-x-0",children:[(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"我参与本行动的代币"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:g?(0,l.jsx)(m.Z,{}):(0,N.LH)(u||BigInt(0))})]}),(0,l.jsxs)("div",{className:"stat place-items-center",children:[(0,l.jsx)("div",{className:"stat-title",children:"所占比例"}),(0,l.jsx)("div",{className:"stat-value text-2xl",children:I})]})]}),w?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary py-0",disabled:!0,children:"您已加入"}),(0,l.jsx)("div",{className:"flex flex-col items-center mt-2",children:(0,l.jsx)("div",{className:"text-sm text-greyscale-600",children:E?"加载中...":"我的信息：".concat(C)})})]}):(0,l.jsx)(c.z,{variant:"outline",className:"w-1/2 text-secondary border-secondary",asChild:!0,children:(0,l.jsx)(b(),{href:"/acting/join?id=".concat(s,"&symbol=").concat(null==r?void 0:r.symbol),children:"参与行动"})})]})},w=()=>{let{id:e,type:s,submitted:t}=(0,i.useRouter)().query,[d,c]=(0,n.useState)(null),o=e=>{c(e)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Z,{title:"行动详情"}),(0,l.jsxs)("main",{className:"flex-grow",children:["submit"===s&&(0,l.jsx)(u,{actionId:BigInt(e||0),submitted:"true"===t,onRoundChange:o}),"vote"===s&&(0,l.jsx)(f,{actionId:BigInt(e||0),onRoundChange:o}),("join"===s||void 0===s)&&(0,l.jsx)(y,{actionId:BigInt(e||0),onRoundChange:o}),(0,l.jsx)(a.Z,{actionId:BigInt(e||0),round:BigInt(d||0),showSubmitter:"submit"!==s})]})]})}}},function(e){e.O(0,[1664,530,1502,2180,7295,9871,2888,9774,179],function(){return e(e.s=44104)}),_N_E=e.O()}]);
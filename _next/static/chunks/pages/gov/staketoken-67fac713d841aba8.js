(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7809],{51906:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/staketoken",function(){return n(10703)}])},10703:function(e,s,n){"use strict";n.r(s),n.d(s,{default:function(){return T}});var l=n(85893),r=n(67294),t=n(92321),a=n(93778),i=n(19638),o=n(67068),c=n(7224),d=n(37436),m=n(42083),u=n(86501),x=n(56312),f=n(87536),h=n(1604),j=n(76929),g=n(21774),k=n(27245),v=n(88659),N=n(48105),b=n(91529),p=n(92180),y=n(64777),w=n(44576),A=e=>{let{tokenBalance:s}=e,{address:n,chain:c}=(0,t.m)(),{token:d}=(0,r.useContext)(a.M)||{},{approve:m,isWriting:A,isConfirming:T,isConfirmed:C,writeError:E}=(0,i.yA)(null==d?void 0:d.address),{stakeToken:_,isWriting:S,isConfirming:z,isConfirmed:P,writeError:I}=(0,p.aE)(),B=(0,f.cI)({resolver:(0,x.F)(h.z.object({stakeTokenAmount:h.z.string().refine(e=>""!==e.trim(),{message:"请输入质押数量"}).refine(e=>Number(e)>0,{message:"质押代币数不能为0"}).refine(e=>(0,b.vz)(e)<=s,{message:"质押代币数不能大于持有代币数"}),releasePeriod:h.z.string().default("4")})),defaultValues:{stakeTokenAmount:"",releasePeriod:"4"},mode:"onChange"}),F=async e=>{if((0,N.S)(c))try{await m("0x937cb7ae20B59531085F285F5161e22c4567715f",(0,b.vz)(e.stakeTokenAmount))}catch(e){u.Am.error((null==e?void 0:e.message)||"授权失败"),console.error("Approve failed",e)}};(0,r.useEffect)(()=>{C&&u.Am.success("授权成功")},[C]);let W=async e=>{if((0,N.S)(c))try{await _(null==d?void 0:d.address,(0,b.vz)(e.stakeTokenAmount),BigInt(e.releasePeriod),n)}catch(e){console.error("Stake failed",e)}};(0,r.useEffect)(()=>{P&&(u.Am.success("质押成功"),B.reset(),setTimeout(()=>{window.location.href="/gov?symbol=".concat(null==d?void 0:d.symbol)},2e3))},[P,B,null==d?void 0:d.symbol]);let{handleContractError:X}=(0,o.S)();return(0,r.useEffect)(()=>{I&&X(I,"stake"),E&&X(E,"token")},[I,E,X]),(0,l.jsxs)("div",{className:"w-full flex flex-col items-center p-6 mt-1",children:[(0,l.jsx)("div",{className:"w-full text-left mb-4",children:(0,l.jsx)(y.Z,{title:"质押增加治理收益"})}),(0,l.jsx)(j.l0,{...B,children:(0,l.jsxs)("form",{onSubmit:e=>e.preventDefault(),className:"w-full max-w-md space-y-4",children:[(0,l.jsx)(j.Wi,{control:B.control,name:"stakeTokenAmount",render:e=>{let{field:n}=e;return(0,l.jsxs)(j.xJ,{children:[(0,l.jsxs)(j.lX,{className:"text-sm text-greyscale-500",children:["质押数 (当前持有数量：",(0,l.jsxs)("span",{className:"text-secondary",children:[(0,b.LH)(s)," ",null==d?void 0:d.symbol]}),")"]}),(0,l.jsx)(j.NI,{children:(0,l.jsx)(g.I,{type:"number",placeholder:"输入 ".concat(null==d?void 0:d.symbol," 数量"),className:"!ring-secondary-foreground",...n})}),(0,l.jsx)(j.pf,{}),(0,l.jsx)(j.zG,{})]})}}),(0,l.jsx)(j.Wi,{control:B.control,name:"releasePeriod",render:e=>{let{field:s}=e;return(0,l.jsxs)(j.xJ,{children:[(0,l.jsx)(j.lX,{className:"text-sm text-greyscale-500",children:"释放期"}),(0,l.jsx)(j.NI,{children:(0,l.jsxs)(v.Ph,{value:s.value,onValueChange:e=>s.onChange(e),children:[(0,l.jsx)(v.i4,{className:"w-full !ring-secondary-foreground",children:(0,l.jsx)(v.ki,{placeholder:"请选择释放期"})}),(0,l.jsx)(v.Bw,{children:Array.from({length:9},(e,s)=>s+4).map(e=>(0,l.jsx)(v.Ql,{value:e.toString(),children:e},e))})]})}),(0,l.jsx)(j.pf,{}),(0,l.jsx)(j.zG,{})]})}}),(0,l.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,l.jsx)(k.z,{className:"w-1/2",disabled:A||T||C,onClick:()=>B.handleSubmit(F)(),children:A?"1.授权中...":T?"1.确认中...":C?"1.已授权":"1.授权"}),(0,l.jsx)(k.z,{className:"w-1/2",disabled:!C||S||z||P,onClick:()=>B.handleSubmit(W)(),children:S?"2.质押中...":z?"2.确认中...":P?"2.已质押":"2.质押"})]})]})}),(0,l.jsx)(w.Z,{isLoading:A||T||S||z,text:A||S?"提交交易...":"确认交易..."})]})},T=()=>{let{token:e}=(0,r.useContext)(a.M)||{},{address:s}=(0,t.m)(),{balance:n}=(0,i.hS)(null==e?void 0:e.address,s),{balance:u,error:x}=(0,i.hS)(null==e?void 0:e.parentTokenAddress,s),{tokenAmount:f,parentTokenAmount:h,feeTokenAmount:j,feeParentTokenAmount:g,isPending:k,error:v}=(0,c.tT)(null==e?void 0:e.slTokenAddress),{handleContractError:N}=(0,o.S)();return(0,r.useEffect)(()=>{v&&N(v,"slToken"),x&&N(x,"token")},[v,x]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(d.Z,{title:"质押代币"}),(0,l.jsxs)("main",{className:"flex-grow",children:[k&&(0,l.jsx)(m.Z,{}),!k&&!f&&(0,l.jsx)("div",{className:"flex justify-center items-center mt-10",children:"需要先质押流动性LP，才可以质押代币"}),f&&(0,l.jsx)(A,{tokenBalance:n||0n}),(0,l.jsxs)("div",{className:"flex flex-col w-full p-6 mt-4",children:[(0,l.jsx)("div",{className:"text-base font-bold text-greyscale-700 pb-2",children:"规则说明："}),(0,l.jsx)("div",{className:"text-sm text-greyscale-500 mb-2",children:"1、单独质押代币可获得激励提升（最高不超过 2 倍的验证激励），同时获得 st类代币作为质押的凭证；"}),(0,l.jsx)("div",{className:"text-sm text-greyscale-500",children:"2、释放期指：申请解锁后，几轮之后可以领取。最小为4轮，最大为12轮；"})]})]})]})}}},function(e){e.O(0,[2624,7569,4637,5263,7224,5343,2888,9774,179],function(){return e(e.s=51906)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4246],{28673:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/gov/stake",function(){return r(1136)}])},27245:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var n=r(85893),s=r(67294),a=r(88426),i=r(45139),l=r(98997);let o=(0,i.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:i,asChild:d=!1,...u}=e,c=d?a.g7:"button";return(0,n.jsx)(c,{className:(0,l.cn)(o({variant:s,size:i,className:r})),ref:t,...u})});d.displayName="Button"},98997:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var n=r(90512),s=r(98388);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,n.W)(t))}},31134:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(67294);let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,n.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:l=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:c,...m}=e;return(0,n.createElement)("svg",{ref:t,...i,width:s,height:s,stroke:r,strokeWidth:o?24*Number(l)/Number(s):l,className:a("lucide",d),...m},[...c.map(e=>{let[t,r]=e;return(0,n.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),o=(e,t)=>{let r=(0,n.forwardRef)((r,i)=>{let{className:o,...d}=r;return(0,n.createElement)(l,{ref:i,iconNode:t,className:a("lucide-".concat(s(e)),o),...d})});return r.displayName="".concat(e),r}},23432:function(e,t,r){"use strict";r.d(t,{Z:function(){return n}});let n=(0,r(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},301:function(e,t,r){"use strict";r.d(t,{AT:function(){return d},op:function(){return o},oN:function(){return u}});var n=r(89810),s=r(75593),a=r(83540);let i=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],l="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",o=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:s,error:a,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsOut",args:[e,t],query:{enabled:!!e&&t.length>=2&&r}});return{data:s,error:a,isLoading:o}},d=function(e,t){let r=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:s,error:a,isLoading:o}=(0,n.u)({address:l,abi:i,functionName:"getAmountsIn",args:[e,t],query:{enabled:!!e&&t.length>=2&&r}});return{data:s,error:a,isLoading:o}};function u(){let{writeContract:e,isPending:t,data:r,error:n}=(0,s.S)(),o=async(t,r,n,s,a)=>{try{await e({address:l,abi:i,functionName:"swapExactTokensForTokens",args:[t,r,n,s,a]})}catch(e){console.error("Swap failed:",e)}},{isLoading:d,isSuccess:u}=(0,a.A)({hash:r});return{swap:o,writeData:r,isWriting:t,writeError:n,isConfirming:d,isConfirmed:u}}},1136:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var n=r(85893),s=r(67294),a=r(92321),i=r(19638),l=r(93778),o=r(35337),d=r(86501),u=r(23432),c=r(27245),m=r(92180),f=r(91529),g=r(301);let b=function(e,t,r,n){let a=!(arguments.length>4)||void 0===arguments[4]||arguments[4],{data:i,error:l,isLoading:o}=(0,g.op)(e,t,a&&n),{data:d,error:u,isLoading:c}=(0,s.useMemo)(()=>{if(!a||n)return{data:i,error:l,isLoading:o};{var s,d;let n;let a=0n;return a=(null==r?void 0:r.address)==="0x52961E46a166c999b14066E76CD67a1A5FE4F3f6"?BigInt("1E+27")/BigInt("1E+17"):BigInt("1E+27")/BigInt("2E+25"),n=t&&t.length>=1&&(null===(s=t[0])||void 0===s?void 0:s.toLowerCase())===(null==r?void 0:null===(d=r.address)||void 0===d?void 0:d.toLowerCase())?e/a:e*a,{data:[e,n],error:null,isLoading:!1}}},[n,i,l,o,e,t,null==r?void 0:r.address]);return{data:d,error:u,isLoading:c}},x=function(e,t,r,n){let a=!(arguments.length>4)||void 0===arguments[4]||arguments[4],{data:i,error:l,isLoading:o}=(0,g.AT)(e,t,a&&n),{data:d,error:u,isLoading:c}=(0,s.useMemo)(()=>{if(!a||n)return{data:i,error:l,isLoading:o};{var s,d;let n=0n;return n=(null==r?void 0:r.address)==="0x52961E46a166c999b14066E76CD67a1A5FE4F3f6"?BigInt("1E+27")/BigInt("1E+17"):BigInt("1E+27")/BigInt("2E+25"),{data:[t&&t.length>=1&&(null===(s=t[0])||void 0===s?void 0:s.toLowerCase())===(null==r?void 0:null===(d=r.address)||void 0===d?void 0:d.toLowerCase())?e*n:e/n,e],error:null,isLoading:!1}}},[n,i,l,o,e,t,null==r?void 0:r.address]);return{data:d,error:u,isLoading:c}};var h=e=>{let{tokenBalance:t,parentTokenBalance:r,stakedTokenAmountOfLP:o}=e,{address:g}=(0,a.m)(),{token:h}=(0,s.useContext)(l.M)||{},[v,p]=(0,s.useState)(""),[y,w]=(0,s.useState)(""),[j,N]=(0,s.useState)("4"),[k,A]=(0,s.useState)(!1),[E,C]=(0,s.useState)(!1),T=o>0n,{data:B,error:I,isLoading:L}=b((0,f.vz)(v),[null==h?void 0:h.parentTokenAddress,null==h?void 0:h.address],h,T,k),{data:S,error:z,isLoading:F}=x((0,f.vz)(y),[null==h?void 0:h.parentTokenAddress,null==h?void 0:h.address],h,T,E),_=e=>/^\d+(\.\d{0,12})?$/.test(e);(0,s.useEffect)(()=>{B&&B.length>1&&(C(!1),A(!1),w(Number((0,f.bM)(BigInt(B[1]))).toFixed(12).replace(/\.?0+$/,"")))},[B]),(0,s.useEffect)(()=>{S&&S.length>1&&(A(!1),C(!1),p(Number((0,f.bM)(BigInt(S[0]))).toFixed(12).replace(/\.?0+$/,"")))},[S]);let{approve:D,isWriting:M,isConfirming:q,isConfirmed:Z,writeError:O}=(0,i.yA)(null==h?void 0:h.address),{approve:W,isWriting:P,isConfirming:$,isConfirmed:H,writeError:R}=(0,i.yA)(null==h?void 0:h.parentTokenAddress),X=Z||H||M||P||q||$,K=async e=>{if(e.preventDefault(),!_(v)||!_(y)){d.Am.error("请输入有效的数量，最多支持12位小数");return}try{let e=(0,f.vz)(y),t=(0,f.vz)(v);if(null===e||null===t){d.Am.error("输入格式错误");return}await D("0xf63D97fA996A57a78bf14839d112dd741Dc27321",e),await W("0xf63D97fA996A57a78bf14839d112dd741Dc27321",t)}catch(e){console.error("Approve failed",e)}};(0,s.useEffect)(()=>{(Z||H)&&d.Am.success("授权成功")},[Z,H]);let{stakeLiquidity:V,isWriting:G,isConfirming:J,isConfirmed:Q,writeError:U}=(0,m.Xc)(),Y=async e=>{if(e.preventDefault(),Z&&H){let e=(0,f.vz)(y),t=(0,f.vz)(v);if(null===e||null===t){d.Am.error("转换金额时出错");return}V(null==h?void 0:h.address,e,t,BigInt(j),g).catch(e=>{console.error("Stake failed",e)})}else d.Am.error("请先完成授权")};return(0,s.useEffect)(()=>{Q&&(d.Am.success("质押成功"),setTimeout(()=>{window.location.reload()},2e3))},[Q]),(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"w-full flex flex-col items-center rounded p-4 bg-white mt-1",children:[(0,n.jsx)("div",{className:"w-full text-left mb-4",children:(0,n.jsx)("h2",{className:"relative pl-4 text-gray-700 text-base font-medium before:content-[''] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-red-500",children:"质押获取治理票："})}),(0,n.jsxs)("form",{onSubmit:Y,className:"w-full max-w-md",children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("label",{className:"block text-left mb-1 text-sm text-gray-500",children:["质押父币数 (当前持有：",(0,f.LH)(r)," ",null==h?void 0:h.parentTokenSymbol,")"]}),(0,n.jsx)("input",{type:"text",placeholder:"输入 ".concat(null==h?void 0:h.parentTokenSymbol," 数量"),value:v,onChange:e=>{let t=e.target.value;A(!0),(""===t||_(t))&&p(t),t||w("0")},className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring bg-white",required:!0,disabled:X})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("label",{className:"block text-left mb-1 text-sm text-gray-500",children:["质押token数 (当前持有：",(0,f.LH)(t)," ",null==h?void 0:h.symbol,")"]}),(0,n.jsx)("input",{type:"text",placeholder:"输入 ".concat(null==h?void 0:h.symbol," 数量"),value:y,onChange:e=>{let t=e.target.value;C(!0),(""===t||_(t))&&w(t),t||p("0")},className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring bg-white",required:!0,disabled:X})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-left mb-1 text-sm text-gray-500",children:"释放期"}),(0,n.jsx)("select",{value:j,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring  bg-white",required:!0,disabled:X,children:Array.from({length:9},(e,t)=>(0,n.jsx)("option",{value:t+4,children:t+4},t+4))})]}),(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,n.jsx)(c.z,{className:"w-1/2 ".concat(X?"bg-gray-600 hover:bg-gray-700":"bg-blue-600 hover:bg-blue-700"),disabled:X,onClick:K,children:M||q?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{className:"animate-spin"}),"1.授权中..."]}):Z?"1.已授权":"1.授权"}),(0,n.jsx)(c.z,{type:"submit",className:"w-1/2 text-white py-2 rounded hover:bg-blue-600 ".concat(Z&&H?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),disabled:!Z||!H||G||J||Q,children:G||J?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.Z,{className:"animate-spin"}),"2.质押中..."]}):Q?"2.已质押":"2.质押"})]})]}),U&&(0,n.jsx)("div",{className:"text-red-500",children:U.message}),O&&(0,n.jsx)("div",{className:"text-red-500",children:O.message}),R&&(0,n.jsx)("div",{className:"text-red-500",children:R.message})]})})},v=r(77156),p=r(91318),y=e=>{let{tokenBalance:t}=e,{address:r}=(0,a.m)(),{token:o}=(0,s.useContext)(l.M)||{},{totalSupply:u,isPending:g}=(0,v.A5)(null==o?void 0:o.stTokenAddress),{approve:b,isWriting:x,isConfirming:h,isConfirmed:y,writeError:w}=(0,i.yA)(null==o?void 0:o.address),{stakeToken:j,isWriting:N,isConfirming:k,isConfirmed:A,writeError:E}=(0,m.aE)(),[C,T]=(0,s.useState)(""),[B,I]=(0,s.useState)("4"),L=async()=>{if(0n===BigInt(C)){d.Am.error("请输入正确的数量");return}try{await b("0xf63D97fA996A57a78bf14839d112dd741Dc27321",(0,f.vz)(C))}catch(e){d.Am.error((null==e?void 0:e.message)||"授权失败"),console.error("Approve failed",e)}};(0,s.useEffect)(()=>{y&&d.Am.success("授权成功")},[y]);let S=async()=>{if(0n===BigInt(C)){d.Am.error("请输入正确的数量");return}try{await j(null==o?void 0:o.address,(0,f.vz)(C),BigInt(B),r)}catch(e){console.error("Stake failed",e)}};return(0,s.useEffect)(()=>{A&&(d.Am.success("质押成功"),T(""),I(""),setTimeout(()=>{window.location.reload()},2e3))},[A]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"flex justify-center w-full items-center rounded p-4 bg-white mt-4",children:(0,n.jsxs)("span",{children:[(0,n.jsx)("span",{className:"text-sm text-gray-500 mr-2",children:"代币质押总量"}),(0,n.jsx)("span",{className:"text-2xl font-bold text-orange-400",children:N?(0,n.jsx)(p.Z,{}):(0,f.LH)(u||BigInt(0))})]})}),(0,n.jsxs)("div",{className:"w-full flex flex-col items-center rounded p-4 bg-white mt-1",children:[(0,n.jsx)("div",{className:"w-full text-left mb-4",children:(0,n.jsxs)("h2",{className:"relative pl-4 text-gray-700 text-base font-medium before:content-[''] before:absolute before:left-0 before:top-0 before:bottom-0 before:w-1 before:bg-red-500",children:["质押增加治理收益：",(0,n.jsx)("span",{className:"text-gray-500 text-sm font-normal",children:"(最多两倍)"})]})}),(0,n.jsxs)("form",{className:"w-full max-w-md",onSubmit:e=>e.preventDefault(),children:[(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("label",{className:"block text-left mb-1 text-sm text-gray-500",children:["质押token数 (当前持有：",(0,f.LH)(t)," ",null==o?void 0:o.symbol,")"]}),(0,n.jsx)("input",{type:"number",placeholder:"输入 ".concat(null==o?void 0:o.symbol," 数量"),value:C,onChange:e=>{T(e.target.value)},className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring bg-white",required:!0})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{className:"block text-left mb-1 text-sm text-gray-500",children:"释放期"}),(0,n.jsx)("select",{value:B,onChange:e=>I(e.target.value),className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring bg-white",required:!0,children:Array.from({length:9},(e,t)=>(0,n.jsx)("option",{value:t+4,children:t+4},t+4))})]}),(0,n.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,n.jsx)(c.z,{className:"w-1/2 ".concat(y?"bg-gray-600 hover:bg-gray-700":"bg-blue-600 hover:bg-blue-700"),disabled:x||h||y,onClick:L,children:x||h?"授权中...":y?"1.已授权":"1.授权"}),(0,n.jsx)(c.z,{className:"w-1/2 ".concat(y?"bg-blue-600 hover:bg-blue-700":"bg-gray-600 hover:bg-gray-700"),disabled:!y||N||k,onClick:S,children:N||k?"质押中...":"2.质押"})]})]}),E&&(0,n.jsx)("div",{className:"text-red-500",children:E.message}),w&&(0,n.jsx)("div",{className:"text-red-500",children:w.message})]})]})},w=r(18303),j=()=>{let{token:e}=(0,s.useContext)(l.M)||{},{address:t}=(0,a.m)(),{balance:r}=(0,i.hS)(null==e?void 0:e.address,t),{balance:d}=(0,i.hS)(null==e?void 0:e.parentTokenAddress,t),[u,c]=(0,s.useState)(BigInt(-1));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.Z,{title:"质押"}),(0,n.jsxs)("main",{className:"flex-grow",children:[(0,n.jsx)("div",{className:"w-full flex flex-col items-center rounded p-4 bg-white  space-y-4",children:(0,n.jsx)(w.Z,{showStakeToken:!1,onTokenAmountChange:c})}),u!==BigInt(-1)&&(0,n.jsx)(h,{tokenBalance:r||0n,parentTokenBalance:d||0n,stakedTokenAmountOfLP:u}),u!==BigInt(-1)&&(0,n.jsx)(y,{tokenBalance:r||0n}),(0,n.jsxs)("div",{className:"flex flex-col w-full rounded p-4 bg-white mt-4",children:[(0,n.jsx)("div",{className:"text-base font-bold text-gray-700 pb-2",children:"规则说明："}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"1、所得治理票数 = LP 数量 * 释放期轮次"}),(0,n.jsx)("div",{className:"text-sm text-gray-500",children:"2、释放期指：申请解锁后，几轮之后可以领取。最小为4轮，最大为12轮。"})]})]})]})}},89810:function(e,t,r){"use strict";r.d(t,{u:function(){return o}});var n=r(37003),s=r(36100),a=r(82451),i=r(82002),l=r(37122);function o(e={}){let{abi:t,address:r,functionName:o,query:d={}}=e,u=e.code,c=(0,l.Z)(e),m=(0,i.x)({config:c}),f=function(e,t={}){return{async queryFn({queryKey:r}){let s=t.abi;if(!s)throw Error("abi is required");let{functionName:a,scopeKey:i,...l}=r[1],o=(()=>{let e=r[1];if(e.address)return{address:e.address};if(e.code)return{code:e.code};throw Error("address or code is required")})();if(!a)throw Error("functionName is required");return(0,n.L)(e,{abi:s,functionName:a,args:l.args,...o,...l})},queryKey:function(e={}){let{abi:t,...r}=e;return["readContract",(0,s.OP)(r)]}(t)}}(c,{...e,chainId:e.chainId??m}),g=!!((r||u)&&t&&o&&(d.enabled??!0));return(0,a.aM)({...d,...f,enabled:g,structuralSharing:d.structuralSharing??s.if})}}},function(e){e.O(0,[4846,8424,9638,2180,7716,2888,9774,179],function(){return e(e.s=28673)}),_N_E=e.O()}]);
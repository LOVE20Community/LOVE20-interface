"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9099],{23432:function(e,n,t){t.d(n,{Z:function(){return a}});let a=(0,t(31134).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9099:function(e,n,t){t.d(n,{Z:function(){return x}});var a=t(85893),s=t(67294),r=t(92321),i=t(86501),l=t(23432),d=t(27245),o=t(92180),u=t(19638),c=t(93778),m=t(91529),p=t(301);let f=function(e,n,t,a){let r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],{data:i,error:l,isLoading:d}=(0,p.op)(e,n,r&&a),{data:o,error:u,isLoading:c}=(0,s.useMemo)(()=>{if(!r||a)return{data:i,error:l,isLoading:d};{var s,o;let a;let r=0n;return r=(null==t?void 0:t.address)==="0x52961E46a166c999b14066E76CD67a1A5FE4F3f6"?BigInt("1E+27")/BigInt("1E+17"):BigInt("1E+27")/BigInt("2E+25"),a=n&&n.length>=1&&(null===(s=n[0])||void 0===s?void 0:s.toLowerCase())===(null==t?void 0:null===(o=t.address)||void 0===o?void 0:o.toLowerCase())?e/r:e*r,{data:[e,a],error:null,isLoading:!1}}},[a,i,l,d,e,n,null==t?void 0:t.address]);return{data:o,error:u,isLoading:c}},g=function(e,n,t,a){let r=!(arguments.length>4)||void 0===arguments[4]||arguments[4],{data:i,error:l,isLoading:d}=(0,p.AT)(e,n,r&&a),{data:o,error:u,isLoading:c}=(0,s.useMemo)(()=>{if(!r||a)return{data:i,error:l,isLoading:d};{var s,o;let a=0n;return a=(null==t?void 0:t.address)==="0x52961E46a166c999b14066E76CD67a1A5FE4F3f6"?BigInt("1E+27")/BigInt("1E+17"):BigInt("1E+27")/BigInt("2E+25"),{data:[n&&n.length>=1&&(null===(s=n[0])||void 0===s?void 0:s.toLowerCase())===(null==t?void 0:null===(o=t.address)||void 0===o?void 0:o.toLowerCase())?e*a:e/a,e],error:null,isLoading:!1}}},[a,i,l,d,e,n,null==t?void 0:t.address]);return{data:o,error:u,isLoading:c}};var v=t(64777),x=e=>{let{tokenBalance:n,parentTokenBalance:t,stakedTokenAmountOfLP:p}=e,{address:x}=(0,r.m)(),{token:y}=(0,s.useContext)(c.M)||{},[h,b]=(0,s.useState)(""),[N,j]=(0,s.useState)(""),[w,A]=(0,s.useState)("4"),[E,T]=(0,s.useState)(!1),[C,k]=(0,s.useState)(!1),L=p>0n,{data:I,error:B,isLoading:F}=f((0,m.vz)(h),[null==y?void 0:y.parentTokenAddress,null==y?void 0:y.address],y,L,E),{data:S,error:D,isLoading:M}=g((0,m.vz)(N),[null==y?void 0:y.parentTokenAddress,null==y?void 0:y.address],y,L,C),z=e=>/^\d+(\.\d{0,12})?$/.test(e);(0,s.useEffect)(()=>{I&&I.length>1&&(k(!1),T(!1),j(Number((0,m.bM)(BigInt(I[1]))).toFixed(12).replace(/\.?0+$/,"")))},[I]),(0,s.useEffect)(()=>{S&&S.length>1&&(T(!1),k(!1),b(Number((0,m.bM)(BigInt(S[0]))).toFixed(12).replace(/\.?0+$/,"")))},[S]);let{approve:Z,isWriting:q,isConfirming:O,isConfirmed:_,writeError:W}=(0,u.yA)(null==y?void 0:y.address),{approve:$,isWriting:H,isConfirming:P,isConfirmed:X,writeError:G}=(0,u.yA)(null==y?void 0:y.parentTokenAddress),J=_||X||q||H||O||P,K=async e=>{if(e.preventDefault(),!z(h)||!z(N)){i.Am.error("请输入有效的数量，最多支持12位小数");return}try{let e=(0,m.vz)(N),n=(0,m.vz)(h);if(null===e||null===n){i.Am.error("输入格式错误");return}await Z("0xf63D97fA996A57a78bf14839d112dd741Dc27321",e),await $("0xf63D97fA996A57a78bf14839d112dd741Dc27321",n)}catch(e){console.error("Approve failed",e)}};(0,s.useEffect)(()=>{(_||X)&&i.Am.success("授权成功")},[_,X]);let{stakeLiquidity:Q,isWriting:R,isConfirming:U,isConfirmed:V,writeError:Y}=(0,o.Xc)(),ee=async e=>{if(e.preventDefault(),_&&X){let e=(0,m.vz)(N),n=(0,m.vz)(h);if(null===e||null===n){i.Am.error("转换金额时出错");return}Q(null==y?void 0:y.address,e,n,BigInt(w),x).catch(e=>{console.error("Stake failed",e)})}else i.Am.error("请先完成授权")};return(0,s.useEffect)(()=>{V&&(i.Am.success("质押成功"),setTimeout(()=>{window.location.href="/".concat(null==y?void 0:y.symbol,"/gov")},2e3))},[V]),(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("div",{className:"w-full flex-col items-center rounded p-4 mt-1",children:[(0,a.jsx)(v.Z,{title:"质押获取治理票"}),(0,a.jsxs)("form",{onSubmit:ee,className:"w-full max-w-md mt-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:["质押父币数 (当前持有：",(0,a.jsxs)("span",{className:"text-secondary-400",children:[(0,m.LH)(t)," ",null==y?void 0:y.parentTokenSymbol]}),")"]}),(0,a.jsx)("input",{type:"text",placeholder:"输入 ".concat(null==y?void 0:y.parentTokenSymbol," 数量"),value:h,onChange:e=>{let n=e.target.value;T(!0),(""===n||z(n))&&b(n),n||j("0")},className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring",required:!0,disabled:J})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsxs)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:["质押token数 (当前持有：",(0,a.jsxs)("span",{className:"text-secondary-400",children:[(0,m.LH)(n)," ",null==y?void 0:y.symbol]}),")"]}),(0,a.jsx)("input",{type:"text",placeholder:"输入 ".concat(null==y?void 0:y.symbol," 数量"),value:N,onChange:e=>{let n=e.target.value;k(!0),(""===n||z(n))&&j(n),n||b("0")},className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring",required:!0,disabled:J})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{className:"block text-left mb-1 text-sm text-greyscale-500",children:"释放期"}),(0,a.jsx)("select",{value:w,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border rounded focus:outline-none focus:ring ",required:!0,disabled:J,children:Array.from({length:9},(e,n)=>(0,a.jsx)("option",{value:n+4,children:n+4},n+4))})]}),(0,a.jsxs)("div",{className:"flex justify-center space-x-4",children:[(0,a.jsx)(d.z,{className:"w-1/2 ",disabled:J,onClick:K,children:q||O?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"animate-spin"}),"1.授权中..."]}):_?"1.已授权":"1.授权"}),(0,a.jsx)(d.z,{type:"submit",className:"w-1/2",disabled:!_||!X||R||U||V,children:R||U?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.Z,{className:"animate-spin"}),"2.质押中..."]}):V?"2.已质押":"2.质押"})]})]}),Y&&(0,a.jsx)("div",{className:"text-red-500",children:Y.message}),W&&(0,a.jsx)("div",{className:"text-red-500",children:W.message}),G&&(0,a.jsx)("div",{className:"text-red-500",children:G.message})]})})}},301:function(e,n,t){t.d(n,{AT:function(){return o},op:function(){return d},oN:function(){return u}});var a=t(89810),s=t(75593),r=t(83540);let i=[{type:"function",name:"swapExactTokensForTokens",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"amountOutMin",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"},{name:"to",type:"address",internalType:"address"},{name:"deadline",type:"uint256",internalType:"uint256"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"nonpayable"},{type:"function",name:"getAmountsOut",inputs:[{name:"amountIn",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"getAmountsIn",inputs:[{name:"amountOut",type:"uint256",internalType:"uint256"},{name:"path",type:"address[]",internalType:"address[]"}],outputs:[{name:"amounts",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"}],l="0xCB54233742E93C680B634DF5aDf33d28b288Dc95",d=function(e,n){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:s,error:r,isLoading:d}=(0,a.u)({address:l,abi:i,functionName:"getAmountsOut",args:[e,n],query:{enabled:!!e&&n.length>=2&&t}});return{data:s,error:r,isLoading:d}},o=function(e,n){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],{data:s,error:r,isLoading:d}=(0,a.u)({address:l,abi:i,functionName:"getAmountsIn",args:[e,n],query:{enabled:!!e&&n.length>=2&&t}});return{data:s,error:r,isLoading:d}};function u(){let{writeContract:e,isPending:n,data:t,error:a}=(0,s.S)(),d=async(n,t,a,s,r)=>{try{await e({address:l,abi:i,functionName:"swapExactTokensForTokens",args:[n,t,a,s,r]})}catch(e){console.error("Swap failed:",e)}},{isLoading:o,isSuccess:u}=(0,r.A)({hash:t});return{swap:d,writeData:t,isWriting:n,writeError:a,isConfirming:o,isConfirmed:u}}}}]);